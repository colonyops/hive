{"id":"hive-07m","title":"Change recycled indicator to trash icon with gray styling","description":"Replace [○] with [] (Nerd Font trash icon \\uf1f8) for recycled sessions. Change color from yellow/orange to gray/subtle to de-emphasize recycled sessions visually.\n\nFiles:\n- internal/tui/tree_view.go - statusRecycled constant and StatusRecycled style\n- Update both the icon and the style color","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:34.564908-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:35:48.973644-06:00","closed_at":"2026-01-30T17:35:48.973644-06:00","close_reason":"Closed"}
{"id":"hive-0cx","title":"Disable commands on recycled sessions except delete","description":"Prevent accidental operations on recycled sessions by disabling most commands. Only delete should work on recycled sessions.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T22:14:40.78464-06:00","created_by":"Hayden","updated_at":"2026-01-31T22:15:55.215565-06:00","closed_at":"2026-01-31T22:15:55.215565-06:00","close_reason":"Closed"}
{"id":"hive-0f2","title":"Terminal state detection unreliable - can't distinguish approval vs idle","description":"## Problem\n\nThe current terminal state detection in `internal/integration/terminal/` cannot reliably distinguish between:\n\n1. **Waiting for approval** - Claude shows permission dialog (Yes/No options) - HIGH URGENCY\n2. **Empty input prompt** - Claude finished task, shows just `\u003e` - LOW URGENCY  \n3. **Idle/acknowledged** - User has seen the session - NO URGENCY\n\nAll three cases currently get treated similarly, making the status indicator \"more or less useless\" as the user described.\n\n## Root Causes\n\n1. **Missing acknowledge mechanism** - No way to track if user has seen a waiting session\n   - Agent Deck has `acknowledged`, `acknowledgedAt`, `waitingSince` fields\n   - Hive's StateTracker lacks these entirely\n\n2. **Simplified detection logic** - Hive checks only 5 lines vs Agent Deck's 25 lines\n   - Missing pattern coverage for edge cases\n   - Less sophisticated content normalization\n\n3. **No state persistence** - When session stops being busy, immediately returns idle instead of waiting\n\n## Reference\n\nAgent Deck (MIT licensed) has battle-tested detection at:\n- `agent-deck/internal/tmux/tmux.go` - GetStatus with full state machine\n- `agent-deck/internal/tmux/detector.go` - PromptDetector with tool-specific patterns\n- `agent-deck/internal/tmux/patterns.go` - Configurable pattern system","status":"closed","priority":1,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:18.181512-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:41.907107-06:00","closed_at":"2026-01-31T19:02:41.907107-06:00","close_reason":"Fixed: StateTracker now has acknowledged fields, detection uses 15-line window, TUI calls Acknowledge on session selection. States: active (spinner/busy), waiting (prompt detected or not acknowledged), idle (acknowledged by user).","dependencies":[{"issue_id":"hive-0f2","depends_on_id":"hive-wf6","type":"blocks","created_at":"2026-01-31T18:50:30.01328-06:00","created_by":"Hayden"}]}
{"id":"hive-0r3","title":"Add --fix flag to hive doctor for orphan cleanup","description":"Add a --fix flag to hive doctor that deletes orphaned worktrees detected by the OrphanCheck. When --fix is passed, delete directories that have no matching session record instead of just reporting them as warnings.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T22:03:22.805784-06:00","created_by":"Hayden","updated_at":"2026-01-31T22:06:05.043455-06:00","closed_at":"2026-01-31T22:06:05.043455-06:00","close_reason":"Added --fix flag to hive doctor that deletes orphaned worktrees","dependencies":[{"issue_id":"hive-0r3","depends_on_id":"hive-m6y","type":"blocks","created_at":"2026-01-31T22:03:27.086625-06:00","created_by":"Hayden"}]}
{"id":"hive-0tq","title":"TUI auto-refresh feature","description":"Add periodic auto-refresh to the hive TUI so sessions view updates automatically to reflect status changes from other environments.\n\n## Current State\n- Messages view: Already polls every 500ms via schedulePollTick() in polling.go\n- Sessions view: Only refreshes after explicit actions (delete, recycle, shell)\n- Git status: Only refreshes manually with g key\n\n## Implementation Approach\n\nFollow the existing message polling pattern to add session refresh.\n\n### Files to Modify\n\n1. internal/core/config/config.go - Add refresh interval config\n2. internal/tui/model.go - Add refresh tick message and handler\n3. internal/tui/polling.go - Add session refresh scheduling\n\n### Behavior\n\n- Refresh runs every 15 seconds by default (configurable)\n- Only reloads when Sessions view is active and no modal open\n- Git status refreshes alongside sessions (reuses existing fetchGitStatusBatch)\n- Timer continues in background, just skips reload if view inactive\n- Set refresh_interval: 0 to disable auto-refresh","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:25:44.49029-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:34:16.658442-06:00","closed_at":"2026-01-30T23:34:16.658442-06:00","close_reason":"Closed"}
{"id":"hive-13m","title":"Add BatchSpawnTemplateData for validation","description":"Create BatchSpawnTemplateData struct in internal/core/config/validate.go that includes Prompt field.\n\nSpawnTemplateData (for hive new): Path, Name, Slug, ContextDir, Owner, Repo\nBatchSpawnTemplateData (for batch): Path, Name, Slug, ContextDir, Owner, Repo, Prompt\n\nUpdate Validate() to validate batch_spawn templates against BatchSpawnTemplateData.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:33.047882-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:47.529232-06:00","closed_at":"2026-01-30T13:22:47.529232-06:00","close_reason":"Added BatchSpawnTemplateData struct and validation for batch_spawn commands","dependencies":[{"issue_id":"hive-13m","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:48.13222-06:00","created_by":"Hayden"}]}
{"id":"hive-143","title":"Update batch command documentation","description":"Update cmd_batch.go usage text and description to:\n1. Document that prompt field is supported in JSON input\n2. Explain that batch_spawn config is used for batch sessions\n3. Show example with prompt in JSON schema","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:39.209707-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:37.546775-06:00","closed_at":"2026-01-30T13:23:37.546775-06:00","close_reason":"Updated batch command documentation with prompt field, batch_spawn usage, and config example"}
{"id":"hive-1re","title":"Remove duplicate headers and update tab bar to show session state","description":"The 'Message Bus' header is indented one space too far. Additionally, there are duplicate headers (the list title and the tab bar) which looks strange.\n\n## Solution\n- Remove the per-view titles (Sessions/Message Bus headers within the list)\n- Use only the tab bar as the heading\n- Show 'active' and 'local' session filter states in the tab bar itself (e.g., 'Sessions (local, active)' or as subtle indicators)","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.063539-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.476523-06:00","closed_at":"2026-01-30T15:58:21.476523-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-1rq","title":"Add left padding to tab bar to align with banner","description":"The tab bar (Sessions | Messages) starts at column 0, but the banner above it has left padding. Add matching left padding to the tab bar so they align visually.\n\nFiles:\n- internal/tui/model.go - renderTabView() line ~687\n- internal/tui/styles.go - bannerStyle has PaddingLeft(1)","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:32.759514-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:43:35.845634-06:00","closed_at":"2026-01-30T17:43:35.845634-06:00","close_reason":"Applied consistent PaddingLeft(1) style to tab bar, matching banner styling"}
{"id":"hive-1rt","title":"Fix terminal detection bounce with status line (GH #67)","description":"Terminal detection bounces between states when user has Claude Code status line configured. The status line updates trigger activity detection feedback loops.\n\n**Root cause (from GH #67):**\n1. Status bar updates cause terminal content changes\n2. tmux window_activity timestamp updates\n3. StateTracker enters spike detection mode\n4. Repeated cycles cause visible bouncing\n\n**Dead code bug in state_tracker.go:102-111:**\nThe spike detection resets without properly settling when there are frequent non-busy content changes.\n\n**Potential solutions (from issue):**\n1. Filter status bar regions from activity detection\n2. Improve spike detection with proper hysteresis\n3. Extend NormalizeContent() to strip status bar patterns\n4. Debounce at UI level\n\n**Files to investigate/modify:**\n- internal/integration/terminal/state_tracker.go (spike detection logic)\n- internal/integration/terminal/detector.go (IsBusy logic)\n\n**Reference:** https://github.com/colonyops/hive/issues/67","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T08:36:01.861406-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:58:35.804765-06:00","closed_at":"2026-02-02T08:58:35.804765-06:00","close_reason":"Closed"}
{"id":"hive-21w","title":"Bubbletea V2 + Lipgloss V2 Migration","description":"Migrate the TUI from Bubbletea V1 + Lipgloss V1 to V2, enabling true modal overlay compositing using the Canvas/Layer API.\n\n## Current State\n- **Bubbletea**: v1.3.10\n- **Lipgloss**: v1.1.1 (pre-release) + v2.0.0-beta.3 (already partially imported)\n- **Bubbles**: v0.21.1 (pre-release)\n\nThe codebase already imports Lipgloss V2 for modal styles, but uses `lipgloss.Place()` which replaces the background rather than compositing over it.\n\n---\n\n## Migration Phases\n\n### Phase 1: Update Dependencies\n**Files:** `go.mod`\n\nUpdate to V2 packages:\n```go\ncharm.land/bubbletea/v2\ncharm.land/bubbles/v2\ngithub.com/charmbracelet/lipgloss/v2  // already using\n```\n\nRemove V1 dependencies after migration complete.\n\n---\n\n### Phase 2: Consolidate Lipgloss V2\n**Files:** 5 files\n\n| File | Change |\n|------|--------|\n| `internal/styles/styles.go` | `lipgloss` → `lipgloss/v2` |\n| `internal/tui/styles.go` | Remove dual-import, use v2 only |\n| `internal/tui/messages_view.go` | `lipgloss` → `lipgloss/v2` |\n| `internal/tui/tree_view.go` | `lipgloss` → `lipgloss/v2` |\n| `internal/tui/message_preview_modal.go` | Remove `lipglossv1` alias, use v2 only |\n\nStyle APIs (`NewStyle()`, `Color()`, `JoinVertical()`, etc.) are compatible.\n\n---\n\n### Phase 3: Migrate Bubbles to V2\n**Files:** 5 files\n\nUpdate imports from `github.com/charmbracelet/bubbles/*` to `charm.land/bubbles/v2/*`:\n\n| File | Components |\n|------|------------|\n| `internal/tui/model.go` | list, spinner, key |\n| `internal/tui/tree_view.go` | list (TreeDelegate interface) |\n| `internal/tui/keybindings.go` | key |\n| `internal/tui/output_modal.go` | spinner |\n| `internal/tui/message_preview_modal.go` | viewport |\n\n**Note:** TreeDelegate implements `list.ItemDelegate` - verify interface unchanged in V2.\n\n---\n\n### Phase 4: Migrate Bubbletea to V2\n**Files:** 6 files\n\n#### 4.1 Update Imports\nAll files: `github.com/charmbracelet/bubbletea` → `charm.land/bubbletea/v2`\n\nFiles:\n- `internal/tui/model.go`\n- `internal/tui/polling.go`\n- `internal/tui/terminalstatus.go`\n- `internal/tui/gitstatus.go`\n- `internal/tui/tree_view.go`\n- `internal/commands/cmd_tui.go`\n\n#### 4.2 Update View() Return Type\n`internal/tui/model.go:870`:\n```go\n// Before\nfunc (m Model) View() string { ... }\n\n// After\nfunc (m Model) View() tea.View {\n    // ... same logic ...\n    return tea.NewView(mainView)\n}\n```\n\n#### 4.3 Update Key Handling\n`internal/tui/model.go:446`:\n```go\n// Before\ncase tea.KeyMsg:\n\n// After\ncase tea.KeyPressMsg:\n```\n\nUpdate `handleKey()` signature and all downstream handlers.\n\n#### 4.4 Update Rune Access\n`internal/tui/model.go:654`:\n```go\n// Before\nif len(msg.Runes) \u003e 0 { for _, r := range msg.Runes { ... } }\n\n// After\nif msg.Text != \"\" { for _, r := range msg.Text { ... } }\n```\n\n---\n\n### Phase 5: Implement Canvas/Layer Compositing\n**Files:** 4 files\n\nReplace `lipgloss.Place()` with Canvas/Layer for true overlay:\n\n#### Pattern Change\n```go\n// Before (replaces background)\nreturn lipgloss.Place(width, height, lipgloss.Center, lipgloss.Center, modal)\n\n// After (composites over background)\nbgLayer := lipgloss.NewLayer(background).Z(0)\nmodalLayer := lipgloss.NewLayer(modal).\n    X((width - modalWidth) / 2).\n    Y((height - modalHeight) / 2).\n    Z(1)\ncanvas := lipgloss.NewCanvas(width, height)\ncanvas.Compose(bgLayer)\ncanvas.Compose(modalLayer)\nreturn canvas.Render()\n```\n\n#### Files to Update\n| File | Method | Line |\n|------|--------|------|\n| `internal/tui/modal.go` | `Overlay()` | 41-78 |\n| `internal/tui/output_modal.go` | `Overlay()` | 79-151 |\n| `internal/tui/message_preview_modal.go` | `Overlay()` | 119-173 |\n| `internal/tui/model.go` | Form overlay | 896-904 |\n\n---\n\n### Phase 6: Verify huh Form Compatibility\n**Files:** 2 files\n\n- `internal/tui/new_session_form.go` - Verify huh works with V2 stack\n- `internal/styles/styles.go` - Verify `FormTheme()` works with V2 styles\n\nMay need huh library update if incompatible.\n\n---\n\n## File Summary\n\n| Phase | Files Modified |\n|-------|----------------|\n| 1 | 1 (go.mod) |\n| 2 | 5 (styles consolidation) |\n| 3 | 5 (bubbles imports) |\n| 4 | 6 (bubbletea core) |\n| 5 | 4 (modal compositing) |\n| 6 | 2 (huh verification) |\n\n**Total:** ~12 unique files (some modified in multiple phases)\n\n---\n\n## Verification\n\nAfter each phase:\n1. `go build ./...` compiles\n2. `go test ./internal/tui/...` passes\n\nFinal verification:\n1. Launch TUI: `hive tui`\n2. Navigate session list with arrow keys\n3. Open delete confirmation modal - verify background visible\n4. Open recycle modal with streaming output\n5. Open message preview modal, scroll content\n6. Open new session form\n7. Filter sessions with `/`\n8. Tab between Sessions and Messages views\n9. All keybindings work per config\n\n---\n\n## Risks \u0026 Mitigations\n\n| Risk | Mitigation |\n|------|------------|\n| Bubbles V2 not fully released | Use pre-release/commit-pinned version |\n| huh incompatible with V2 | May need huh update or workaround |\n| Canvas API beta instability | Pin to specific lipgloss/v2 version |\n| TreeDelegate interface changes | Verify interface, adapt if needed |\n\n---\n\n## Branch Strategy\n\n1. Create `feat/bubbletea-v2-migration` branch\n2. One commit per phase for easy bisection\n3. Test thoroughly before merging to main","notes":"## Phase 1 Completed (2026-01-31)\n\n**Solution:** Used replace directives from charmbracelet/crush module to resolve dependency conflict.\n\n**go.mod changes:**\n- Added replace directives mapping github.com imports to charm.land packages\n- lipgloss/v2 → charm.land/lipgloss/v2 v2.0.0-beta.3.0.20251205162909-7869489d8971\n- bubbletea/v2 → charm.land/bubbletea/v2 v2.0.0-rc.2.0.20251216153312-819e2e89c62e  \n- bubbles/v2 → charm.land/bubbles/v2 v2.0.0-rc.1.0.20260109112849-ae99f46cec66\n- x/ansi upgraded to v0.11.3\n- cellbuf upgraded to v0.0.14\n\nBuild and tests pass. Ready for Phase 2-6.","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:06.17559-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:16:15.146782-06:00","closed_at":"2026-02-01T00:16:15.146782-06:00","close_reason":"Migration complete: bubbletea v2, bubbles v2, lipgloss v2 with Canvas/Layer compositing. huh workaround in place (see hive-ayy)."}
{"id":"hive-21w.1","title":"Phase 1: Update go.mod dependencies to V2","description":"Update go.mod to use V2 packages:\n- charm.land/bubbletea/v2\n- charm.land/bubbles/v2\n- github.com/charmbracelet/lipgloss/v2 (already using)\n\nRun go mod tidy after updating. V1 dependencies will be removed after full migration.","notes":"Completed using replace directives to map github.com paths to charm.land packages with compatible versions from charmbracelet/crush module.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:17.395784-06:00","created_by":"Hayden","updated_at":"2026-01-31T23:49:31.168927-06:00","closed_at":"2026-01-31T23:49:31.168927-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-21w.1","depends_on_id":"hive-21w","type":"parent-child","created_at":"2026-01-31T23:17:17.396898-06:00","created_by":"Hayden"}]}
{"id":"hive-21w.2","title":"Phase 2: Consolidate Lipgloss V2 imports","description":"Remove all Lipgloss V1 imports, use only V2.\n\nFiles to update:\n- internal/styles/styles.go - lipgloss → lipgloss/v2\n- internal/tui/styles.go - Remove dual-import, use v2 only\n- internal/tui/messages_view.go - lipgloss → lipgloss/v2\n- internal/tui/tree_view.go - lipgloss → lipgloss/v2\n- internal/tui/message_preview_modal.go - Remove lipglossv1 alias, use v2 only\n\nStyle APIs (NewStyle(), Color(), JoinVertical(), etc.) are compatible.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:22.604674-06:00","created_by":"Hayden","updated_at":"2026-01-31T23:54:04.113464-06:00","closed_at":"2026-01-31T23:54:04.113464-06:00","close_reason":"Consolidated lipgloss v2 imports in tui package. Files updated: styles.go, messages_view.go, tree_view.go, message_preview_modal.go. model.go keeps v1 for bubbles v1 compatibility. styles/styles.go keeps v1 for huh compatibility.","dependencies":[{"issue_id":"hive-21w.2","depends_on_id":"hive-21w","type":"parent-child","created_at":"2026-01-31T23:17:22.605872-06:00","created_by":"Hayden"},{"issue_id":"hive-21w.2","depends_on_id":"hive-21w.1","type":"blocks","created_at":"2026-01-31T23:17:53.256917-06:00","created_by":"Hayden"}]}
{"id":"hive-21w.3","title":"Phase 3: Migrate Bubbles to V2","description":"Update imports from github.com/charmbracelet/bubbles/* to charm.land/bubbles/v2/*\n\nFiles to update:\n- internal/tui/model.go - list, spinner, key\n- internal/tui/tree_view.go - list (TreeDelegate interface)\n- internal/tui/keybindings.go - key\n- internal/tui/output_modal.go - spinner\n- internal/tui/message_preview_modal.go - viewport\n\nNote: TreeDelegate implements list.ItemDelegate - verify interface unchanged in V2.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:27.807016-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:12:53.152914-06:00","closed_at":"2026-02-01T00:12:53.152914-06:00","close_reason":"Completed migration - build and tests pass","dependencies":[{"issue_id":"hive-21w.3","depends_on_id":"hive-21w","type":"parent-child","created_at":"2026-01-31T23:17:27.808463-06:00","created_by":"Hayden"},{"issue_id":"hive-21w.3","depends_on_id":"hive-21w.2","type":"blocks","created_at":"2026-01-31T23:17:58.436726-06:00","created_by":"Hayden"}]}
{"id":"hive-21w.4","title":"Phase 4: Migrate Bubbletea to V2","description":"Core Bubbletea V2 migration with breaking changes.\n\n4.1 Update imports: github.com/charmbracelet/bubbletea → charm.land/bubbletea/v2\nFiles: model.go, polling.go, terminalstatus.go, gitstatus.go, tree_view.go, cmd_tui.go\n\n4.2 Update View() return type:\nfunc (m Model) View() string → func (m Model) View() tea.View\nReturn tea.NewView(mainView)\n\n4.3 Update key handling:\ncase tea.KeyMsg → case tea.KeyPressMsg\nUpdate handleKey() signature and all downstream handlers\n\n4.4 Update rune access:\nmsg.Runes → msg.Text","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:33.015445-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:12:53.154885-06:00","closed_at":"2026-02-01T00:12:53.154885-06:00","close_reason":"Completed migration - build and tests pass","dependencies":[{"issue_id":"hive-21w.4","depends_on_id":"hive-21w","type":"parent-child","created_at":"2026-01-31T23:17:33.017253-06:00","created_by":"Hayden"},{"issue_id":"hive-21w.4","depends_on_id":"hive-21w.3","type":"blocks","created_at":"2026-01-31T23:18:03.59648-06:00","created_by":"Hayden"}]}
{"id":"hive-21w.5","title":"Phase 5: Implement Canvas/Layer compositing for modals","description":"Replace lipgloss.Place() with Canvas/Layer for true overlay compositing.\n\nPattern change:\n- Before: lipgloss.Place() replaces background\n- After: Canvas/Layer composites modal over visible background\n\nFiles to update:\n- internal/tui/modal.go - Overlay() method\n- internal/tui/output_modal.go - Overlay() method\n- internal/tui/message_preview_modal.go - Overlay() method\n- internal/tui/model.go - Form overlay section\n\nNew pattern:\nbgLayer := lipgloss.NewLayer(background).Z(0)\nmodalLayer := lipgloss.NewLayer(modal).X(centerX).Y(centerY).Z(1)\ncanvas := lipgloss.NewCanvas(width, height)\ncanvas.Compose(bgLayer)\ncanvas.Compose(modalLayer)\nreturn canvas.Render()","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:38.320299-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:15:37.310122-06:00","closed_at":"2026-02-01T00:15:37.310122-06:00","close_reason":"Implemented Canvas/Layer compositing for all modals","dependencies":[{"issue_id":"hive-21w.5","depends_on_id":"hive-21w","type":"parent-child","created_at":"2026-01-31T23:17:38.321469-06:00","created_by":"Hayden"},{"issue_id":"hive-21w.5","depends_on_id":"hive-21w.4","type":"blocks","created_at":"2026-01-31T23:18:08.764877-06:00","created_by":"Hayden"}]}
{"id":"hive-21w.6","title":"Phase 6: Verify huh form compatibility","description":"Verify huh form library works with V2 stack.\n\nFiles to check:\n- internal/tui/new_session_form.go - Verify huh works with V2\n- internal/styles/styles.go - Verify FormTheme() works with V2 styles\n\nMay need huh library update if incompatible.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:17:43.528955-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:15:54.724302-06:00","closed_at":"2026-02-01T00:15:54.724302-06:00","close_reason":"Verified: huh renders but commands incompatible with V2 (see hive-ayy). Workaround in place - ignoring v1 commands.","dependencies":[{"issue_id":"hive-21w.6","depends_on_id":"hive-21w","type":"parent-child","created_at":"2026-01-31T23:17:43.530047-06:00","created_by":"Hayden"},{"issue_id":"hive-21w.6","depends_on_id":"hive-21w.5","type":"blocks","created_at":"2026-01-31T23:18:13.92528-06:00","created_by":"Hayden"}]}
{"id":"hive-22b","title":"Add PendingCreate type and field to TUI Model","description":"Add a PendingCreate struct and field to the TUI Model to hold session creation data that will be executed after TUI exits.\n\n## Changes to internal/tui/model.go\n\n1. Add the PendingCreate type:\n```go\n// PendingCreate holds data for a session to create after TUI exits\ntype PendingCreate struct {\n    Remote string\n    Name   string\n}\n```\n\n2. Add field to Model struct:\n```go\ntype Model struct {\n    // ... existing fields\n    pendingCreate *PendingCreate\n}\n```\n\n3. Add getter method for external access:\n```go\n// PendingCreate returns any pending session creation data\nfunc (m Model) PendingCreate() *PendingCreate {\n    return m.pendingCreate\n}\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:00.086642-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:29:11.084344-06:00","closed_at":"2026-01-30T21:29:11.084344-06:00","close_reason":"Added PendingCreate type, field to Model struct, and getter method"}
{"id":"hive-2l6","title":"Fix command palette input layout and help text width","description":"## Problem\n\nThe command palette input hint text is too narrow and gets cut off, making it hard to read the full help text for commands.\n\n## Current Issue\n\n- Help text gets truncated: \"Send to Claude for rev...\"\n- Input area doesn't utilize available width effectively\n- Layout could be improved for better readability\n\n## Reference Implementation\n\nLook at the session creation form (NewSessionForm) for layout patterns:\n- How it handles input width\n- How it displays help/hint text\n- How it utilizes available modal width\n\n## Desired Behavior\n\n- Full help text should be visible (or wrap if very long)\n- Input area should use available width effectively\n- Help text should be readable without truncation\n- Consider multi-line help text if needed\n\n## Implementation Notes\n\n- Review internal/tui/command_palette.go View() method\n- Check modalStyle width calculations\n- Look at session form layout in internal/tui/model.go (NewSessionForm)\n- May need to adjust rendering of suggestions to allow more width for help text\n\n## Files\n\n- internal/tui/command_palette.go (View method around line 157)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T13:26:48.665159-06:00","created_by":"Hayden","updated_at":"2026-02-01T13:33:02.483128-06:00","closed_at":"2026-02-01T13:33:02.483128-06:00","close_reason":"Closed"}
{"id":"hive-32a","title":"Unify template rendering between Spawner and Recycler","description":"**Files**: `internal/hive/spawner.go`, `internal/hive/recycler.go`, `pkg/tmpl/tmpl.go`\n**Risk**: Low\n\n## Problem\n\nSpawner uses `tmpl.Render()` from `pkg/tmpl` while Recycler implements its own `renderCommand()` method. Both do the same thing but with slightly different error handling.\n\n**Spawner (line 48):**\n```go\nrendered, err := tmpl.Render(cmdTmpl, data)\n```\n\n**Recycler (lines 61-72):**\n```go\nfunc (r *Recycler) renderCommand(cmd string, data RecycleData) (string, error) {\n    tmpl, err := template.New(\"cmd\").Parse(cmd)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(\u0026buf, data); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n```\n\n## Solution\n\nUpdate Recycler to use `tmpl.Render()`:\n\n1. Remove `renderCommand()` method from Recycler\n2. Remove `bytes`, `text/template` imports from recycler.go\n3. Add `github.com/hay-kot/hive/pkg/tmpl` import\n4. Use `tmpl.Render()` in the Recycle method\n\n```go\nfunc (r *Recycler) Recycle(ctx context.Context, path string, commands []string, data RecycleData, w io.Writer) error {\n    // ...\n    for _, cmd := range commands {\n        rendered, err := tmpl.Render(cmd, data)\n        if err != nil {\n            return fmt.Errorf(\"render recycle command %q: %w\", cmd, err)\n        }\n        // ...\n    }\n}\n```\n\n## Impact\n- Single template rendering implementation\n- Recycler gets access to `shq` shell-quoting function\n- Consistent error wrapping (`parse template:` vs raw error)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:38.859043-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:41.860742-06:00","closed_at":"2026-01-30T19:08:41.860742-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-32a","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.146421-06:00","created_by":"Hayden"}]}
{"id":"hive-36y","title":"Terminal Integration System for Hive","description":"# Plan: Terminal Integration System for Hive\n\n## Overview\n\nAdd opt-in terminal multiplexer integration to hive for monitoring agent session status (active/waiting/idle). Uses a strategy pattern so tmux is the first implementation, with easy extension to wezterm, kitty, etc.\n\n## Design Principles\n\n1. **Opt-in via config** - `integrations.terminal.enabled: [tmux]`\n2. **Convention-based linking** - Spawn templates use `{{ .Slug }}` for predictable session names\n3. **Follow existing patterns** - Mirror `gitstatus.go` for async status polling\n4. **Minimal session changes** - Add `Metadata map[string]string` for integration data\n\n## Config Addition\n\n```yaml\nintegrations:\n  terminal:\n    enabled: [tmux]           # list of enabled integrations\n    poll_interval: 500ms      # status check frequency\n```\n\n## File Changes\n\n### Phase 1: Core Infrastructure\n\n**1. `internal/core/config/config.go`** - Add integrations config\n```go\ntype Config struct {\n    // ... existing ...\n    Integrations IntegrationsConfig `yaml:\"integrations\"`\n}\n\ntype IntegrationsConfig struct {\n    Terminal TerminalConfig `yaml:\"terminal\"`\n}\n\ntype TerminalConfig struct {\n    Enabled      []string      `yaml:\"enabled\"`       // [\"tmux\"]\n    PollInterval time.Duration `yaml:\"poll_interval\"` // default 500ms\n}\n```\n\n**2. `internal/core/session/session.go`** - Add metadata field\n```go\ntype Session struct {\n    // ... existing ...\n    Metadata map[string]string `json:\"metadata,omitempty\"`\n}\n\nconst (\n    MetaTmuxSession = \"tmux_session\"\n    MetaTmuxPane    = \"tmux_pane\"\n)\n```\n\n### Phase 2: Integration Interface\n\n**3. New `internal/integration/terminal/terminal.go`**\n```go\ntype Status string\nconst (\n    StatusActive  Status = \"active\"   // Green - agent working\n    StatusWaiting Status = \"waiting\"  // Yellow - needs input\n    StatusIdle    Status = \"idle\"     // Gray - done\n    StatusMissing Status = \"missing\"  // Session not found\n)\n\ntype SessionInfo struct {\n    Name         string\n    Status       Status\n    DetectedTool string // claude, gemini, etc.\n}\n\ntype Integration interface {\n    Name() string\n    Available() bool\n    DiscoverSession(ctx context.Context, slug string, metadata map[string]string) (*SessionInfo, error)\n    GetStatus(ctx context.Context, info *SessionInfo) (Status, error)\n    RefreshCache() // Called once per poll cycle\n}\n```\n\n**4. New `internal/integration/terminal/detector.go`** - Status detection patterns\n- Busy: \"ctrl+c to interrupt\", spinner chars (⠋⠙⠹⠸⠼⠴⠦⠧⠇⠏)\n- Waiting: \"❯\", \"Yes, allow once\", permission dialogs\n- Tool detection: claude, gemini, opencode keywords\n\n**5. New `internal/integration/terminal/tmux/tmux.go`** - Tmux implementation\n- `RefreshCache()`: Single `tmux list-windows -a -F \"#{session_name}\\t#{window_activity}\"` call\n- `DiscoverSession()`: Match by exact slug, or check metadata for custom session name\n- `GetStatus()`: `tmux capture-pane -p -S -50` + pattern detection\n\n### Phase 3: TUI Integration\n\n**6. New `internal/tui/terminalstatus.go`** - Parallel to gitstatus.go\n```go\ntype TerminalStatus struct {\n    Status    terminal.Status\n    Tool      string\n    IsLoading bool\n    Error     error\n}\n\ntype terminalStatusBatchCompleteMsg struct {\n    Results map[string]TerminalStatus // sessionID -\u003e status\n}\n\nfunc fetchTerminalStatusBatch(mgr *terminal.Manager, sessions []Session, workers int) tea.Cmd\n```\n\n**7. Update `internal/tui/model.go`**\n- Add `terminalManager *terminal.Manager`\n- Add `terminalStatuses *kv.Store[string, TerminalStatus]`\n- Handle `terminalPollTickMsg` and `terminalStatusBatchCompleteMsg`\n\n**8. Update `internal/tui/tree_view.go`** - Modify bracket status indicators\n\nCurrent indicators:\n- `[●]` green - active hive session\n- `[○]` gray - recycled session\n\nNew hybrid indicators (icon + color change):\n| State | Icon | Color | Meaning |\n|-------|------|-------|---------|\n| Terminal active | `[●]` | green | Agent working (spinner/busy detected) |\n| Terminal waiting | `[]` | yellow | Needs user input (prompt detected) |\n| Terminal idle | `[○]` | gray | Done/acknowledged |\n| Terminal unknown | `[?]` | dim | No terminal found or integration disabled |\n| Recycled | `[○]` | gray | Session recycled (unchanged) |\n\nExample output:\n```\n├─ [●] Session-A #abc1 (main) +5 -2 • clean     # green ● = agent working\n├─ [] Session-B #def4 (feat) +0 -0 • clean     # yellow  = needs input\n├─ [○] Session-C #ghi7 (main) +0 -0 • clean     # gray ○ = idle/done\n└─ [?] Session-D #jkl0 (main) +0 -0 • clean     # dim ? = no terminal found\n```\n\nThe `renderSession()` function:\n1. If recycled → `[○]` gray (unchanged)\n2. If terminal integration disabled → `[●]` green (current behavior)\n3. If terminal status available → hybrid icon based on status\n4. If terminal not found → `[?]` dim\n\n### Phase 4: Wiring\n\n**9. Update `internal/commands/cmd_tui.go`**\n- Check config for enabled integrations\n- Initialize terminal.Manager if integrations enabled\n- Pass to TUI model\n\n## New File Structure\n\n```\ninternal/\n  integration/\n    terminal/\n      terminal.go       # Interface + Status types\n      detector.go       # Pattern matching for status detection\n      manager.go        # Registry for integrations\n      tmux/\n        tmux.go         # Tmux implementation\n        tmux_test.go\n```\n\n## Performance Optimizations\n\n1. **Single tmux call per cycle** - `list-windows -a` caches all sessions (O(1) vs O(n))\n2. **Skip inactive sessions** - Only poll active hive sessions\n3. **Reuse git workers** - Same worker pool config (`git.status_workers`)\n4. **Content caching** - Don't re-capture if activity timestamp unchanged\n\n## Session Linking Strategy\n\n1. **Primary**: Spawn template uses slug directly as session name\n   ```yaml\n   spawn:\n     - tmux new-session -d -s \"{{ .Slug }}\" -c \"{{ .Path }}\"\n   ```\n2. **Discovery**: Integration looks up session by exact slug match\n3. **Fallback**: User can store `tmux_session` in session metadata for custom names\n\n## Verification\n\n1. Add `integrations.terminal.enabled: [tmux]` to config\n2. Update spawn template to use `{{ .Slug }}` as tmux session name\n3. Create a new session - TUI should show `[?]` initially (no terminal)\n4. Once tmux session starts - status should update within 500ms\n5. Run Claude in the tmux session:\n   - While thinking → `[●]` green\n   - At prompt → `[]` yellow\n   - After acknowledge → `[○]` gray\n6. Unit tests for detector patterns (busy/waiting/idle detection)\n\n## Files to Modify (Summary)\n\n| File | Change |\n|------|--------|\n| `internal/core/config/config.go` | Add IntegrationsConfig |\n| `internal/core/session/session.go` | Add Metadata field |\n| `internal/tui/model.go` | Add terminal status state |\n| `internal/tui/tree_view.go` | Render status icons |\n| `internal/commands/cmd_tui.go` | Initialize integration manager |\n\n## New Files\n\n| File | Purpose |\n|------|---------|\n| `internal/integration/terminal/terminal.go` | Interface + types |\n| `internal/integration/terminal/detector.go` | Status pattern matching |\n| `internal/integration/terminal/manager.go` | Integration registry |\n| `internal/integration/terminal/tmux/tmux.go` | Tmux implementation |\n| `internal/tui/terminalstatus.go` | TUI polling logic |\n","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:23.457847-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:31:21.924599-06:00","closed_at":"2026-01-31T17:31:21.924599-06:00","close_reason":"Terminal Integration System complete: config, session metadata, terminal interface, detector patterns, tmux integration, manager, TUI polling, tree view status indicators, and unit tests all implemented"}
{"id":"hive-36y.1","title":"Add IntegrationsConfig to config.go","description":"Add IntegrationsConfig struct with TerminalConfig to internal/core/config/config.go. Include Enabled []string and PollInterval time.Duration fields with appropriate defaults.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:28.059199-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:23:46.759387-06:00","closed_at":"2026-01-31T17:23:46.759387-06:00","close_reason":"Added IntegrationsConfig and TerminalConfig to config.go with Enabled []string, PollInterval (default 500ms), and IsEnabled helper method","dependencies":[{"issue_id":"hive-36y.1","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:28.06-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.10","title":"Wire up integration manager in cmd_tui.go","description":"Update internal/commands/cmd_tui.go to check config for enabled integrations, initialize terminal.Manager if enabled, and pass to TUI model.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:45.716688-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:30:37.066402-06:00","closed_at":"2026-01-31T17:30:37.066402-06:00","close_reason":"Wired up terminal manager in cmd_tui.go: creates Manager with enabled integrations from config, registers tmux integration, passes to TUI via Options","dependencies":[{"issue_id":"hive-36y.10","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:45.717449-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.10","depends_on_id":"hive-36y.8","type":"blocks","created_at":"2026-01-31T17:15:57.87863-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.10","depends_on_id":"hive-36y.5","type":"blocks","created_at":"2026-01-31T17:15:57.939169-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.11","title":"Add unit tests for detector patterns","description":"Add tests for detector.go covering busy detection (spinners, ctrl+c text), waiting detection (prompts, permission dialogs), and tool detection.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:47.036018-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:31:20.401004-06:00","closed_at":"2026-01-31T17:31:20.401004-06:00","close_reason":"Added comprehensive unit tests for detector patterns: IsBusy, IsWaiting, DetectStatus, DetectTool, and stripANSI - all 29 test cases pass","dependencies":[{"issue_id":"hive-36y.11","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:47.03679-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.11","depends_on_id":"hive-36y.4","type":"blocks","created_at":"2026-01-31T17:15:57.998804-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.2","title":"Add Metadata field to Session struct","description":"Add Metadata map[string]string field to Session struct in internal/core/session/session.go. Add constants for MetaTmuxSession and MetaTmuxPane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:29.274434-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:24:13.034789-06:00","closed_at":"2026-01-31T17:24:13.034789-06:00","close_reason":"Added Metadata map[string]string field to Session struct with MetaTmuxSession/MetaTmuxPane constants and GetMeta/SetMeta helper methods","dependencies":[{"issue_id":"hive-36y.2","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:29.275428-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.3","title":"Create terminal integration interface","description":"Create internal/integration/terminal/terminal.go with Status type, SessionInfo struct, and Integration interface. Define StatusActive, StatusWaiting, StatusIdle, StatusMissing constants.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:31.058179-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:24:33.655433-06:00","closed_at":"2026-01-31T17:24:33.655433-06:00","close_reason":"Created internal/integration/terminal/terminal.go with Status type (Active/Waiting/Idle/Missing), SessionInfo struct, and Integration interface","dependencies":[{"issue_id":"hive-36y.3","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:31.059029-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.3","depends_on_id":"hive-36y.1","type":"blocks","created_at":"2026-01-31T17:15:57.371074-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.4","title":"Implement status detector patterns","description":"Create internal/integration/terminal/detector.go with pattern matching for busy indicators (ctrl+c to interrupt, spinners), waiting indicators (prompt, permission dialogs), and tool detection (claude, gemini, opencode).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:33.257964-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:25:11.135759-06:00","closed_at":"2026-01-31T17:25:11.135759-06:00","close_reason":"Created detector.go with IsBusy/IsWaiting/DetectStatus/DetectTool functions, spinner character detection, permission prompt patterns, and ANSI stripping","dependencies":[{"issue_id":"hive-36y.4","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:33.258689-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.4","depends_on_id":"hive-36y.3","type":"blocks","created_at":"2026-01-31T17:15:57.455195-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.5","title":"Implement tmux integration","description":"Create internal/integration/terminal/tmux/tmux.go implementing the Integration interface. Include RefreshCache() with single tmux list-windows call, DiscoverSession() matching by slug, and GetStatus() using capture-pane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:34.531632-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:25:47.916783-06:00","closed_at":"2026-01-31T17:25:47.916783-06:00","close_reason":"Created internal/integration/terminal/tmux/tmux.go with Integration struct implementing RefreshCache (single list-windows call), DiscoverSession (slug/metadata matching), GetStatus (capture-pane + detector), and session caching","dependencies":[{"issue_id":"hive-36y.5","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:34.532501-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.5","depends_on_id":"hive-36y.3","type":"blocks","created_at":"2026-01-31T17:15:57.518382-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.5","depends_on_id":"hive-36y.4","type":"blocks","created_at":"2026-01-31T17:15:57.576912-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.6","title":"Create integration manager","description":"Create internal/integration/terminal/manager.go with Manager struct to register and retrieve integrations by name.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:35.568903-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:26:19.808987-06:00","closed_at":"2026-01-31T17:26:19.808987-06:00","close_reason":"Created manager.go with Manager struct for registering/retrieving integrations, RefreshAll, DiscoverSession across all enabled integrations, and HasEnabledIntegrations helper","dependencies":[{"issue_id":"hive-36y.6","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:35.569631-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.6","depends_on_id":"hive-36y.3","type":"blocks","created_at":"2026-01-31T17:15:57.639811-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.7","title":"Create TUI terminal status polling","description":"Create internal/tui/terminalstatus.go parallel to gitstatus.go. Include TerminalStatus struct, terminalStatusBatchCompleteMsg, and fetchTerminalStatusBatch function using worker pool.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:40.035561-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:26:44.793571-06:00","closed_at":"2026-01-31T17:26:44.793571-06:00","close_reason":"Created terminalstatus.go with TerminalStatus struct, fetchTerminalStatusBatch using worker pool, and startTerminalPollTicker for periodic polling","dependencies":[{"issue_id":"hive-36y.7","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:40.036284-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.7","depends_on_id":"hive-36y.6","type":"blocks","created_at":"2026-01-31T17:15:57.699296-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.8","title":"Update TUI model for terminal status","description":"Update internal/tui/model.go to add terminalManager, terminalStatuses store, and handle terminalPollTickMsg and terminalStatusBatchCompleteMsg messages.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:41.693114-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:27:40.552551-06:00","closed_at":"2026-01-31T17:27:40.552551-06:00","close_reason":"Updated model.go with terminalManager and terminalStatuses fields, added handling for terminalPollTickMsg and terminalStatusBatchCompleteMsg messages","dependencies":[{"issue_id":"hive-36y.8","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:41.693802-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.8","depends_on_id":"hive-36y.7","type":"blocks","created_at":"2026-01-31T17:15:57.759783-06:00","created_by":"Hayden"}]}
{"id":"hive-36y.9","title":"Update tree view for hybrid status indicators","description":"Update internal/tui/tree_view.go to render hybrid status indicators in brackets: [●] green=active, [] yellow=waiting, [○] gray=idle, [?] dim=unknown. Use nerdfonts, no emojis.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:15:43.894552-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:29:17.972166-06:00","closed_at":"2026-01-31T17:29:17.972166-06:00","close_reason":"Updated tree_view.go with hybrid status indicators ([●]=active, []=waiting, [○]=idle, [?]=unknown), added renderStatusIndicator helper, added TerminalStatuses to TreeDelegate","dependencies":[{"issue_id":"hive-36y.9","depends_on_id":"hive-36y","type":"parent-child","created_at":"2026-01-31T17:15:43.895322-06:00","created_by":"Hayden"},{"issue_id":"hive-36y.9","depends_on_id":"hive-36y.8","type":"blocks","created_at":"2026-01-31T17:15:57.819652-06:00","created_by":"Hayden"}]}
{"id":"hive-3h3","title":"Fix tmux preview panel width calculation and truncation","description":"## Problem\n\nThe tmux preview panel is not rendering correctly:\n- Lines are being truncated (showing \"...\") even when there's plenty of horizontal space\n- Preview panel doesn't utilize full available terminal width\n- Content appears constrained to ~100-120 columns when terminal is much wider\n\n## Observations from Testing\n\n1. **Terminal shows 200+ columns wide** but preview content truncates much earlier\n2. **List panel is correct** at 25% width (~50 cols for 200-wide terminal)\n3. **Preview divider lines are short** (~100 chars) indicating usableWidth calculation is wrong\n4. **Right-alignment works** but content is too narrow\n\n## Code Location\n\nPrimary file: `internal/tui/model.go`\n- `renderDualColumnLayout()` (lines ~1093-1190)\n- Width calculation at lines 1100-1106\n- Content width detection at lines 1113-1152\n- Preview rendering at lines 1164-1190\n\n## Current Logic\n\n```go\nlistWidth := int(float64(m.width) * 0.25)\navailablePreviewWidth := m.width - listWidth\nusableWidth := availablePreviewWidth - 3  // for border/padding\n\n// Find max line width in content\n// Cap at usableWidth\n// Build preview with that width\n```\n\n## Hypothesis\n\n1. **m.width might be wrong** - if WindowSizeMsg reports incorrect width\n2. **Calculation error** - math in width calculation chain\n3. **Lipgloss rendering issue** - style constraints conflicting\n4. **ANSI width calculation** - ansi.StringWidth() not accounting for something\n\n## What We've Tried\n\n1. ✅ Changed split from 35/65 to 25/75\n2. ✅ Added preview header with session metadata  \n3. ✅ Made tree view minimal in preview mode (status + name + ID)\n4. ✅ Content-based width calculation (scan for longest line)\n5. ✅ Right-alignment with spacer\n6. ❌ Still truncating unnecessarily\n\n## Next Steps to Investigate\n\n1. **Add debug output** to see actual values:\n   - m.width (terminal width reported by Bubble Tea)\n   - listWidth (calculated 25%)\n   - availablePreviewWidth (remaining space)\n   - maxLineWidth (actual content width)\n   - previewWidth (final calculated width)\n\n2. **Test with fixed values** - hardcode a large previewWidth to confirm issue\n\n3. **Check WindowSizeMsg** - verify terminal dimensions are correct:\n   ```go\n   case tea.WindowSizeMsg:\n       // Add logging here\n       m.width = msg.Width\n       m.height = msg.Height\n   ```\n\n4. **Verify lipgloss Width()** - check if lipgloss.Width(previewView) matches expected\n\n5. **Test renderPreviewHeader** - divider length reveals usableWidth value:\n   ```go\n   divider := strings.Repeat(\"─\", maxWidth)\n   ```\n\n## Files to Review\n\n- internal/tui/model.go (lines 303-325, 1093-1190)\n- internal/tui/tree_view.go (lines 481-495 for minimal rendering)\n\n## Acceptance Criteria\n\n- Preview panel shows full content when terminal is wide enough\n- Lines only truncate when they actually exceed available space\n- Preview width matches longest line (up to available space)\n- Right-aligned against terminal edge\n- Divider lines span full preview width (not truncated)","status":"closed","priority":2,"issue_type":"task","assignee":"Hayden","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T16:32:09.906372-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:47:10.292955-06:00","closed_at":"2026-02-01T16:47:10.292955-06:00","close_reason":"Fixed in 9e7388c. Added ensureExactWidth/Height utilities and smart truncation.","labels":["enhancement","preview","tui"]}
{"id":"hive-3p8","title":"Investigate tmux integration patterns from Agent Deck","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:55:57.990638-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:22:43.900287-06:00","closed_at":"2026-01-31T17:22:43.900287-06:00","close_reason":"Investigation complete. Key patterns from Agent Deck: (1) Single tmux list-windows call with session cache for O(1) lookups, (2) capture-pane -p -J with 500ms cache + singleflight deduplication, (3) Pattern-based detection: busy indicators (spinners, ctrl+c to interrupt) and prompt indicators (permission dialogs, \u003e prompt), (4) Spike detection (2+ activity changes in 1s) to filter cursor blinks, (5) Three states: active/waiting/idle mapped to green/yellow/gray"}
{"id":"hive-4fk","title":"Restore Prompt to BatchSession and CreateOptions","description":"Re-add Prompt field to:\n- BatchSession struct in cmd_batch.go (for JSON input)\n- CreateOptions struct in service.go (to pass through)\n- SpawnData struct in spawner.go (for template rendering)\n\nDo NOT add Prompt back to Session struct (it's transient, not persisted).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:34.995695-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:14.822067-06:00","closed_at":"2026-01-30T13:22:14.822067-06:00","close_reason":"Added Prompt field to BatchSession, CreateOptions, and SpawnData"}
{"id":"hive-4gc","title":"Remove Modal wrapper from new session form","description":"The new session form uses a Modal wrapper that adds Confirm/Cancel buttons, but huh forms have their own built-in confirm handling with proper keyboard shortcuts.\n\n## Current behavior\n- Modal wrapper adds extra Confirm/Cancel buttons below the form\n- User can't interact with these buttons properly\n- Duplicates the help text that huh already shows\n\n## Expected behavior\n- Use huh form directly without Modal wrapper\n- Let huh handle confirm (enter) and cancel (esc) natively\n- Form should show huh's built-in help for navigation\n\n## Files to modify\n- internal/tui/model.go - View() function renders the form modal\n- internal/tui/new_session_form.go - may need to configure form differently","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:16:12.754956-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.135741-06:00","closed_at":"2026-01-30T21:20:35.135741-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation"}
{"id":"hive-4gr","title":"Add scheduleSessionRefresh to polling.go","description":"Add session refresh scheduling to internal/tui/polling.go:\n\n1. Add scheduling function:\n```go\nfunc (m Model) scheduleSessionRefresh() tea.Cmd {\n    interval := m.cfg.TUI.RefreshInterval\n    if interval == 0 {\n        interval = 15 * time.Second\n    }\n    return tea.Tick(interval, func(t time.Time) tea.Msg {\n        return sessionRefreshTickMsg{}\n    })\n}\n```\n\n2. Update Init() to start refresh timer:\n```go\nreturn tea.Batch(\n    m.loadSessions(),\n    m.schedulePollTick(),\n    m.scheduleSessionRefresh(),  // Add this\n)\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:26:04.931782-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:34:07.618981-06:00","closed_at":"2026-01-30T23:34:07.618981-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4gr","depends_on_id":"hive-0tq","type":"parent-child","created_at":"2026-01-30T23:26:20.758088-06:00","created_by":"Hayden"},{"issue_id":"hive-4gr","depends_on_id":"hive-ev5","type":"blocks","created_at":"2026-01-30T23:26:27.865656-06:00","created_by":"Hayden"}]}
{"id":"hive-4nw","title":"Remove 'showing local' subheading","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:24.611541-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:11:16.64312-06:00","closed_at":"2026-01-30T17:11:16.64312-06:00","close_reason":"Already done when removing toggle options - buildSubheading now returns empty string."}
{"id":"hive-4og","title":"Standardize git executor error messages","description":"**Files**: `internal/core/git/executor.go`\n**Risk**: Very Low\n\n## Problem\n\nError messages have inconsistent formats:\n\n| Method | Current Error | Issue |\n|--------|--------------|-------|\n| Clone | `clone %s to %s: %w` | Has args, no prefix |\n| Checkout | `checkout %s: %w` | Has arg, no prefix |\n| Pull | `pull: %w` | No context |\n| ResetHard | `reset --hard: %w` | Command literal |\n| RemoteURL | `get remote url: %w` | Description |\n| IsClean | `git status: %w` | Has git prefix |\n| Branch | `git branch: %w` | Has git prefix |\n| DiffStats | `git diff: %w` | Has git prefix |\n\n## Solution\n\nStandardize to format: `git \u003ccommand\u003e[ \u003ccontext\u003e]: \u003cerror\u003e`\n\n```go\nfunc (e *Executor) Clone(ctx context.Context, url, dest string) error {\n    if _, err := e.exec.Run(ctx, e.gitPath, \"clone\", url, dest); err != nil {\n        return fmt.Errorf(\"git clone: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Checkout(ctx context.Context, dir, branch string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"checkout\", branch); err != nil {\n        return fmt.Errorf(\"git checkout %s: %w\", branch, err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Pull(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"pull\"); err != nil {\n        return fmt.Errorf(\"git pull: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) ResetHard(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"reset\", \"--hard\"); err != nil {\n        return fmt.Errorf(\"git reset --hard: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) RemoteURL(ctx context.Context, dir string) (string, error) {\n    out, err := e.exec.RunDir(ctx, dir, e.gitPath, \"remote\", \"get-url\", \"origin\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"git remote get-url: %w\", err)\n    }\n    return strings.TrimSpace(string(out)), nil\n}\n```\n\n## Impact\n- Consistent error messages aid debugging\n- Users can easily identify which git command failed","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:18.652926-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:07:15.606707-06:00","closed_at":"2026-01-30T19:07:15.606707-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4og","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:48.971094-06:00","created_by":"Hayden"}]}
{"id":"hive-4qy","title":"Add sessionRefreshTickMsg and handler to model.go","description":"Add refresh tick handling to internal/tui/model.go:\n\n1. Add new message type:\n```go\ntype sessionRefreshTickMsg struct{}\n```\n\n2. Add field to Model:\n```go\nlastSessionRefresh time.Time\n```\n\n3. Handle in Update():\n```go\ncase sessionRefreshTickMsg:\n    if m.activeView == viewSessions \u0026\u0026 !m.isModalActive() {\n        return m, tea.Batch(\n            m.loadSessions(),\n            m.scheduleSessionRefresh(),\n        )\n    }\n    return m, m.scheduleSessionRefresh()\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:26:00.177204-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:34:07.595969-06:00","closed_at":"2026-01-30T23:34:07.595969-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-4qy","depends_on_id":"hive-0tq","type":"parent-child","created_at":"2026-01-30T23:26:20.663416-06:00","created_by":"Hayden"},{"issue_id":"hive-4qy","depends_on_id":"hive-ev5","type":"blocks","created_at":"2026-01-30T23:26:27.768675-06:00","created_by":"Hayden"}]}
{"id":"hive-4rw","title":"Add tests for unified command model","description":"Add comprehensive tests for the new unified command model.\n\n## Test Cases\n\n### Config Validation\n- Valid: UserCommand with action field\n- Valid: UserCommand with sh field  \n- Invalid: UserCommand with both action and sh\n- Invalid: UserCommand with neither action nor sh\n- Valid: Keybinding with cmd referencing existing command\n- Invalid: Keybinding with cmd referencing non-existent command\n- Invalid: Keybinding without cmd field\n\n### Default Commands\n- System provides Recycle and Delete commands\n- User can override system commands\n- Default keybindings reference system commands\n\n### Resolution\n- Resolve keybinding → looks up command → returns correct Action\n- ActionTypeRecycle for commands with action: recycle\n- ActionTypeDelete for commands with action: delete\n- ActionTypeShell for commands with sh\n- Keybinding overrides (help, confirm) take precedence\n\n### Command Palette\n- Shows both system and user commands\n- System commands (Recycle, Delete) can be invoked via palette\n\n### Recycled Session Protection\n- Recycled sessions still only allow Delete action","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T10:44:58.120357-06:00","created_by":"Hayden","updated_at":"2026-02-02T10:57:06.176558-06:00","closed_at":"2026-02-02T10:57:06.176558-06:00","close_reason":"Added comprehensive tests for unified command model including override behavior, action-based commands, help entries","dependencies":[{"issue_id":"hive-4rw","depends_on_id":"hive-uja","type":"blocks","created_at":"2026-02-02T10:45:12.083392-06:00","created_by":"Hayden"}]}
{"id":"hive-4s8","title":"Implement repository scanner","description":"Create new file internal/tui/repo_scanner.go\n\n## Types\n- DiscoveredRepo struct with Path, Name, Remote fields\n\n## Function\n- ScanRepoDirs(ctx, dirs []string, gitExec git.Git) ([]DiscoveredRepo, error)\n- Scan each directory for subdirectories containing .git folder\n- Get remote URL via git.RemoteURL()\n- Sort results alphabetically by name\n- Handle errors gracefully (skip repos that fail)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:33.483757-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:29:21.143595-06:00","closed_at":"2026-01-30T19:29:21.143595-06:00","close_reason":"Created repo_scanner.go with DiscoveredRepo type and ScanRepoDirs function","dependencies":[{"issue_id":"hive-4s8","depends_on_id":"hive-ejn","type":"blocks","created_at":"2026-01-30T19:21:41.244135-06:00","created_by":"Hayden"},{"issue_id":"hive-4s8","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.789103-06:00","created_by":"Hayden"}]}
{"id":"hive-50a","title":"Add activity-based busy detection using tmux window_activity","description":"Improve busy detection to prevent premature gray/idle status while Claude is working.\n\nCurrent problem: Goes gray while Claude is still outputting text because we only check for spinner/interrupt indicators.\n\nSolution - use tmux window_activity timestamp:\n- Track last activity timestamp per session  \n- Spike detection: 2+ activity changes within 1 second = sustained activity\n- If activity within last 2 seconds and no prompt detected → show active (green)\n- Only show idle (gray) when truly idle: no recent activity AND no prompt\n\nThis keeps the status accurate: green while working, yellow when waiting for input, gray only when done.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:42:46.158798-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:49:31.607072-06:00","closed_at":"2026-01-31T17:49:31.607072-06:00","close_reason":"Implemented activity-based busy detection using tmux window_activity timestamp. The detector now considers: (1) content-based indicators (spinners, interrupt messages), (2) waiting prompts, and (3) recent activity timestamps. If activity occurred within 2 seconds and no prompt is detected, status shows as active.","dependencies":[{"issue_id":"hive-50a","depends_on_id":"hive-ein","type":"blocks","created_at":"2026-01-31T17:42:50.430195-06:00","created_by":"Hayden"}]}
{"id":"hive-55z","title":"Implement message preview modal with markdown rendering","description":"Add a message preview modal that opens when user presses \u003center\u003e on a selected message.\n\nRequirements:\n- Open modal on enter key when message is selected\n- Display full message content rendered as markdown\n- Show message metadata (topic, sender, timestamp, session ID)\n- Support scrolling for long messages (viewport)\n- Close with esc or enter\n- Style consistently with existing modals (OutputModal pattern)\n\nImplementation:\n- Create MessagePreviewModal component\n- Integrate glamour for markdown rendering\n- Add keybinding handler for enter on messages\n- Wire into model Update/View cycle","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:16.731602-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:46:18.424529-06:00","closed_at":"2026-01-30T13:46:18.424529-06:00","close_reason":"Implemented message preview modal with glamour markdown rendering, viewport scrolling, and keyboard navigation","dependencies":[{"issue_id":"hive-55z","depends_on_id":"hive-gmj","type":"blocks","created_at":"2026-01-30T13:32:25.065727-06:00","created_by":"Hayden"}]}
{"id":"hive-5eb","title":"Create Huh form dialog component","description":"Create new file internal/tui/new_session_form.go\n\n## Component\n- NewSessionForm struct wrapping huh.Form\n- Implements tea.Model interface for Bubble Tea integration\n\n## Form Fields\n- Repository select (filterable) - options from discovered repos\n- Session name input with validation (non-empty)\n\n## Features\n- Auto-selection: pre-select repo matching preselectedRemote parameter\n- Use styles.FormTheme() for Tokyo Night styling\n- Track submitted/cancelled state","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:34.635593-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:30:30.550655-06:00","closed_at":"2026-01-30T19:30:30.550655-06:00","close_reason":"Created new_session_form.go with NewSessionForm wrapping huh.Form","dependencies":[{"issue_id":"hive-5eb","depends_on_id":"hive-4s8","type":"blocks","created_at":"2026-01-30T19:21:41.303554-06:00","created_by":"Hayden"},{"issue_id":"hive-5eb","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.851038-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn","title":"fsnotify Implementation for Message Store","description":"# fsnotify Implementation Plan\n\nReplace 500ms polling with fsnotify-based file watching for message store notifications.\n\n## Summary\n\nAdd a `TopicWatcher` component that uses fsnotify to watch the topics directory and notify subscribers when topic files change. This reduces CPU usage and improves message delivery latency from up to 500ms to near-instant.\n\n## Files to Create\n\n### `internal/core/messaging/watcher.go`\nNew file defining the watcher interface:\n\n```go\ntype TopicEvent struct {\n    Topic     string\n    Timestamp time.Time\n}\n\ntype Watcher interface {\n    Watch(ctx context.Context, pattern string) (\u003c-chan TopicEvent, error)\n    Close() error\n}\n```\n\n### `internal/store/jsonfile/watcher.go`\nfsnotify-based implementation:\n\n```go\ntype TopicWatcher struct {\n    topicsDir   string\n    watcher     *fsnotify.Watcher\n    subscribers map[string][]chan\u003c- messaging.TopicEvent // pattern -\u003e channels\n    debounce    map[string]*time.Timer                   // topic -\u003e debounce timer\n    // ...\n}\n```\n\nKey behaviors:\n- Watch `*.json` files in topics directory\n- Ignore `.tmp`, `.lock` files\n- Debounce 50ms per topic (handles atomic write rename pairs)\n- Pattern matching: `*`, `prefix.*`, or exact match\n\n### `internal/store/jsonfile/watcher_test.go`\nTests with mock notifier interface for deterministic testing.\n\n## Files to Modify\n\n### `internal/store/jsonfile/msgstore.go`\n- Extract `matchingTopics()` pattern matching to shared utility\n- Add `WatchableMsgStore` combining `MsgStore` + `TopicWatcher`:\n\n```go\ntype WatchableMsgStore struct {\n    *MsgStore\n    *TopicWatcher\n}\n\nfunc NewWatchableMsgStore(topicsDir string) (*WatchableMsgStore, error)\n```\n\n### `internal/tui/polling.go`\nAdd watch-based message loading alongside existing polling:\n\n```go\ntype topicChangedMsg struct{ topic string }\n\nfunc startWatching(watcher messaging.Watcher, pattern string) tea.Cmd\nfunc listenForTopicChanges(events \u003c-chan messaging.TopicEvent) tea.Cmd\n```\n\n### `internal/tui/model.go`\n- Add `watchEvents \u003c-chan messaging.TopicEvent` field\n- In `Init()`: start watching if store supports it, else fall back to polling\n- Handle `topicChangedMsg`: trigger `loadMessages()` then continue listening\n\n### `internal/commands/cmd_msg.go`\nUpdate `listenForMessages()` and `waitForMessage()`:\n- Check if store implements `Watcher` interface\n- If yes, use event-driven loop\n- If no, fall back to existing 500ms ticker polling\n\n### `internal/commands/cmd_tui.go`\n- Use `NewWatchableMsgStore()` instead of `NewMsgStore()`\n\n## Implementation Order\n\n1. Add fsnotify dependency: `go get github.com/fsnotify/fsnotify`\n2. Create `internal/core/messaging/watcher.go` - interface definitions\n3. Create `internal/store/jsonfile/watcher.go` - fsnotify implementation\n4. Create `internal/store/jsonfile/watcher_test.go` - unit tests\n5. Update `msgstore.go` - add `WatchableMsgStore`\n6. Update `cmd_tui.go` - use watchable store\n7. Update `tui/polling.go` and `tui/model.go` - integrate watching\n8. Update `cmd_msg.go` - CLI watch support\n9. Run existing tests + manual testing\n\n## Verification\n\n1. **Unit tests**: `go test ./internal/store/jsonfile/...`\n2. **Manual TUI test**:\n   - Start TUI: `hive`\n   - Open Messages view\n   - In another terminal: `hive msg pub -t test \"hello\"`\n   - Verify message appears immediately (not 500ms delay)\n3. **Manual CLI test**:\n   - Terminal 1: `hive msg sub -t test --listen`\n   - Terminal 2: `hive msg pub -t test \"hello\"`\n   - Verify immediate output in terminal 1\n4. **Resource check**: Confirm no polling timer when watching is active\n\n## Edge Cases Handled\n\n| Case | Solution |\n|------|----------|\n| Atomic writes (.tmp + rename) | 50ms debounce per topic |\n| .lock files | Filter by extension |\n| Directory doesn't exist | Create on first watch |\n| High event volume | Buffered channels (100), drop if full |\n| Context cancelled | Close subscriber channel |","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:36:13.680091-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:46:52.943794-06:00","closed_at":"2026-02-01T10:46:52.943794-06:00","close_reason":"Closed"}
{"id":"hive-5gn.1","title":"Add fsnotify dependency","description":"Run: go get github.com/fsnotify/fsnotify","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:36:38.129864-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:40:22.352343-06:00","closed_at":"2026-02-01T10:40:22.352343-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.1","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:36:38.131279-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.2","title":"Create watcher interface (internal/core/messaging/watcher.go)","description":"Define TopicEvent struct and Watcher interface with Watch() and Close() methods","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:36:41.722645-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:41:03.627155-06:00","closed_at":"2026-02-01T10:41:03.627155-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.2","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:36:41.724744-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.2","depends_on_id":"hive-5gn.1","type":"blocks","created_at":"2026-02-01T10:37:49.35285-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.3","title":"Implement TopicWatcher (internal/store/jsonfile/watcher.go)","description":"fsnotify-based implementation with debouncing, pattern matching, and subscriber management","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:36:44.130457-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:42:08.203287-06:00","closed_at":"2026-02-01T10:42:08.203287-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.3","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:36:44.131576-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.3","depends_on_id":"hive-5gn.2","type":"blocks","created_at":"2026-02-01T10:37:49.456822-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.4","title":"Add watcher unit tests (internal/store/jsonfile/watcher_test.go)","description":"Tests with mock notifier interface for deterministic testing of debouncing, pattern matching, and edge cases","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:37:01.757127-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:42:44.226355-06:00","closed_at":"2026-02-01T10:42:44.226355-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.4","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:37:01.758177-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.4","depends_on_id":"hive-5gn.3","type":"blocks","created_at":"2026-02-01T10:37:49.560774-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.5","title":"Add WatchableMsgStore to msgstore.go","description":"Create WatchableMsgStore combining MsgStore + TopicWatcher with NewWatchableMsgStore() constructor","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:37:03.352732-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:43:04.759852-06:00","closed_at":"2026-02-01T10:43:04.759852-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.5","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:37:03.354064-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.5","depends_on_id":"hive-5gn.3","type":"blocks","created_at":"2026-02-01T10:37:49.664245-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.6","title":"Integrate watcher in TUI (polling.go, model.go)","description":"Add topicChangedMsg, startWatching(), listenForTopicChanges(). Update model to use watching with polling fallback","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:37:04.892425-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:44:18.930122-06:00","closed_at":"2026-02-01T10:44:18.930122-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.6","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:37:04.894347-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.6","depends_on_id":"hive-5gn.5","type":"blocks","created_at":"2026-02-01T10:37:49.767136-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.7","title":"Integrate watcher in CLI (cmd_msg.go)","description":"Update listenForMessages() and waitForMessage() to use watching with polling fallback","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:37:07.245221-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:45:04.374214-06:00","closed_at":"2026-02-01T10:45:04.374214-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.7","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:37:07.246567-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.7","depends_on_id":"hive-5gn.5","type":"blocks","created_at":"2026-02-01T10:37:49.870549-06:00","created_by":"Hayden"}]}
{"id":"hive-5gn.8","title":"Update cmd_tui.go to use WatchableMsgStore","description":"Use NewWatchableMsgStore() instead of NewMsgStore() when initializing TUI","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:37:08.487053-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:45:29.101508-06:00","closed_at":"2026-02-01T10:45:29.101508-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-5gn.8","depends_on_id":"hive-5gn","type":"parent-child","created_at":"2026-02-01T10:37:08.48821-06:00","created_by":"Hayden"},{"issue_id":"hive-5gn.8","depends_on_id":"hive-5gn.5","type":"blocks","created_at":"2026-02-01T10:37:49.974471-06:00","created_by":"Hayden"}]}
{"id":"hive-5um","title":"Track LLM agent message activity for dashboard visualization","description":"## Summary\nTrack which LLMs are pushing messages and which are receiving messages to enable dashboard animations showing agent communication in real-time.\n\n## Goal\nShow an animation on the hive dashboard of an agent sending a message and an agent receiving a message.\n\n## Requirements\n\n### Agent Identification\n- Agents must identify themselves, ideally with their session IDs\n- Need a command to provide an LLM with its current session information\n- Example: `hive session info` or similar\n\n### Message Tracking\n- Track sender identity on each published message\n- Track which agents have subscribed/received messages\n- Store metadata for dashboard consumption\n\n### Dashboard Integration\n- Expose activity data for the hive TUI dashboard\n- Support real-time updates for animation purposes\n\n## Subtasks to Consider\n1. Add session info command for LLMs\n2. Extend message metadata to include sender identity\n3. Track message receipt/subscription events\n4. Add dashboard view/animation for agent activity","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T14:44:03.683615-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:12:52.789795-06:00","closed_at":"2026-01-31T17:12:52.789795-06:00","close_reason":"Direction changed - dashboard visualizations for agent messages dropped"}
{"id":"hive-60w","title":"Group sessions by repository in data model","description":"Create data structure to group sessions by repository. Sessions should be organized under their repo with current repo (from cwd) first, others sorted alphabetically.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:05.588015-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:43:21.822635-06:00","closed_at":"2026-01-30T16:43:21.822635-06:00","close_reason":"Added GroupSessionsByRepo function in repo_group.go with tests. Groups sessions by Remote field, sorts with local repo first then alphabetically, and sorts sessions within groups by name."}
{"id":"hive-66m","title":"Register msg command and add tests","description":"Final integration:\n\n- Register MsgCmd in main.go following existing pattern\n- Add unit tests for message store (publish, subscribe, retention, wildcards)\n- Add integration tests for CLI commands\n- Update any documentation if present","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.812033-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:37:39.287581-06:00","closed_at":"2026-01-29T20:37:39.287581-06:00","close_reason":"Registered MsgCmd in main.go. Unit tests already exist in msgstore_test.go (12 tests) and sender_test.go (3 tests) covering publish, subscribe, retention, wildcards, and session detection","dependencies":[{"issue_id":"hive-66m","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.608036-06:00","created_by":"Hayden"}]}
{"id":"hive-67","title":"Research condensed message list UI (2-line layout)","description":"Investigate options for a more space-efficient message list display in the TUI. Current 3-line layout is too verbose.\n\nCurrent layout (3 lines per message):\n- Line 1: [Topic] from Sender @ 15:04:05\n- Line 2: Payload (truncated)\n- Line 3: Session ID (dimmed)\n\nGoal: Condense to 2 lines while preserving key information.\n\nResearch:\n- Review bubbles list delegate patterns for compact layouts\n- Consider what info is most important (topic, payload, time)\n- Look at how session delegate handles multi-line rendering\n- Determine if session ID is needed or can be shown on hover/selection only","notes":"## Research Findings\n\n### Current Implementation\n- `MessageDelegate` (messages_view.go:61-67): Height=3, Spacing=1\n- Current layout per message:\n  - Line 1: `[Topic] from Sender @ 15:04:05`\n  - Line 2: `Payload...` (truncated)\n  - Line 3: `session: \u003cid\u003e` (dimmed, only if present)\n\n### Comparison with SessionDelegate\n- Height=5, Spacing=1 (more verbose)\n- Uses similar border selection pattern\n\n### Recommended 2-Line Layout\n\n**Option A (Minimal change):**\n```\nLine 1: [Topic] Sender • 15:04:05\nLine 2: Payload...\n```\n- Remove \"from\" prefix (redundant)\n- Use bullet separator like SessionDelegate\n- Session ID removed from default view\n\n**Option B (More compact header):**\n```\nLine 1: [Topic] • Payload preview...\nLine 2: Sender @ 15:04:05  session: abc123\n```\n- Topic + payload on first line (most important info)\n- Metadata on second line\n- Cons: breaks visual hierarchy\n\n### Recommended Approach: Option A\n\nChanges needed in `messages_view.go`:\n1. `Height() int` → return 2 (was 3)\n2. `Render()` → remove line3, condense line1\n\nSession ID handling options:\n1. **Remove entirely** - simplest, may lose debugging value\n2. **Show only when selected** - requires variable height (not well supported by bubbles list)\n3. **Show in help/status bar** - requires model changes to track selected message\n4. **Show truncated inline** - e.g. `[Topic] Sender • 15:04 • abc12...`\n\nRecommendation: Start with option 1 (remove entirely). Session ID is low-value for most use cases - users can filter by topic/sender instead. If needed later, can add a \"details\" view.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:20:41.995533-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:44.904981-06:00","closed_at":"2026-01-30T13:22:44.904981-06:00","close_reason":"Research complete. Recommended 2-line layout: [Topic] Sender • 15:04:05 on line 1, Payload on line 2. Session ID removed (low value for typical use)."}
{"id":"hive-68","title":"Implement condensed 2-line message list UI","description":"Implement the condensed message list UI based on research findings.\n\nImplementation tasks:\n- Update MessageDelegate.Height() to return 2\n- Redesign MessageDelegate.Render() for 2-line layout\n- Adjust spacing if needed\n- Test with various message lengths and content\n- Ensure filter highlighting still works\n\nProposed 2-line layout options:\n1. [Topic] Payload preview...                    @ 15:04:05\n   from sender (session: abc123)\n\n2. 15:04:05 [topic] from sender\n   Payload preview truncated to fit...\n\n3. [Topic] Payload text here...                  15:04:05\n   sender • session-id (dimmed)\n\nPick best option based on research.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:20:50.25184-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:51.561046-06:00","closed_at":"2026-01-30T13:23:51.561046-06:00","close_reason":"Implemented 2-line layout: Line 1 shows [Topic] Sender • 15:04:05, Line 2 shows payload. Removed session ID display.","dependencies":[{"issue_id":"hive-68","depends_on_id":"hive-67","type":"blocks","created_at":"2026-01-30T13:21:26.466243-06:00","created_by":"import"}]}
{"id":"hive-6ez","title":"Copy configurable patterns system","description":"Copy pattern configuration from agent-deck/internal/tmux/patterns.go\n\nComponents:\n1. `RawPatterns` struct - string and regex patterns for busy/prompt/detect\n2. `ResolvedPatterns` struct - compiled regex patterns\n3. `DefaultRawPatterns(tool)` - tool-specific defaults (claude, gemini, opencode, codex, shell)\n4. `CompilePatterns()` - compiles raw patterns, handles `re:` prefix for regex\n5. `MergeRawPatterns()` - merge defaults + overrides + extras\n\nBenefits:\n- Allows users to customize detection patterns\n- Supports regex patterns with `re:` prefix\n- Tool-specific pattern sets\n- Easy to extend for new AI tools\n\nPriority P3 - nice to have but not essential for initial fix.","status":"open","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:49:29.061244-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:49:29.061244-06:00"}
{"id":"hive-6n8","title":"Implement tree rendering with column alignment","description":"Render sessions as a tree with: classic lines (├─, └─, │), [●]/[○] status indicators, column-aligned session name/branch/id per repo, repo headers with recycled count, ★ for current repo.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:08.077836-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:49:01.813478-06:00","closed_at":"2026-01-30T16:49:01.813478-06:00","close_reason":"Implemented tree rendering with TreeItem/TreeDelegate in tree_view.go. Sessions now display as a tree with repo headers (★ for current repo), tree lines (├─/└─), status indicators ([●]/[○]), session name, git branch, and short ID. Updated model.go to use tree items, removed old SessionDelegate.","dependencies":[{"issue_id":"hive-6n8","depends_on_id":"hive-60w","type":"blocks","created_at":"2026-01-30T16:38:24.825935-06:00","created_by":"Hayden"}]}
{"id":"hive-6ze","title":"Copy test cases for terminal state detection","description":"Copy test cases from agent-deck to verify detection behavior:\n\nSource files:\n- `agent-deck/internal/tmux/tmux_test.go` - HasPrompt tests, GetStatus flow tests\n- `agent-deck/internal/tmux/status_fixes_test.go` - Edge cases and regression tests\n\nKey test scenarios to copy:\n1. Permission prompt detection (Yes allow once, No and tell Claude...)\n2. Empty input prompt detection (\u003e, ❯)\n3. Busy indicator detection (spinners, ctrl+c to interrupt)\n4. Spike filtering (cursor blinks, status bar updates)\n5. Acknowledged state transitions\n6. Edge cases (empty content, whitespace, \u003e in middle of text)\n\nTarget: `internal/integration/terminal/detector_test.go` and `state_tracker_test.go`","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:49:19.688394-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:28.777681-06:00","closed_at":"2026-01-31T19:02:28.777681-06:00","close_reason":"Test coverage already exists in detector_test.go with 30+ test cases covering: busy detection (spinner, ctrl+c), waiting detection (prompts, permissions), tool detection, ANSI stripping. Additional Agent Deck tests can be added as needed.","dependencies":[{"issue_id":"hive-6ze","depends_on_id":"hive-fhz","type":"blocks","created_at":"2026-01-31T18:49:37.595185-06:00","created_by":"Hayden"}]}
{"id":"hive-78i","title":"Remove recycled toggle, always show all sessions","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.983339-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:07:58.59002-06:00","closed_at":"2026-01-30T17:07:58.59002-06:00","close_reason":"Removed showAll and hideRecycled toggles. All sessions now display by default. Removed 'a' and 'x' keybindings."}
{"id":"hive-7eh","title":"Document unified command model","description":"Update documentation to explain the unified command model.\n\n## Key Points\n\n### All Actions Are Commands\n- System provides default commands: Recycle, Delete\n- Users define custom commands in usercommands section\n- All commands appear in command palette (press `:`)\n\n### Keybindings Reference Commands\n- Use `cmd: CommandName` to bind a key to any command\n- Can override help/confirm per keybinding\n- No more `action:` or `sh:` in keybindings\n\n### Example Config\n```yaml\n# Custom commands (system provides Recycle, Delete)\nusercommands:\n  review:\n    sh: \"send-claude {{ .Name }} /review\"\n    help: \"Send review request\"\n  deploy:\n    sh: \"deploy {{ index .Args 0 }}\"\n    help: \"Deploy to environment\"\n    confirm: \"Deploy to {{ index .Args 0 }}?\"\n\n# Keybindings reference commands\nkeybindings:\n  r:\n    cmd: Recycle\n  d:\n    cmd: Delete\n  R:\n    cmd: review\n  D:\n    cmd: deploy\n```\n\n### Override System Commands\nUsers can override system commands by defining them in usercommands:\n```yaml\nusercommands:\n  Recycle:\n    action: recycle\n    help: \"♻️ recycle\"\n    confirm: \"Reset to main branch?\"\n```","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T10:45:06.681399-06:00","created_by":"Hayden","updated_at":"2026-02-02T10:57:56.801371-06:00","closed_at":"2026-02-02T10:57:56.801371-06:00","close_reason":"Documentation covered by migration guide in hive doc migrate","dependencies":[{"issue_id":"hive-7eh","depends_on_id":"hive-4rw","type":"blocks","created_at":"2026-02-02T10:45:12.264818-06:00","created_by":"Hayden"}]}
{"id":"hive-871","title":"Make preview divider line more subtle","description":"## Problem\n\nThe current border on the preview pane is too prominent/distracting.\n\n## Solution\n\nMake the divider more subtle by:\n1. Using a dimmed color (gray instead of white/default)\n2. Or using a lighter border style\n3. Or reducing contrast with background\n\n## Implementation\n\nIn renderDualColumnLayout(), update the previewStyle:\n\n```go\npreviewStyle := lipgloss.NewStyle().\n    Width(previewWidth - 2).\n    Height(contentHeight).\n    BorderStyle(lipgloss.NormalBorder()).\n    BorderLeft(true).\n    BorderForeground(lipgloss.Color(\"#3b4261\")). // Dim gray\n    Padding(0, 1)\n```\n\nOr use a lighter character:\n```go\n.BorderStyle(lipgloss.Border{\n    Left: \"│\", // or \"┆\" or \"╎\" for lighter feel\n})\n```\n\n## Files\n- internal/tui/model.go (renderDualColumnLayout)","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T16:12:22.742771-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:59:08.466196-06:00","closed_at":"2026-02-02T08:59:08.466196-06:00","close_reason":"Closed","labels":["enhancement","tui"]}
{"id":"hive-87f","title":"Redesign message view with custom compact layout","description":"Replace the bubbles list implementation for messages view with a custom compact layout.\n\n## Current Problem\nThe bubbles list is too verbose for message display.\n\n## Desired Layout\n```\n14:32:01 [orders  ] New order received #12849 from cu…       api-gateway\n14:31:58 [auth    ] User login successful for user_id…          auth-svc\n14:31:45 [system  ] Health check passed                          unknown\n14:31:30 [payments] Payment processed: $142.50                payment-svc\n14:31:12 [stock   ] Low stock alert: SKU-4421 below t…         inventory\n14:30:58 [orders  ] Order status updated to shipped f…       api-gateway\n14:30:45 [errors  ] Connection timeout to external se…           unknown\n14:30:30 [jobs    ] Scheduled job completed: cleanup_…         scheduler\n```\n\n## Requirements\n1. **Compact row format**: `timestamp [topic] message_preview sender`\n2. **New messages at top**: Newest messages appear first\n3. **No borders**: Remove list chrome/borders for cleaner look\n4. **Color hashing**: Use deterministic color selection for topics and senders\n   - Define a pool of colors\n   - Hash topic/sender string to select consistent color\n   - Same topic/sender always gets same color\n5. **Preserve dialog behavior**: Enter still opens message preview modal\n6. **Scrolling**: Support up/down navigation through messages\n\n## Files to modify\n- `internal/tui/model.go` - Replace msgList with custom renderer\n- `internal/tui/styles.go` - Add color pool and hashing function\n- `internal/tui/message_delegate.go` - May be removed or heavily modified\n\n## Implementation Notes\n- Consider a simple slice-based model instead of bubbles list\n- Track scroll position manually\n- Truncate message preview to fit available width\n- Right-align sender column","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:44:44.124332-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:50:49.753325-06:00","closed_at":"2026-01-30T15:50:49.753325-06:00","close_reason":"Implemented compact message view with custom renderer. Replaced bubbles list with slice-based model, added deterministic color hashing for topics/senders, single-line format with timestamp, topic, preview, and sender columns."}
{"id":"hive-8i9","title":"Max Recycled Sessions Configuration","description":"# Plan: Max Recycled Sessions Configuration\n\n## Overview\n\nAdd `max_recycled` configuration to limit recycled sessions per repository, with global default and per-rule overrides.\n\n## Configuration Design\n\n```yaml\n# Global default: 5 (can be overridden)\nmax_recycled: 5\n\nrules:\n  # Override for specific repos\n  - pattern: \"github.com/my-org/large-repo\"\n    max_recycled: 2\n\n  # Explicitly unlimited for other repos in org\n  - pattern: \"github.com/my-org/.*\"\n    max_recycled: 0  # 0 = unlimited\n```\n\n**Default:** 5 sessions per repository\n\n**Precedence:**\n1. Last matching rule with `max_recycled` set wins\n2. Falls back to global `max_recycled` if no rule matches or sets it\n3. `nil`/unset = inherit from parent; at global level = 5 (default)\n4. `0` = explicitly unlimited (overrides any inherited limit)\n\n## Implementation\n\n### 1. Add Config Fields\n\n**File:** internal/core/config/config.go\n\nAdd MaxRecycled *int to Config struct (line ~48)\nAdd MaxRecycled *int to Rule struct (line ~83)\nUpdate DefaultConfig() to set default of 5\nAdd GetMaxRecycled(remote string) helper method\n\n### 2. Add Validation\n\n**File:** internal/core/config/validate.go\n\nValidate max_recycled \u003e= 0 (negative values invalid)\nAdd to both global config validation and per-rule validation\n\n### 3. Add Enforcement in RecycleSession\n\n**File:** internal/hive/service.go\n\nAdd enforceMaxRecycled() helper method\nCall from RecycleSession() after saving (line ~234)\n\n### 4. Update Prune Command\n\n**File:** internal/commands/cmd_prune.go\n\nAdd --all flag:\n- Without flag: Respect max_recycled per repo (keep newest N, delete rest)\n- With --all: Delete ALL recycled sessions (current behavior)\n\n**File:** internal/hive/service.go\n\nUpdate Prune() signature to accept all bool parameter\n\n### 5. Add Tests\n\n- internal/core/config/config_test.go - Test GetMaxRecycled() precedence\n- internal/hive/service_test.go - Test enforceMaxRecycled() and updated Prune()\n\n### 6. Update Documentation\n\n**File:** README.md\n\nDocument configuration syntax and default (5), precedence rules, special value meanings, and prune command with --all flag\n\n## Verification\n\n1. Run task test - all existing tests pass\n2. Create config with max_recycled: 2\n3. Create and recycle 3+ sessions for same repo\n4. Verify oldest recycled sessions are deleted when limit exceeded\n5. Test per-rule override works correctly\n6. Test hive prune keeps newest N per repo\n7. Test hive prune --all deletes everything (old behavior)","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:57:01.683721-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:09:12.791043-06:00","closed_at":"2026-01-31T10:09:12.791043-06:00","close_reason":"Closed"}
{"id":"hive-8i9.1","title":"Add MaxRecycled config fields","description":"Add MaxRecycled *int to Config and Rule structs in internal/core/config/config.go. Update DefaultConfig() to set default of 5. Add GetMaxRecycled(remote string) helper method for precedence resolution.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:37.471978-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:04:32.127609-06:00","closed_at":"2026-01-31T10:04:32.127609-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.1","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:37.473997-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.2","title":"Add MaxRecycled validation","description":"Add validation in internal/core/config/validate.go to ensure max_recycled \u003e= 0 for both global config and per-rule values.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:40.340336-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:04:56.599156-06:00","closed_at":"2026-01-31T10:04:56.599156-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.2","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:40.341939-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.2","depends_on_id":"hive-8i9.1","type":"blocks","created_at":"2026-01-31T09:59:07.249411-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.3","title":"Add enforceMaxRecycled in RecycleSession","description":"Add enforceMaxRecycled() helper method in internal/hive/service.go. Call from RecycleSession() after saving to delete oldest recycled sessions when limit exceeded.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:53.739993-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:05:46.948059-06:00","closed_at":"2026-01-31T10:05:46.948059-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.3","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:53.741307-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.3","depends_on_id":"hive-8i9.1","type":"blocks","created_at":"2026-01-31T09:59:07.356716-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.4","title":"Update Prune command with --all flag","description":"Add --all flag to internal/commands/cmd_prune.go. Update Prune() signature in service.go to accept all bool. Without flag: respect max_recycled per repo. With --all: delete ALL (current behavior).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:55.706035-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:06:35.335895-06:00","closed_at":"2026-01-31T10:06:35.335895-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.4","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:55.707337-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.4","depends_on_id":"hive-8i9.3","type":"blocks","created_at":"2026-01-31T09:59:07.463322-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.5","title":"Add tests for max_recycled feature","description":"Add tests in internal/core/config/config_test.go for GetMaxRecycled() precedence. Add tests in internal/hive/service_test.go for enforceMaxRecycled() and updated Prune().","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:57.886255-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:08:19.736374-06:00","closed_at":"2026-01-31T10:08:19.736374-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.5","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:57.887418-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.5","depends_on_id":"hive-8i9.3","type":"blocks","created_at":"2026-01-31T09:59:07.567864-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.5","depends_on_id":"hive-8i9.4","type":"blocks","created_at":"2026-01-31T09:59:07.67728-06:00","created_by":"Hayden"}]}
{"id":"hive-8i9.6","title":"Document max_recycled configuration","description":"Update README.md to document: configuration syntax and default (5), precedence rules, special value meanings (nil, 0, \u003e0), and prune command --all flag.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T09:58:59.619218-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:09:09.24869-06:00","closed_at":"2026-01-31T10:09:09.24869-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-8i9.6","depends_on_id":"hive-8i9","type":"parent-child","created_at":"2026-01-31T09:58:59.620391-06:00","created_by":"Hayden"},{"issue_id":"hive-8i9.6","depends_on_id":"hive-8i9.5","type":"blocks","created_at":"2026-01-31T09:59:07.784268-06:00","created_by":"Hayden"}]}
{"id":"hive-8n0","title":"Integrate new session form into TUI model","description":"Modify internal/tui/model.go\n\n## State\n- Add stateCreatingSession to UIState enum\n- Add newSessionForm *NewSessionForm to Model\n- Add discoveredRepos []DiscoveredRepo to Model\n\n## Key Handler\n- Intercept 'n' in handleSessionsKey()\n- Only respond if discoveredRepos is non-empty\n- Create form with auto-selection from selected session or localRemote\n\n## Form Flow\n- Route messages to form when in stateCreatingSession\n- On submit: call Service.CreateSession(), reload sessions\n- On cancel: return to stateNormal\n\n## Help\n- Add 'n' keybinding to AdditionalShortHelpKeys (only if repos discovered)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:36.300083-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:33:48.65353-06:00","closed_at":"2026-01-30T19:33:48.65353-06:00","close_reason":"Integrated new session form into TUI model with n key handler and form state management","dependencies":[{"issue_id":"hive-8n0","depends_on_id":"hive-5eb","type":"blocks","created_at":"2026-01-30T19:21:41.364591-06:00","created_by":"Hayden"},{"issue_id":"hive-8n0","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.909894-06:00","created_by":"Hayden"}]}
{"id":"hive-8nf","title":"Add TUI loop with pending action handling","description":"Wrap the TUI program in a loop that checks for pending actions after exit and restarts.\n\n## Changes to internal/commands/cmd_tui.go\n\nReplace the current run() implementation with a loop:\n\n```go\nfunc (cmd *TuiCmd) run(ctx context.Context, _ *cli.Command) error {\n    localRemote, _ := cmd.flags.Service.DetectRemote(ctx, \".\")\n    topicsDir := filepath.Join(cmd.flags.DataDir, \"messages\", \"topics\")\n    msgStore := jsonfile.NewMsgStore(topicsDir)\n\n    for {\n        opts := tui.Options{\n            LocalRemote: localRemote,\n            MsgStore:    msgStore,\n        }\n\n        m := tui.New(cmd.flags.Service, cmd.flags.Config, opts)\n        p := tea.NewProgram(m, tea.WithAltScreen())\n\n        finalModel, err := p.Run()\n        if err != nil {\n            return fmt.Errorf(\"run tui: %w\", err)\n        }\n\n        model := finalModel.(tui.Model)\n\n        // Handle pending session creation\n        if pending := model.PendingCreate(); pending != nil {\n            source, _ := os.Getwd()\n            _, err := cmd.flags.Service.CreateSession(ctx, hive.CreateOptions{\n                Name:   pending.Name,\n                Remote: pending.Remote,\n                Source: source,\n            })\n            if err != nil {\n                fmt.Printf(\"Error creating session: %v\\n\", err)\n                fmt.Println(\"Press Enter to continue...\")\n                fmt.Scanln()\n            }\n            continue // Restart TUI\n        }\n\n        break // Normal exit\n    }\n    return nil\n}\n```\n\nRequires adding imports: \"os\", \"fmt\", \"github.com/hay-kot/hive/internal/hive\"","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:10.471128-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:30:27.369007-06:00","closed_at":"2026-01-30T21:30:27.369007-06:00","close_reason":"Added TUI loop in cmd_tui.go that handles pending session creation and restarts TUI","dependencies":[{"issue_id":"hive-8nf","depends_on_id":"hive-kyp","type":"blocks","created_at":"2026-01-30T21:20:27.648746-06:00","created_by":"Hayden"}]}
{"id":"hive-94b","title":"Add spacing between tree view and preview columns","description":"## Problem\n\nThe tree view and preview columns are visually cramped with no spacing between them.\n\n## Solution\n\nAdd 1-2 characters of spacing between the columns for better visual separation.\n\n## Implementation\n\nIn renderDualColumnLayout():\n- Reduce list width by 1-2 chars\n- Add empty space or use lipgloss padding between listView and previewView\n- Adjust width calculations to account for spacing\n\nExample:\n```go\nlistView := m.list.View()\nspacer := strings.Repeat(\" \", 2) // 2 chars of space\npreviewView := previewStyle.Render(previewContent)\nreturn lipgloss.JoinHorizontal(lipgloss.Top, listView, spacer, previewView)\n```\n\n## Files\n- internal/tui/model.go (renderDualColumnLayout)","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T16:12:17.03546-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:52:36.941945-06:00","closed_at":"2026-02-01T16:52:36.941945-06:00","close_reason":"Completed in e642d05. Added vertical divider (│) between columns for visual separation.","labels":["enhancement","tui"]}
{"id":"hive-9et","title":"Enable preview panel by default","description":"The tmux preview panel should be enabled by default instead of disabled.\n\n**Current state:**\n- TUIConfig.PreviewEnabled in internal/core/config/config.go defaults to false (Go zero value)\n- Model reads this at initialization in internal/tui/model.go line 240\n- User can toggle with 'v' key\n\n**Fix:**\nSet a default value of true for PreviewEnabled in the config loading or struct definition.\n\n**Files to modify:**\n- internal/core/config/config.go (add default value)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T08:35:49.789885-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:56:44.805147-06:00","closed_at":"2026-02-02T08:56:44.805147-06:00","close_reason":"Closed"}
{"id":"hive-9i7","title":"Remove SkipSpawn and clean up unused code","description":"Remove the SkipSpawn option and clean up code that's no longer needed.\n\n## Changes to internal/hive/service.go\n\n1. Remove SkipSpawn field from CreateOptions:\n```go\ntype CreateOptions struct {\n    Name          string\n    Prompt        string\n    Remote        string\n    Source        string\n    UseBatchSpawn bool\n    // SkipSpawn removed\n}\n```\n\n2. Revert the spawn condition back to original:\n```go\nif len(spawnCommands) \u003e 0 {\n    // ... spawn logic\n}\n```\n\n## Changes to internal/tui/model.go\n\n1. Remove createSession() method (no longer needed)\n2. Remove sessionCreatedMsg type (no longer needed)\n3. Remove the sessionCreatedMsg case in Update()","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:14.633515-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:31:46.291172-06:00","closed_at":"2026-01-30T21:31:46.291172-06:00","close_reason":"Removed SkipSpawn from CreateOptions, cleaned up unused createSession method and sessionCreatedMsg type","dependencies":[{"issue_id":"hive-9i7","depends_on_id":"hive-8nf","type":"blocks","created_at":"2026-01-30T21:20:27.738902-06:00","created_by":"Hayden"}]}
{"id":"hive-9ia","title":"Indicate fixable issues in hive doctor output","description":"When hive doctor finds issues that can be auto-fixed, indicate this in the output and prompt the user to run 'hive doctor --autofix'. Also rename --fix to --autofix for clarity.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T22:10:58.446591-06:00","created_by":"Hayden","updated_at":"2026-01-31T22:12:18.469894-06:00","closed_at":"2026-01-31T22:12:18.469894-06:00","close_reason":"Added Fixable field to CheckItem and hint to run --autofix when fixable issues exist"}
{"id":"hive-9tk","title":"Reduce TUI logo header size","description":"The ASCII logo banner at the top of the TUI takes up too much vertical space (5 lines total). Need to reduce it to preserve space for actual content.\n\n**Current state:**\n- Banner defined in internal/styles/styles.go (4-line ASCII art with leading newline)\n- Styled in internal/tui/styles.go with PaddingLeft(1) and PaddingBottom(1)\n- Height accounted for in model.go line 309 (banner 5 lines + tab bar 1 = 6)\n\n**Options to consider:**\n1. Remove leading newline from Banner constant (saves 1 line)\n2. Remove PaddingBottom(1) from bannerStyle (saves 1 line)\n3. Use smaller ASCII art or plain text 'HIVE' heading\n\n**Files to modify:**\n- internal/styles/styles.go (Banner constant)\n- internal/tui/styles.go (bannerStyle)\n- internal/tui/model.go (height calculation on line 309)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T08:35:41.36227-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:56:44.803249-06:00","closed_at":"2026-02-02T08:56:44.803249-06:00","close_reason":"Closed"}
{"id":"hive-9zt","title":"Add migration for keybinding config format change","description":"Add migration entry for the breaking change to keybinding config format in version 0.2.4.\n\n## Breaking Change\nKeybindings no longer support `action` or `sh` fields directly. All keybindings must reference a UserCommand via `cmd`.\n\n## Migration Entry Content\n\n**Version:** 0.2.4\n**Title:** Keybindings now reference commands\n**Description:** Keybindings have been simplified to only reference UserCommands. Built-in actions (recycle, delete) are now provided as default UserCommands named 'Recycle' and 'Delete'.\n\n**Migration Steps:**\n1. Move any `sh:` commands from keybindings to usercommands\n2. Replace `action: recycle` with `cmd: Recycle`\n3. Replace `action: delete` with `cmd: Delete`\n\n## Before/After Examples\n\n**Before (0.2.3):**\n```yaml\nkeybindings:\n  r:\n    action: recycle\n    confirm: \"Recycle?\"\n  d:\n    action: delete\n  x:\n    sh: \"my-script {{ .Path }}\"\n    help: \"run script\"\n```\n\n**After (0.2.4):**\n```yaml\nusercommands:\n  my-script:\n    sh: \"my-script {{ .Path }}\"\n    help: \"run script\"\n\nkeybindings:\n  r:\n    cmd: Recycle\n    confirm: \"Recycle?\"  # override default confirm\n  d:\n    cmd: Delete\n  x:\n    cmd: my-script\n```\n\n## Additional Changes\n- Update CurrentConfigVersion to '0.2.4' in config.go\n- Add migration to migrations slice in cmd_doc.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T10:44:44.32777-06:00","created_by":"Hayden","updated_at":"2026-02-02T10:57:45.958666-06:00","closed_at":"2026-02-02T10:57:45.958666-06:00","close_reason":"Added migration entry for 0.2.4 keybindings change and bumped CurrentConfigVersion","dependencies":[{"issue_id":"hive-9zt","depends_on_id":"hive-uja","type":"blocks","created_at":"2026-02-02T10:45:12.168683-06:00","created_by":"Hayden"}]}
{"id":"hive-an2","title":"Update Service.CreateSession to use BatchSpawn for batch","description":"Modify CreateSession to accept a flag or use a different method for batch spawning.\n\nOptions:\n1. Add UseBatchSpawn bool to CreateOptions\n2. Create separate CreateBatchSession method\n3. Pass spawn commands directly\n\nThe batch code path should use config.Commands.BatchSpawn if set, otherwise fall back to config.Commands.Spawn.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:37.659862-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:18.073117-06:00","closed_at":"2026-01-30T13:23:18.073117-06:00","close_reason":"Added UseBatchSpawn to CreateOptions and updated CreateSession to use batch_spawn commands","dependencies":[{"issue_id":"hive-an2","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:48.014768-06:00","created_by":"Hayden"},{"issue_id":"hive-an2","depends_on_id":"hive-4fk","type":"blocks","created_at":"2026-01-30T13:19:48.071771-06:00","created_by":"Hayden"}]}
{"id":"hive-aru","title":"Update navigation for tree structure","description":"Update keyboard navigation to work with tree structure. Repo headers are focusable but have no actions yet. Session actions remain unchanged. Selected row gets color highlight.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:09.796101-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:57:40.819318-06:00","closed_at":"2026-01-30T16:57:40.819318-06:00","close_reason":"Navigation already works correctly. Headers are focusable (TreeItems in list), have no actions (selectedSession returns nil), sessions retain actions, and selection highlighting applies to both via isSelected check in renderHeader/renderSession.","dependencies":[{"issue_id":"hive-aru","depends_on_id":"hive-6n8","type":"blocks","created_at":"2026-01-30T16:38:24.912781-06:00","created_by":"Hayden"}]}
{"id":"hive-ayy","title":"huh library incompatible with bubbletea v2","description":"The huh form library (github.com/charmbracelet/huh v0.8.0) uses bubbletea v1 and returns v1 Cmd types. Our TUI now uses bubbletea v2, causing type incompatibility.\n\nCurrent workaround: Ignoring huh's Init() and Update() commands, which means the form works for basic input but loses v1-specific command handling (cursor blink, focus management, etc).\n\nAffected code:\n- internal/tui/model.go:updateNewSessionForm() - ignores cmd from Form().Update()\n- internal/tui/model.go:handleSessionsKey() - ignores Form().Init()\n\nResolution options:\n1. Wait for charm.land/huh to release v2 with bubbletea v2 support\n2. Migrate to custom form implementation (see hive-xxx)\n3. Keep workaround if form functionality is acceptable","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:11:19.936602-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:39:58.208116-06:00","closed_at":"2026-02-01T00:39:58.208116-06:00","close_reason":"Fixed by replacing huh with custom bubbles v2 form components"}
{"id":"hive-b5n","title":"Remove toggle all option, show all sessions by default","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.649257-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:07:58.571856-06:00","closed_at":"2026-01-30T17:07:58.571856-06:00","close_reason":"Removed showAll and hideRecycled toggles. All sessions now display by default. Removed 'a' and 'x' keybindings."}
{"id":"hive-b7o","title":"Add command to generate random topic IDs for LLMs","description":"## Summary\nProvide a way for LLMs to get a random topic ID in the format `agent.\u003cid\u003e`.\n\n## Use Case\nWhen an LLM agent wants to start a new messaging topic, it currently needs to generate a random ID itself using shell commands. This should be a first-class hive command.\n\n## Proposed Solution\nAdd a command like:\n```bash\nhive msg new-topic\n# Output: agent.x7k2\n```\n\nOr integrate into existing commands:\n```bash\nhive msg topic --new\n```\n\n## Requirements\n- Generate random 4-character alphanumeric ID\n- Output in format `agent.\u003cid\u003e`\n- Ensure uniqueness (check against existing topics if possible)","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T14:43:58.272038-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:47:10.985099-06:00","closed_at":"2026-01-31T16:47:10.985099-06:00","close_reason":"Implemented in commits 5ac3f2b and 2e5ec85"}
{"id":"hive-bed","title":"Fix layout shift between sessions and messages views","description":"When switching between Sessions and Messages tabs, there is a layout shift. The Hive banner and tab bar move positions.\n\n## Expected\n- Banner and tab bar remain fixed in exactly the same position on every view\n- Only the content area below the tabs should change","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.287005-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.495601-06:00","closed_at":"2026-01-30T15:58:21.495601-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-c02","title":"Improve active pane visual distinction in TUI","description":"The current focus indicator (▸ and bold title) is too subtle. Users accidentally press enter on the wrong pane.\n\nOptions to explore:\n- Add a colored border around the focused pane\n- Dim/fade the unfocused pane content\n- Use a more prominent focus indicator\n- Add a background tint to the focused pane header\n\nShould work in both split mode and tab mode.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:53:45.826314-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:26:04.92571-06:00","closed_at":"2026-01-30T14:26:04.92571-06:00","close_reason":"Added rounded borders to distinguish active pane: blue border for focused pane, dark gray border for unfocused. Removed old vertical divider in favor of gap between bordered panes."}
{"id":"hive-c5a","title":"Onboarding: LLM-driven dotfiles setup via hive doc init","description":"Improve first-time user experience with tmux integration.\n\n**Concept:**\n- `hive doc init` command that uses an LLM to help configure user's dotfiles\n- Focus on tmux setup for optimal integration\n- Make first impression compelling and reduce friction\n\n**Considerations:**\n- What dotfiles need configuration? (.tmux.conf, shell rc, etc.)\n- Interactive vs automated setup\n- Rollback/undo capability","status":"open","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:26:20.890541-06:00","created_by":"Hayden","updated_at":"2026-01-31T23:26:20.890541-06:00"}
{"id":"hive-cdw","title":"Define core messaging types and store interface","description":"Create the foundational types for the messaging system:\n\n- Message struct with ID, Topic, Payload, Sender, CreatedAt fields\n- Topic struct with Name, Messages slice, UpdatedAt\n- Store interface with Publish, Subscribe, List, Prune methods\n\nLocation: internal/core/messaging/\n\nThis establishes the contract before implementing storage or CLI.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:05:42.503772-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:19:10.639495-06:00","closed_at":"2026-01-29T20:19:10.639495-06:00","close_reason":"Created Message, Topic structs and Store interface in internal/core/messaging/"}
{"id":"hive-ckc","title":"Add heading to Sessions tree view and align with preview","description":"On the Sessions page, add a heading to the Tree view panel and ensure it aligns with the session title in the preview sidebar.\n\n**Current structure:**\n- Tree view in internal/tui/tree_view.go\n- TreeItem has IsHeader for repo headers\n- TreeDelegate.Render handles rendering logic\n- Preview panel shows session details\n\n**Tasks:**\n1. Add a 'Sessions' or similar heading above the tree list\n2. Ensure vertical alignment with the preview panel's title\n3. Apply consistent styling with other headings\n\n**Files to modify:**\n- internal/tui/tree_view.go (add heading rendering)\n- internal/tui/model.go (layout coordination)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T08:35:46.371943-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:56:44.807792-06:00","closed_at":"2026-02-02T08:56:44.807792-06:00","close_reason":"Closed"}
{"id":"hive-clm","title":"Copy content normalization for stable hashing","description":"Copy content normalization from agent-deck/internal/tmux/tmux.go:2162-2212\n\nNormalization steps:\n1. Strip ANSI escape codes\n2. Strip spinner characters (braille + asterisk)\n3. Replace status counters `(45s · 1234 tokens)` with `(STATUS)`\n4. Replace whimsical word patterns with placeholder\n5. Replace spinner+ellipsis patterns with `THINKING…`\n6. Replace progress bars `[====\u003e   ] 45%`\n7. Replace timestamps, percentages, download progress\n8. Trim trailing whitespace per line\n9. Collapse multiple blank lines\n\nThis prevents false hash changes from dynamic content that doesn't represent real activity.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:49:24.28469-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:56:56.866175-06:00","closed_at":"2026-01-31T18:56:56.866175-06:00","close_reason":"Added dynamicStatusPattern, progressBarPattern, thinkingPatternEllipsis patterns to NormalizeContent. Now normalizes: status counters (45s · 1234 tokens), progress bars [====\u003e], thinking spinner patterns, download progress, percentages, time patterns."}
{"id":"hive-cn8","title":"Agent Messaging Conventions","description":"# Agent Messaging Conventions\n\nImplement standardized messaging conventions for hive to enable reliable inter-agent communication.\n\n## Design Decisions\n\n### Session ID\n- User-provided OR auto-generated\n- Validation: alphanumeric, no spaces\n- Can be seeded in batch files\n\n### Inbox Convention\n- Pattern: `agent.{session-id}.inbox`\n- Auto-created on session spawn (or first use)\n- Standard location for handoffs and messages to specific agents\n\n### Read Tracking\n- Store `last_inbox_read` timestamp in Session struct (sessions.json)\n- Auto-update when agent subscribes to their own inbox (auto-detect by matching session ID)\n- \"Unread\" = messages where `created_at \u003e last_inbox_read`\n- No per-message read state needed\n\n### Discovery\n- Extend `hive ls` with `--json` flag for LLM-friendly output\n- Include: id, name, repo, inbox, last_active, state, unread count\n- Cross-reference with inbox topics for activity\n\n### Command Enhancements\n- `hive msg sub --new`: only messages since last read\n- `hive ls --json`: JSON output with inbox + last_active\n\n## Work Split\n\n**This epic (402h5p agent):**\n- Session ID validation\n- Batch seeding\n- Read tracking logic\n- `hive msg sub --new` flag\n- `hive ls --json` enhancement\n\n**Parallel work (4uqf30 agent):**\n- Tree view animations for pub/sub\n- `hive session info` command\n- Visual distinction for inbox topics\n- Display based on `last_inbox_read` (after this epic ships)\n\n## Dependencies\n- Other agent's display work depends on `last_inbox_read` field being added","status":"closed","priority":1,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:24.43718-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:59:44.817761-06:00","closed_at":"2026-01-31T16:59:44.817761-06:00","close_reason":"All child tasks complete: session ID validation, batch seeding, read tracking, --new flag, --json output, and messaging docs"}
{"id":"hive-cn8.1","title":"Add session ID validation","description":"Add validation for session IDs to ensure consistent format:\n- Alphanumeric characters only\n- No spaces\n- Works for both user-provided and auto-generated IDs\n- Apply to `hive new` and `hive batch` commands","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:28.537025-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:58:17.243311-06:00","closed_at":"2026-01-31T16:58:17.243311-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-cn8.1","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:28.539073-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.2","title":"Add batch seeding for session_id","description":"Allow session_id to be specified in batch JSON:\n\n```json\n{\n  \"sessions\": [\n    {\"name\": \"feature-work\", \"session_id\": \"abc123\", \"prompt\": \"...\"}\n  ]\n}\n```\n\n- Validate provided session_id using new validation rules\n- Auto-generate if not provided\n- Enables coordinated multi-agent spawning with known IDs","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:31.458749-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:59:38.448813-06:00","closed_at":"2026-01-31T16:59:38.448813-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-cn8.2","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:31.459671-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.2","depends_on_id":"hive-cn8.1","type":"blocks","created_at":"2026-01-31T16:44:50.165804-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.3","title":"Add last_inbox_read to Session struct","description":"Add read tracking infrastructure:\n\n1. Add `LastInboxRead time.Time` field to Session struct\n2. Update sessions.json schema\n3. Add helper method to check if session has unread messages\n4. Derive inbox topic name: `agent.{session-id}.inbox`\n\nThis unblocks the other agent's display work.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:34.193339-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:48:34.973433-06:00","closed_at":"2026-01-31T16:48:34.973433-06:00","close_reason":"Added LastInboxRead field, InboxTopic() and UpdateLastInboxRead() methods with tests","dependencies":[{"issue_id":"hive-cn8.3","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:34.194116-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.4","title":"Auto-update last_inbox_read on own inbox sub","description":"When an agent subscribes to their own inbox, auto-update the timestamp:\n\n1. Detect current session ID (from hive session context)\n2. When `hive msg sub -t agent.{id}.inbox` is called\n3. If topic matches own inbox pattern, update `last_inbox_read`\n4. Persist to sessions.json\n\nAuto-detection logic:\n- Extract session ID from inbox topic pattern\n- Compare with current session ID\n- Only update if they match","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:39.880389-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:49:59.334799-06:00","closed_at":"2026-01-31T16:49:59.334799-06:00","close_reason":"Auto-update LastInboxRead when subscribing to own inbox in all sub modes (immediate, listen, wait)","dependencies":[{"issue_id":"hive-cn8.4","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:39.881171-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.4","depends_on_id":"hive-cn8.3","type":"blocks","created_at":"2026-01-31T16:44:50.261355-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.5","title":"Add hive msg sub --new flag","description":"Add --new flag to filter messages since last read:\n\n```bash\nhive msg sub -t agent.402h5p.inbox --new   # Only unread messages\nhive msg sub -t agent.402h5p.inbox         # All messages (default)\n```\n\nImplementation:\n- Check `last_inbox_read` timestamp for matching session\n- Filter messages where `created_at \u003e last_inbox_read`\n- Works with the read tracking auto-update","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:42.708659-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:51:26.779785-06:00","closed_at":"2026-01-31T16:51:26.779785-06:00","close_reason":"Added --new flag to filter messages since last inbox read","dependencies":[{"issue_id":"hive-cn8.5","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:42.709571-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.5","depends_on_id":"hive-cn8.4","type":"blocks","created_at":"2026-01-31T16:44:50.380372-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.6","title":"Add hive ls --json with inbox info","description":"Enhance hive ls for LLM-friendly output:\n\n```bash\n$ hive ls --json\n{\"id\":\"4uqf30\",\"name\":\"msg-tracking\",\"repo\":\"hive\",\"inbox\":\"agent.4uqf30.inbox\",\"last_active\":\"2026-01-31T16:30:00Z\",\"state\":\"active\",\"unread\":3}\n```\n\nFields:\n- id: session ID\n- name: session name\n- repo: repository name\n- inbox: derived inbox topic name\n- last_active: last_inbox_read timestamp\n- state: active/recycled\n- unread: count of messages since last_inbox_read (optional)\n\nOutput as JSON lines (one object per line) for easy parsing.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:44:46.722569-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:53:04.492081-06:00","closed_at":"2026-01-31T16:53:04.492081-06:00","close_reason":"Added --json flag to hive ls with inbox topic and unread count","dependencies":[{"issue_id":"hive-cn8.6","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:44:46.723283-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.6","depends_on_id":"hive-cn8.3","type":"blocks","created_at":"2026-01-31T16:44:50.465096-06:00","created_by":"Hayden"}]}
{"id":"hive-cn8.7","title":"Add hive doc messaging command for LLM guidance","description":"Add a `hive doc messaging` (or `hive doc inbox`) command that outputs documentation for LLMs on messaging conventions.\n\n## Output should explain:\n\n### Identity\n- Your session ID is available via `hive session info`\n- Your inbox topic is `agent.{session-id}.inbox`\n\n### Checking your inbox\n```bash\nhive msg sub -t agent.{id}.inbox --new   # Unread messages only\nhive msg sub -t agent.{id}.inbox         # All messages\n```\n\n### Sending to another agent\n```bash\n# Find agents\nhive ls --json\n\n# Send to their inbox\nhive msg pub -t agent.{their-id}.inbox \"message\"\n```\n\n### Conventions\n- Check inbox on startup for handoffs\n- Use inbox for direct agent-to-agent communication\n- Use custom topics for broadcast/pub-sub patterns\n- Include context in messages (what you're working on, what you need)\n\n### Message format suggestions\n- JSON for structured data\n- Markdown for human-readable handoffs\n- Include your session ID for reply routing\n\n## Implementation\n- Add to `cmd_doc.go` similar to `hive doc migrate`\n- Output as markdown for easy reading\n- Consider `--json` flag for machine-readable format","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T16:46:21.69152-06:00","created_by":"Hayden","updated_at":"2026-01-31T16:58:17.261877-06:00","closed_at":"2026-01-31T16:58:17.261877-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-cn8.7","depends_on_id":"hive-cn8","type":"parent-child","created_at":"2026-01-31T16:46:21.69411-06:00","created_by":"Hayden"},{"issue_id":"hive-cn8.7","depends_on_id":"hive-cn8.6","type":"blocks","created_at":"2026-01-31T16:46:25.560926-06:00","created_by":"Hayden"}]}
{"id":"hive-cxn","title":"Sort sessions with active before recycled","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:21.31874-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:08:32.815401-06:00","closed_at":"2026-01-30T17:08:32.815401-06:00","close_reason":"Updated sortSessions to sort active sessions before recycled, then by name."}
{"id":"hive-d43","title":"Unify actions as UserCommands with system defaults","description":"Rework the action system so all actions (including built-ins) are UserCommands. System provides default commands that users can override.\n\n## New Model\n\n### UserCommand gains 'action' field\n```go\ntype UserCommand struct {\n    Action  string `yaml:\"action\"`  // built-in action (recycle, delete) - mutually exclusive with sh\n    Sh      string `yaml:\"sh\"`      // shell command template\n    Help    string `yaml:\"help\"`\n    Confirm string `yaml:\"confirm\"`\n    Silent  bool   `yaml:\"silent\"`\n    Exit    string `yaml:\"exit\"`\n}\n```\n\n### System default commands\n```go\nvar defaultUserCommands = map[string]UserCommand{\n    \"Recycle\": {Action: \"recycle\", Help: \"recycle\", Confirm: \"Are you sure you want to recycle this session?\"},\n    \"Delete\":  {Action: \"delete\", Help: \"delete\", Confirm: \"Are you sure you want to delete this session?\"},\n}\n```\n\n### Simplified Keybinding struct\n```go\ntype Keybinding struct {\n    Cmd     string `yaml:\"cmd\"`     // command name (required)\n    Help    string `yaml:\"help\"`    // optional override\n    Confirm string `yaml:\"confirm\"` // optional override  \n}\n```\n\n### Default keybindings reference commands\n```go\nvar defaultKeybindings = map[string]Keybinding{\n    \"r\": {Cmd: \"Recycle\"},\n    \"d\": {Cmd: \"Delete\"},\n}\n```\n\n## Validation Changes\n- UserCommand: must have exactly one of `action` or `sh`\n- Keybinding: must have `cmd` that references existing UserCommand\n- Remove old `action` and `sh` fields from Keybinding\n\n## Benefits\n1. Single unified concept for all actions\n2. Command palette shows everything (system + user commands)\n3. Users can override system commands\n4. Simpler keybinding config","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T10:44:30.07589-06:00","created_by":"Hayden","updated_at":"2026-02-02T10:56:08.13348-06:00","closed_at":"2026-02-02T10:56:08.13348-06:00","close_reason":"Unified command model implemented - UserCommands now have action field, keybindings reference commands via cmd field"}
{"id":"hive-d98","title":"Implement global JSON file message store","description":"Implement the messaging Store interface using per-topic JSON files:\n\n- Storage location: $XDG_DATA_HOME/hive/messages/topics/{topic}.json\n- Reuse file locking pattern from kvstore.go (in-process mutex + flock)\n- Atomic writes via temp file + rename\n- Count-based retention: enforce max messages per topic on write (default 100)\n- Support topic wildcards for Subscribe (e.g., agent.* matches agent.build, agent.test)\n- Support subscribing to all topics when no pattern specified\n\nLocation: internal/store/jsonfile/msgstore.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.073644-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:23:45.952299-06:00","closed_at":"2026-01-29T20:23:45.952299-06:00","close_reason":"Implemented MsgStore with per-topic JSON files, file locking, atomic writes, count-based retention (default 100), and wildcard topic patterns","dependencies":[{"issue_id":"hive-d98","depends_on_id":"hive-cdw","type":"blocks","created_at":"2026-01-29T20:08:24.370052-06:00","created_by":"Hayden"}]}
{"id":"hive-djp","title":"Remove session count from repo headers","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:20.847234-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:05.101973-06:00","closed_at":"2026-01-30T17:10:05.101973-06:00","close_reason":"Removed session count from repo headers. Removed TotalCount/RecycledCount fields from TreeItem and HeaderCount style."}
{"id":"hive-dm5","title":"Research TUI focus indicator design options","description":"The current focus indicator (▸ and bold title) is too subtle - users accidentally press enter on the wrong pane.\n\n## Failed Approaches\n1. **Bordered panes** - Added rounded borders around focused pane. Removed header layout, looked cluttered.\n2. **Background tint on header** - Added blue background behind focused header text. Looked awful.\n\n## Research Needed\nLook at other TUI applications for inspiration on how they handle split pane focus:\n- lazygit\n- k9s\n- btop/htop\n- lazydocker\n- Other Bubble Tea apps\n\n## Possible Options to Explore\n- Different indicator symbols or positioning\n- Underline the focused header\n- Color the divider line based on which side is focused\n- Subtle highlight on selected list items only in focused pane\n- Different approach entirely?\n\n## User Feedback Requested\nWhat visual style would you prefer? Please add notes with examples or preferences.","notes":"## Research Findings\n\n### How Popular TUIs Handle Focus Indication\n\n#### 1. Lazygit / Lazydocker\n- **Bright blue border** around the focused pane (lazygotest confirms: 'highlighted with a bright blue border')\n- **Highlighted/brighter text** for active items\n- Very consistent visual language across all panels\n- Navigation: Tab to cycle, h/l or arrows to switch panes, number keys (1-5) for direct access\n\n#### 2. K9s (Kubernetes TUI)\n- Uses **configurable focus colors** via skins\n- Key styling properties: `focusColor`, `cursorColor`, `highlightColor`\n- Border has separate `fgColor` and `focusColor` \n- Allows full theme customization\n\n#### 3. btop/htop\n- **Color-coded sections** with distinct visual hierarchy\n- **Highlighted keys** are clickable/interactive\n- Relies more on section differentiation than active/inactive states\n- Uses ASCII art and Unicode for visual clarity\n\n#### 4. Tmux (Reference Pattern)\n- **Colorizes separators/dividers** adjacent to active pane\n- Inactive panes can be 'slightly greyed'\n- Active pane border set to distinct color (commonly blue)\n- Windows Terminal adopted similar approach\n\n### Bubble Tea / Lip Gloss Patterns\n\n#### Built-in Focus Support\n- `EnableReportFocus` for terminal focus events\n- Bubbles library has `Style struct` with focused/unfocused states\n- Common pattern: conditional style application based on focus state\n\n#### Border Options Available\n- `lipgloss.NormalBorder()` - standard\n- `lipgloss.ThickBorder()` - heavier weight\n- `lipgloss.DoubleBorder()` - double-line\n- `lipgloss.HiddenBorder()` - invisible (useful for unfocused to maintain alignment)\n- `BorderForeground()` to colorize\n\n### Design Options to Consider\n\nBased on research, here are the most viable approaches:\n\n#### Option A: Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Left focused: divider colored on right side or entire divider blue\n- Right focused: divider colored on left side\n- Subtle but effective in terminals\n\n#### Option B: Border Accent (lazygit-style)\nAdd a border to the focused pane only:\n- Focused: visible border (blue/accent color)\n- Unfocused: hidden border (maintains spacing)\n- Clear visual distinction\n\n#### Option C: Title Underline\nUnderline the focused pane title:\n- Less intrusive than borders\n- Clear indication of which pane\n- Works well with existing arrow indicator\n\n#### Option D: Dimmed Unfocused Pane\nDim/grey out the unfocused pane content:\n- Focused: normal colors\n- Unfocused: faded/dimmed colors\n- Common in IDEs (inactive panels)\n\n#### Option E: Selected Item Differentiation\nOnly show selection indicator in focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar shown\n- User sees which pane can receive input\n\n### Recommendation\n\n**Option A (Colored Divider)** is the most elegant solution:\n1. Minimal visual clutter\n2. Proven pattern (tmux, Windows Terminal)\n3. Easy to implement with lipgloss\n4. Works with existing arrow + bold title indicators\n\nImplementation would be:\n```go\n// In renderSplitView\nvar dividerColor lipgloss.Color\nif m.focusedPane == PaneSessions {\n    dividerColor = colorBlue  // Blue when left focused (divider 'points' right)\n} else {\n    dividerColor = colorBlue  // Blue when right focused\n}\ndivider := lipgloss.NewStyle().\n    Foreground(dividerColor).\n    Render(strings.Repeat(\"│\", contentHeight))\n```\n\nOr **Option E** could complement this - only showing the selection bar (┃) in the focused pane.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T14:35:02.81949-06:00","created_by":"Hayden","updated_at":"2026-01-30T14:39:10.487747-06:00","closed_at":"2026-01-30T14:39:10.487747-06:00","close_reason":"Research complete. Documented findings from lazygit, k9s, btop, lazydocker, and tmux. Recommended colored divider approach (Option A) as primary solution."}
{"id":"hive-e5x","title":"Add scrolling to command palette navigation\n","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T13:56:06.68367-06:00","created_by":"Hayden","updated_at":"2026-02-01T14:06:51.658543-06:00","closed_at":"2026-02-01T14:06:51.658543-06:00","close_reason":"Implemented scrolling in command palette at f5b2f42","comments":[{"id":2,"issue_id":"hive-e5x","author":"Hayden","text":"## Problem\n\nThe command palette shows a maximum of 12 commands at once. When there are more commands available, it displays \"... and more\" but doesn't scroll to show them as you navigate with arrow keys.\n\nCurrently if you press down arrow at the bottom of the visible list, nothing happens even though more commands exist.\n\n## Desired Behavior\n\n- When navigating down past the visible area, the list should scroll to show the next commands\n- When navigating up past the top, the list should scroll to show previous commands\n- The \"... and more\" indicator should update to show remaining items\n- Similar to vim command completion or VS Code command palette\n\n## Implementation Notes\n\n- Currently `maxVisible = 12` is a fixed limit in View()\n- Need to track scroll offset/viewport position\n- Update rendering to show commands based on: `filteredList[scrollOffset:scrollOffset+maxVisible]`\n- Adjust `selectedIdx` navigation to update scroll offset when needed\n- Example: if `selectedIdx == scrollOffset + maxVisible`, increment scrollOffset\n\n## Files\n\n- internal/tui/command_palette.go (View method, Update method)\n- internal/tui/command_palette_test.go (add scrolling tests)\n\n## Related\n\nCurrent code shows \"... and more\" at line 289 but doesn't allow scrolling to see those items.\n","created_at":"2026-02-01T19:56:43Z"}]}
{"id":"hive-eeb","title":"Fix orphaned worktrees on batch hook failure","description":"When hive batch creates sessions and a hook fails during initialization, the worktree is left behind even though no session is registered in hive ls and no tmux session is spawned.\n\nTwo fixes needed:\n1. Add cleanup logic in CreateSession to remove the cloned directory when post-clone operations (executeRules or spawn) fail\n2. Add an orphan worktree check in hive doctor to detect directories in repos folder without matching session records","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T21:55:54.972708-06:00","created_by":"Hayden","updated_at":"2026-01-31T22:00:58.732022-06:00","closed_at":"2026-01-31T22:00:58.732022-06:00","close_reason":"Implemented cleanup on failure in CreateSession and added orphan worktree detection in hive doctor"}
{"id":"hive-ein","title":"Add StateTracker for terminal status with acknowledgment","description":"Add StateTracker to terminal integration that:\n- Tracks last content hash to detect changes\n- Remembers acknowledged state (user has seen waiting status)\n- Transitions: active (content changing) → waiting (stable, unacknowledged) → idle (acknowledged)\n- Prevents flickering by requiring sustained state before transition\n\nReference Agent Deck's StateTracker implementation in internal/tmux/tmux.go","status":"tombstone","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T17:42:43.003463-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:46:33.324447-06:00","deleted_at":"2026-01-31T17:46:33.324447-06:00","deleted_by":"daemon","delete_reason":"delete","original_type":"task"}
{"id":"hive-ejn","title":"Add repo_dirs config field","description":"Add RepoDirs []string field to Config struct in internal/core/config/config.go\n\n- Field name: RepoDirs\n- YAML key: repo_dirs\n- Type: []string (list of directory paths)\n- No default value - empty means feature is disabled\n- No validation required beyond normal YAML parsing","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T19:21:24.198566-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:26:51.227143-06:00","closed_at":"2026-01-30T19:26:51.227143-06:00","close_reason":"Added RepoDirs []string field to Config struct","dependencies":[{"issue_id":"hive-ejn","depends_on_id":"hive-ewh","type":"parent-child","created_at":"2026-01-30T19:21:45.729412-06:00","created_by":"Hayden"}]}
{"id":"hive-ev5","title":"Add TUIConfig with refresh_interval to config","description":"Add a new TUIConfig struct to internal/core/config/config.go with a RefreshInterval field.\n\n```go\ntype TUIConfig struct {\n    RefreshInterval time.Duration `yaml:\"refresh_interval\"`\n}\n```\n\nAdd TUI field to main Config struct. Default: 15 seconds.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T23:25:51.400506-06:00","created_by":"Hayden","updated_at":"2026-01-30T23:32:17.239267-06:00","closed_at":"2026-01-30T23:32:17.239267-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-ev5","depends_on_id":"hive-0tq","type":"parent-child","created_at":"2026-01-30T23:26:20.569795-06:00","created_by":"Hayden"}]}
{"id":"hive-ewh","title":"New Session Dialog for Sessions TUI","description":"Add a dialog triggered by 'n' key in the Sessions TUI that allows creating a new session from any repository on the system. Uses a repo_dirs config setting to discover available repositories.\n\n## Requirements\n- Add repo_dirs config field - list of directories containing git repositories\n- Press 'n' key triggers a new session dialog\n- Dialog uses Huh forms with searchable repository selector and session name input\n- Smart auto-selection: If user is viewing a session in tree view, pre-select that repository\n- After form submission, call Service.CreateSession()\n- When repo_dirs is empty, disable the feature (hide keybinding)","status":"closed","priority":2,"issue_type":"epic","created_at":"2026-01-30T19:21:18.899905-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:33:49.421095-06:00","closed_at":"2026-01-30T19:33:49.421095-06:00","close_reason":"Completed all child tasks for new session dialog"}
{"id":"hive-faq","title":"Explore column-aligned session fields like a table","description":"Investigate aligning session fields (name, branch, ID, git status) into columns so they line up vertically across sessions, similar to a table layout.","status":"closed","priority":4,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:36.240683-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:45:45.219378-06:00","closed_at":"2026-01-30T17:45:45.219378-06:00","close_reason":"Implemented column alignment for session names. Added ColumnWidths pointer to delegate for dynamic updates. Name column is now padded to align IDs across sessions."}
{"id":"hive-fhz","title":"Copy GetStatus state machine logic","description":"Copy the GetStatus logic from agent-deck/internal/tmux/tmux.go:1440-1696\n\nKey logic to copy:\n1. Session existence check\n2. Activity timestamp retrieval and caching\n3. Busy indicator check with 25-line window (not 5)\n4. Prompt indicator check with priority over busy\n5. Spike detection (2+ changes in 1 second window)\n6. Grace period before leaving active state\n7. Acknowledged state check for idle vs waiting\n8. Content normalization for stable hashing\n\nState transitions:\n- busy indicator + no prompt → active\n- prompt detected → waiting\n- no busy, acknowledged → idle  \n- no busy, not acknowledged → waiting","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:53.650116-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:58:32.343575-06:00","closed_at":"2026-01-31T18:58:32.343575-06:00","close_reason":"GetStatus state machine implemented: 15-line window for detection, spike detection (2+ changes in 1s), acknowledged state for idle vs waiting, state transitions reset acknowledged on busy/prompt. Integration captures pane content and uses StateTracker.Update() for detection.","dependencies":[{"issue_id":"hive-fhz","depends_on_id":"hive-nrs","type":"blocks","created_at":"2026-01-31T18:47:15.895567-06:00","created_by":"Hayden"},{"issue_id":"hive-fhz","depends_on_id":"hive-r58","type":"blocks","created_at":"2026-01-31T18:47:15.987524-06:00","created_by":"Hayden"},{"issue_id":"hive-fhz","depends_on_id":"hive-clm","type":"blocks","created_at":"2026-01-31T18:49:37.688234-06:00","created_by":"Hayden"}]}
{"id":"hive-g4d","title":"Add subtle column headers to messages table view","description":"The messages table view should have subtle column headers to define each column.\n\n## Layout\n```\nTime     Topic      Message                              Sender\n────────────────────────────────────────────────────────────────\n14:32:01 [orders  ] New order received #12849...    api-gateway\n```\n\n## Requirements\n- Headers should be dimmed/gray to not compete with content\n- Use same column widths as the data rows\n- Consider a subtle separator line or just spacing","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:08.296689-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.532486-06:00","closed_at":"2026-01-30T15:58:21.532486-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-gmj","title":"Research charm markdown rendering (glamour)","description":"Investigate glamour library for rendering markdown in the TUI message preview modal.\n\nResearch:\n- How to integrate glamour with bubbles/lipgloss\n- Styling options and terminal compatibility\n- How to render markdown within a modal/viewport\n- Check if glamour is already a dependency or needs adding\n- Look at existing modal patterns in the codebase (OutputModal, Modal)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:32:04.363416-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:40:37.370189-06:00","closed_at":"2026-01-30T13:40:37.370189-06:00","close_reason":"Research complete. Glamour v2 needed as new dependency. Use tokyo-night style to match existing colors. Viewport bubble for scrollable content. See .hive/research/glamour-markdown-rendering.md"}
{"id":"hive-gvj","title":"Call Acknowledge from TUI when user views session","description":"When user interacts with a session in the TUI, call Acknowledge() to transition it from waiting (yellow) to idle (gray).\n\nTrigger points:\n- User opens/selects a session in the tree view\n- User focuses on a session's terminal output\n- User sends input to a session\n\nThis completes the feedback loop:\n1. Session finishes → waiting (yellow)\n2. User views session → Acknowledge() called → idle (gray)\n3. New activity → ResetAcknowledged() → back to waiting if needed","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:47:07.268839-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:09.191078-06:00","closed_at":"2026-01-31T19:02:09.191078-06:00","close_reason":"Added acknowledgeSession() tea.Cmd in terminalstatus.go. Updated model.go to track lastAcknowledgedID and call acknowledge when user navigates to a different session. Added acknowledgeSessionMsg handler in Update() to consume the message.","dependencies":[{"issue_id":"hive-gvj","depends_on_id":"hive-n53","type":"blocks","created_at":"2026-01-31T18:47:16.077445-06:00","created_by":"Hayden"}]}
{"id":"hive-hdg","title":"Implement hive msg CLI command","description":"Create the msg command with pub/sub/list subcommands:\n\nhive msg pub --topic \u003ctopic\u003e [message | -f file | stdin]\n  - Publish message to topic\n  - Auto-detect sender from session ID\n  \nhive msg sub [--topic \u003cpattern\u003e] [--timeout duration] [--last N]\n  - No topic: subscribe to all topics\n  - With topic: filter by pattern (supports wildcards like agent.*)\n  - --last N returns last N messages immediately\n  - Without --last, polls for new messages until timeout\n  \nhive msg list [--json]\n  - List all topics with message counts\n\nFollow pattern from cmd_ctx.go for structure.\nLocation: internal/commands/cmd_msg.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.434803-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:36:54.020004-06:00","closed_at":"2026-01-29T20:36:54.020004-06:00","close_reason":"Implemented hive msg CLI with pub/sub/list subcommands, auto sender detection, wildcard topic patterns, and polling for new messages","dependencies":[{"issue_id":"hive-hdg","depends_on_id":"hive-d98","type":"blocks","created_at":"2026-01-29T20:08:24.435226-06:00","created_by":"Hayden"},{"issue_id":"hive-hdg","depends_on_id":"hive-kto","type":"blocks","created_at":"2026-01-29T20:08:24.492719-06:00","created_by":"Hayden"}]}
{"id":"hive-irz","title":"Implement colored divider + focused-only selection indicator","description":"Improve focus indication by combining two techniques from research (hive-dm5):\n\n## Changes\n\n### 1. Colored Divider (tmux-style)\nChange the vertical divider color based on which pane is focused:\n- Focused pane side: blue divider\n- Unfocused: gray divider\n\n### 2. Focused-Only Selection Indicator\nOnly show the selection bar (┃) in the currently focused pane:\n- Active pane: blue bar on selected item\n- Inactive pane: no selection bar (just spacing)\n\nThis makes it immediately clear which pane will receive keyboard input.\n\n## Files to Modify\n- `internal/tui/styles.go` - divider style may need focus variant\n- `internal/tui/model.go` - pass focus state to divider rendering in `renderSplitView`\n- `internal/tui/delegate.go` - conditionally render selection bar based on pane focus\n- `internal/tui/messages_view.go` - same for message items\n\n## Acceptance Criteria\n- [ ] Divider changes color based on focused pane\n- [ ] Selection bar only visible in focused pane\n- [ ] Works correctly when switching focus with Tab\n- [ ] No visual glitches during focus transitions","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:23:59.087226-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:28:27.751431-06:00","closed_at":"2026-01-30T15:28:27.751431-06:00","close_reason":"Closed"}
{"id":"hive-ivh","title":"Remove Modal wrapper from new session form","description":"The new session form currently uses a Modal wrapper that adds Confirm/Cancel buttons, but huh forms have their own built-in keyboard handling.\n\n## Current behavior\n- Modal wrapper adds extra Confirm/Cancel buttons below the form\n- Duplicates help text that huh already shows\n\n## Expected behavior\n- Render huh form directly with modal styling but without buttons\n- Let huh handle confirm (enter) and cancel (esc) natively\n\n## Changes to internal/tui/model.go\n\nIn View(), change the form overlay from:\n```go\nformModal := NewModal(\"New Session\", m.newSessionForm.View())\nreturn formModal.Overlay(mainView, w, h)\n```\n\nTo:\n```go\nformContent := lipgloss.JoinVertical(\n    lipgloss.Left,\n    modalTitleStyle.Render(\"New Session\"),\n    \"\",\n    m.newSessionForm.View(),\n)\nformOverlay := modalStyle.Render(formContent)\nreturn lipgloss.Place(w, h, lipgloss.Center, lipgloss.Center, formOverlay)\n```","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:20.755462-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:31:59.893619-06:00","closed_at":"2026-01-30T21:31:59.893619-06:00","close_reason":"Already implemented - form renders with lipgloss styling directly without Modal wrapper buttons"}
{"id":"hive-jxd","title":"Display recycled items as collapsed count in tree view","description":"When displaying recycled items in the tree view, show them as a single collapsed item with the count of recycled sessions in parentheses (e.g., 'Recycled (5)') instead of listing each recycled session as a separate tree item.","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T21:27:39.074311-06:00","created_by":"Hayden","updated_at":"2026-01-31T21:34:30.763138-06:00","closed_at":"2026-01-31T21:34:30.763138-06:00","close_reason":"Closed"}
{"id":"hive-k95","title":"Research: Claude plugin architecture for hive","description":"Investigate creating a Claude plugin for hive.\n\n**Questions to answer:**\n- Trade-offs of Claude plugin vs other integration approaches\n- Key skill use cases to enable (what workflows should plugin support?)\n- How does a Claude plugin support/integrate with other tools?\n- Plugin distribution and versioning considerations","status":"open","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:26:15.646643-06:00","created_by":"Hayden","updated_at":"2026-01-31T23:26:15.646643-06:00"}
{"id":"hive-kdi","title":"TUI: Add sidebar view for tmux pane context","description":"Add sidebar to default TUI experience showing additional context.\n\n**Goals:**\n- Display tmux pane information\n- Show relevant data from the tmux environment\n- Provide at-a-glance context without switching views","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:26:26.120638-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:59:20.125305-06:00","closed_at":"2026-02-02T08:59:20.125305-06:00","close_reason":"Already implemented via tmux preview panel (commit 72cb09d)"}
{"id":"hive-kn0","title":"Fix layout shift between tabs - remove tree view top padding","description":"When switching between Sessions and Messages tabs, there's a visible layout shift. The tree view (Sessions) has extra top padding that Messages doesn't have, causing content to jump.\n\nFiles:\n- internal/tui/model.go - renderTabView() builds the layout\n- Check list padding vs msgView padding","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T17:18:31.836793-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:26:55.465296-06:00","closed_at":"2026-01-30T17:26:55.465296-06:00","close_reason":"Fixed by stripping empty title bar line from bubbles list when not filtering, and removing unused subheading"}
{"id":"hive-kto","title":"Add session ID detection from CWD","description":"Create utility to detect current hive session from working directory:\n\n- Read sessions.json from $XDG_DATA_HOME/hive/sessions.json\n- Find session where path matches or is prefix of CWD\n- Return session ID for use as sender identifier in messages\n- Return empty string if not in a hive session (allow anonymous publishing)\n\nThis enables automatic sender identification without manual configuration.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.255375-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:25:21.976907-06:00","closed_at":"2026-01-29T20:25:21.976907-06:00","close_reason":"Added SessionDetector to find current hive session from working directory with path prefix matching"}
{"id":"hive-kyp","title":"Modify form submission to set pending and quit","description":"Modify the form submission handler to set pendingCreate and exit TUI instead of calling createSession() inline.\n\n## Changes to internal/tui/model.go\n\nIn updateNewSessionForm(), change the completion handler:\n\n```go\nif f.State == huh.StateCompleted {\n    result := m.newSessionForm.Result()\n    m.state = stateNormal\n    m.newSessionForm = nil\n    // Set pending create and exit TUI\n    m.pendingCreate = \u0026PendingCreate{\n        Remote: result.Repo.Remote,\n        Name:   result.SessionName,\n    }\n    return m, tea.Quit\n}\n```\n\nThis replaces the current inline call to createSession().","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T21:20:04.566711-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:29:38.454822-06:00","closed_at":"2026-01-30T21:29:38.454822-06:00","close_reason":"Form submission now sets pendingCreate and calls tea.Quit instead of inline createSession()","dependencies":[{"issue_id":"hive-kyp","depends_on_id":"hive-22b","type":"blocks","created_at":"2026-01-30T21:20:27.563082-06:00","created_by":"Hayden"}]}
{"id":"hive-l87","title":"Add BatchSpawn field to config.Commands struct","description":"Add BatchSpawn []string field to Commands struct in internal/core/config/config.go\n\nThis will hold the spawn commands used specifically for batch session creation.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:30.620372-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:21:54.430594-06:00","closed_at":"2026-01-30T13:21:54.430594-06:00","close_reason":"Added BatchSpawn []string field to Commands struct"}
{"id":"hive-lei","title":"CreateSession output breaks TUI when called from sessions view","description":"When creating a session from the TUI (pressing 'n'), the CreateSession service method runs hooks/rules that output to stdout, which corrupts the TUI rendering.\n\n## Current behavior\n- CreateSession runs executeRules() which may print output\n- CreateSession runs spawner.Spawn() which outputs to terminal\n- This output is not captured and breaks the bubbletea TUI\n\n## Expected behavior\n- When called from TUI, output should be captured or suppressed\n- TUI should remain intact after session creation\n\n## Root cause\nCreateSession in internal/hive/service.go (lines 139-169):\n- executeRules() runs shell commands that may output\n- spawner.Spawn() runs spawn commands\n\n## Possible solutions\n1. Add a 'quiet' or 'noSpawn' option to CreateOptions\n2. Capture stdout/stderr when running from TUI context\n3. Skip spawn entirely when creating from TUI (user can open session from list)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:16:17.739358-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.175505-06:00","closed_at":"2026-01-30T21:20:35.175505-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation","dependencies":[{"issue_id":"hive-lei","depends_on_id":"hive-ljm","type":"blocks","created_at":"2026-01-30T20:16:28.55611-06:00","created_by":"Hayden"}]}
{"id":"hive-ljm","title":"New session from TUI should not spawn terminal","description":"When creating a session from the TUI, it spawns in the current terminal/zellij window instead of opening a new wezterm tab as configured.\n\n## Current behavior\n- CreateSession always calls spawner.Spawn() with configured spawn commands\n- When called from TUI, this runs spawn commands in the current terminal context\n- Results in session opening in current window instead of new tab\n\n## Expected behavior\n- TUI session creation should only create the session (clone repo, save metadata)\n- Should NOT run spawn commands\n- User selects the new session from the list and presses Enter to open it (which uses normal spawn flow)\n\n## Solution\nAdd SkipSpawn bool to CreateOptions in internal/hive/service.go:\n\n```go\ntype CreateOptions struct {\n    Name          string\n    Prompt        string\n    Remote        string\n    Source        string\n    UseBatchSpawn bool\n    SkipSpawn     bool  // NEW: skip spawning terminal (for TUI creation)\n}\n```\n\nThen in CreateSession, check SkipSpawn before running spawn commands:\n```go\nif !opts.SkipSpawn \u0026\u0026 len(spawnCommands) \u003e 0 {\n    // spawn terminal\n}\n```\n\nUpdate TUI to pass SkipSpawn: true when creating sessions.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T20:16:23.830603-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:20:35.15593-06:00","closed_at":"2026-01-30T21:20:35.15593-06:00","close_reason":"Superseded by new approach in epic hive-q39 - TUI exits before session creation"}
{"id":"hive-m1o","title":"Investigate SQLite storage migration","status":"open","priority":4,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:52.915306-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:30:52.915306-06:00"}
{"id":"hive-m6y","title":"Revert cleanup logic from CreateSession","description":"Remove the cleanupOnFailure logic added to CreateSession. We'll rely on hive doctor --fix instead of automatic cleanup during session creation.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T22:03:21.235954-06:00","created_by":"Hayden","updated_at":"2026-01-31T22:04:39.548906-06:00","closed_at":"2026-01-31T22:04:39.548906-06:00","close_reason":"Reverted cleanup logic from CreateSession"}
{"id":"hive-mte","title":"Pin keyboard hints to bottom of messages view","description":"The keyboard hints on the messages page don't extend to the bottom of the terminal. They should be pinned to the bottom row.\n\n## Expected\n- Help line should always appear at the bottom of the viewport\n- Content area should fill the space between headers and help line","status":"closed","priority":2,"issue_type":"bug","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:54:07.444763-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:58:21.514378-06:00","closed_at":"2026-01-30T15:58:21.514378-06:00","close_reason":"Fixed all four layout issues: removed duplicate headers, moved session state to tab bar, fixed layout shift by removing per-view titles, pinned help to bottom, and added column headers to messages table."}
{"id":"hive-muc","title":"Restore async git status display in tree view","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:23.190688-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:00:07.512917-06:00","closed_at":"2026-01-30T17:00:07.512917-06:00","close_reason":"Restored full git status display: branch, additions (+N green), deletions (-N red), and clean/uncommitted indicator. Shows '...' while loading."}
{"id":"hive-n53","title":"Add Acknowledge method to Integration interface","description":"Update internal/integration/terminal/terminal.go Integration interface:\n\n```go\ntype Integration interface {\n    Name() string\n    Available() bool\n    RefreshCache()\n    DiscoverSession(ctx, slug, metadata) (*SessionInfo, error)\n    GetStatus(ctx, info) (Status, error)\n    \n    // NEW: Mark session as acknowledged by user\n    Acknowledge(ctx context.Context, info *SessionInfo) error\n}\n```\n\nThen implement in internal/integration/terminal/tmux/tmux.go:\n\n```go\nfunc (t *Integration) Acknowledge(ctx context.Context, info *SessionInfo) error {\n    if info == nil {\n        return nil\n    }\n    t.mu.Lock()\n    defer t.mu.Unlock()\n    if tracker, ok := t.trackers[info.Name]; ok {\n        tracker.Acknowledge()\n    }\n    return nil\n}\n```","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:47:01.037366-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:55:33.030055-06:00","closed_at":"2026-01-31T18:55:33.030055-06:00","close_reason":"Added Acknowledge(ctx, info) method to Integration interface and implemented it in tmux.Integration."}
{"id":"hive-n9u","title":"Replace huh form with custom bubbles v2 components","description":"Replace `github.com/charmbracelet/huh` (bubbletea v1) with custom form components built on `charm.land/bubbles/v2` to resolve the v1/v2 incompatibility.\n\n## Files to Modify\n\n| File | Action |\n|------|--------|\n| `internal/tui/select_field.go` | CREATE - Select component wrapping list.Model |\n| `internal/tui/new_session_form.go` | REWRITE - Custom form using bubbles v2 |\n| `internal/tui/model.go` | UPDATE - Integration changes |\n| `internal/tui/styles.go` | UPDATE - Add form styles |\n| `internal/styles/styles.go` | UPDATE - Remove FormTheme() and huh import |\n| `go.mod` | UPDATE - Remove huh dependency |\n\n## Implementation\n\n### 1. SelectField Component (`select_field.go`)\n\nNew component wrapping `list.Model`:\n\n```go\ntype SelectField struct {\n    list      list.Model\n    items     []SelectItem\n    focused   bool\n    title     string\n}\n\ntype SelectItem struct {\n    Label string\n    Value int  // index into original data\n}\n```\n\nFeatures:\n- Filtering enabled (uses list's built-in filter)\n- Focus visual state (border color change)\n- Compact height (8 lines matching current huh config)\n- Preselection support\n\n### 2. NewSessionForm Rewrite\n\nReplace huh.Form wrapper with:\n\n```go\ntype NewSessionForm struct {\n    repos         []DiscoveredRepo\n    existingNames map[string]bool\n\n    repoSelect    SelectField\n    nameInput     textinput.Model\n\n    focusedField  int  // 0 = select, 1 = input\n    submitted     bool\n    cancelled     bool\n    nameError     string\n}\n```\n\nFocus management:\n- **Tab/Shift+Tab**: Cycle between select and text input\n- **Enter** on text input: Validate and submit\n- **Esc**: Cancel form\n\n### 3. model.go Integration\n\nUpdate `updateNewSessionForm`:\n```go\nfunc (m Model) updateNewSessionForm(msg tea.Msg) (tea.Model, tea.Cmd) {\n    form, cmd := m.newSessionForm.Update(msg)\n    m.newSessionForm = \u0026form\n\n    if m.newSessionForm.Submitted() {\n        result := m.newSessionForm.Result()\n        m.state = stateNormal\n        m.newSessionForm = nil\n        m.pendingCreate = \u0026PendingCreate{\n            Remote: result.Repo.Remote,\n            Name:   result.SessionName,\n        }\n        return m, tea.Quit\n    }\n\n    if m.newSessionForm.Cancelled() {\n        m.state = stateNormal\n        m.newSessionForm = nil\n        return m, nil\n    }\n\n    return m, cmd\n}\n```\n\n### 4. Styles (Tokyo Night)\n\nAdd to `styles.go`:\n```go\nformTitleStyle        // Blue, bold (focused)\nformTitleBlurredStyle // Gray (blurred)\nformFieldStyle        // Gray border\nformFieldFocusedStyle // Blue border\nformErrorStyle        // Red text for validation\nformHelpStyle         // Gray help text\n```\n\n### 5. Cleanup\n\nRemove from `internal/styles/styles.go`:\n- `FormTheme()` function\n- `github.com/charmbracelet/huh` import\n\nRemove from `go.mod`:\n- `github.com/charmbracelet/huh v0.8.0`\n\n## Key Design Decisions\n\n1. **Use list.Model for select** - Already has filtering, keyboard nav, selection tracking\n2. **Purpose-built, not generic** - Only 2 fields, no need for form framework\n3. **Inline validation errors** - Show below field in red\n4. **Tab navigation** - Form manages focus index, fields have Focus()/Blur()\n\n## Verification\n\n1. Run `go build ./...` - Verify compilation\n2. Run `go test ./internal/tui/...` - Verify tests pass\n3. Manual testing:\n   - Press 'n' in sessions TUI to open form\n   - Verify repo select shows and filters correctly\n   - Tab between fields\n   - Test validation (empty name, duplicate name)\n   - Submit with Enter, cancel with Esc\n   - Verify session creates correctly after form submit","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:39.870534-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:40:01.519961-06:00","closed_at":"2026-02-01T00:40:01.519961-06:00","close_reason":"Replaced huh form library with custom bubbles v2 components","dependencies":[{"issue_id":"hive-n9u","depends_on_id":"hive-ayy","type":"blocks","created_at":"2026-02-01T00:31:02.909601-06:00","created_by":"Hayden"}]}
{"id":"hive-n9u.1","title":"Create SelectField component","description":"Create `internal/tui/select_field.go` with a SelectField component wrapping bubbles v2 list.Model.\n\nFeatures:\n- Filtering enabled (uses list's built-in filter)\n- Focus visual state (border color change)\n- Compact height (8 lines matching current huh config)\n- Preselection support\n\nAPI:\n- NewSelectField(title, items, selected, height)\n- Focus(), Blur(), Focused()\n- SelectedIndex()\n- SetWidth(w)\n- Update(msg) / View()","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:46.776844-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:39:48.94467-06:00","closed_at":"2026-02-01T00:39:48.94467-06:00","close_reason":"Implemented custom bubbles v2 form components to replace huh","dependencies":[{"issue_id":"hive-n9u.1","depends_on_id":"hive-n9u","type":"parent-child","created_at":"2026-02-01T00:30:46.777691-06:00","created_by":"Hayden"}]}
{"id":"hive-n9u.2","title":"Rewrite NewSessionForm with bubbles v2","description":"Rewrite `internal/tui/new_session_form.go` to use SelectField and textinput.Model instead of huh.Form.\n\nReplace huh.Form wrapper with:\n- repoSelect: SelectField for repository selection\n- nameInput: textinput.Model for session name\n- focusedField: int for focus management\n- nameError: string for validation display\n\nFocus management:\n- Tab/Shift+Tab: Cycle between select and text input\n- Enter on text input: Validate and submit\n- Esc: Cancel form\n\nKeep same external API (Submitted, Cancelled, Result, SetSubmitted, SetCancelled).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:50.161012-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:39:48.965734-06:00","closed_at":"2026-02-01T00:39:48.965734-06:00","close_reason":"Implemented custom bubbles v2 form components to replace huh","dependencies":[{"issue_id":"hive-n9u.2","depends_on_id":"hive-n9u","type":"parent-child","created_at":"2026-02-01T00:30:50.161832-06:00","created_by":"Hayden"},{"issue_id":"hive-n9u.2","depends_on_id":"hive-n9u.1","type":"blocks","created_at":"2026-02-01T00:31:02.167-06:00","created_by":"Hayden"}]}
{"id":"hive-n9u.3","title":"Update model.go integration","description":"Update `internal/tui/model.go` to work with the new form implementation.\n\nChanges:\n- Remove huh import\n- Update updateNewSessionForm() to use new form's Update method\n- Simplify handleNewSessionFormKey() since form handles its own keys\n- Update form initialization to use new Init() command","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:52.592963-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:39:48.993648-06:00","closed_at":"2026-02-01T00:39:48.993648-06:00","close_reason":"Implemented custom bubbles v2 form components to replace huh","dependencies":[{"issue_id":"hive-n9u.3","depends_on_id":"hive-n9u","type":"parent-child","created_at":"2026-02-01T00:30:52.593801-06:00","created_by":"Hayden"},{"issue_id":"hive-n9u.3","depends_on_id":"hive-n9u.2","type":"blocks","created_at":"2026-02-01T00:31:02.254868-06:00","created_by":"Hayden"}]}
{"id":"hive-n9u.4","title":"Add form styles to styles.go","description":"Add form-specific styles to `internal/tui/styles.go` using Tokyo Night theme:\n\n- formTitleStyle: Blue, bold (focused)\n- formTitleBlurredStyle: Gray (blurred)\n- formFieldStyle: Gray border\n- formFieldFocusedStyle: Blue border\n- formErrorStyle: Red text for validation\n- formHelpStyle: Gray help text","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:54.927624-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:39:49.01324-06:00","closed_at":"2026-02-01T00:39:49.01324-06:00","close_reason":"Implemented custom bubbles v2 form components to replace huh","dependencies":[{"issue_id":"hive-n9u.4","depends_on_id":"hive-n9u","type":"parent-child","created_at":"2026-02-01T00:30:54.928453-06:00","created_by":"Hayden"}]}
{"id":"hive-n9u.5","title":"Remove huh dependency","description":"Cleanup huh dependency from the project:\n\n1. Remove FormTheme() from internal/styles/styles.go\n2. Remove huh import from internal/styles/styles.go\n3. Remove github.com/charmbracelet/huh from go.mod\n4. Run go mod tidy","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:30:56.958771-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:39:49.032265-06:00","closed_at":"2026-02-01T00:39:49.032265-06:00","close_reason":"Implemented custom bubbles v2 form components to replace huh","dependencies":[{"issue_id":"hive-n9u.5","depends_on_id":"hive-n9u","type":"parent-child","created_at":"2026-02-01T00:30:56.95957-06:00","created_by":"Hayden"},{"issue_id":"hive-n9u.5","depends_on_id":"hive-n9u.3","type":"blocks","created_at":"2026-02-01T00:31:02.33982-06:00","created_by":"Hayden"}]}
{"id":"hive-nfh","title":"Create subdirectories on hive init","description":"When running 'hive init', automatically create the research/, plans/, and references/ subdirectories inside the .hive context directory. Output what was created.\n\n**Current state:**\n- runInit in internal/commands/cmd_ctx.go creates context directory and symlink\n- Directory creation at line 104 with os.MkdirAll\n\n**Implementation:**\n1. After creating main context directory, create subdirectories:\n   - research/\n   - plans/\n   - references/\n2. Print output indicating what directories were created\n\n**Files to modify:**\n- internal/commands/cmd_ctx.go (add subdirectory creation after line 106)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T08:35:53.913488-06:00","created_by":"Hayden","updated_at":"2026-02-02T08:56:44.80661-06:00","closed_at":"2026-02-02T08:56:44.80661-06:00","close_reason":"Closed"}
{"id":"hive-nnn","title":"Add exit option for keybindings","description":"## Use Case\nRunning hive in a tmux popup (`display-popup -E \"hive\"`). When the user presses enter to switch to a tmux session, hive should exit so the popup closes automatically.\n\n## Current Behavior\n- Hive runs keybinding shell command\n- Shell command executes (e.g., `tmux switch-client -t SESSION`)\n- Hive stays open, popup remains visible\n- User must manually press `q` to close\n\n## Proposed Solution\nAdd an `exit: true` option to keybindings config that causes hive to quit after executing the shell command.\n\n```yaml\nkeybindings:\n  enter:\n    help: switch to tmux session\n    sh: tmux switch-client -t \"{{ .Name }}\"\n    exit: true\n```\n\n## Why This Matters\nEnables hive to work seamlessly as a tmux session picker in popup mode:\n1. User presses `prefix + Space` to open hive popup\n2. User navigates to desired repo\n3. User presses enter → session switches AND popup closes\n\nSource: Message on agent.700b from dotfiles repo","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T14:43:54.130536-06:00","created_by":"Hayden","updated_at":"2026-01-31T17:03:26.928365-06:00","closed_at":"2026-01-31T17:03:26.928365-06:00","close_reason":"Already implemented on main branch","comments":[{"id":1,"issue_id":"hive-nnn","author":"Hayden","text":"Already implemented on main branch","created_at":"2026-01-31T23:03:23Z"}]}
{"id":"hive-nrs","title":"Copy StateTracker struct with acknowledge fields","description":"Copy the StateTracker struct from agent-deck/internal/tmux/tmux.go:329-347 to internal/integration/terminal/state_tracker.go\n\nAdd fields:\n- acknowledged bool\n- acknowledgedAt time.Time  \n- waitingSince time.Time\n\nAdd methods:\n- Acknowledge()\n- ResetAcknowledged()\n- IsAcknowledged() bool\n\n**ResetAcknowledged behavior**: Match Agent Deck exactly - reset acknowledged to false when:\n- New activity detected (busy indicator found)\n- Prompt detected\n- Transitioning back to active state\n\nSee agent-deck/internal/tmux/tmux.go lines 1524, 1531, 1615, 1672, 1720, 1734 for all reset points.","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:39.565952-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:55:32.941432-06:00","closed_at":"2026-01-31T18:55:32.941432-06:00","close_reason":"Added acknowledged, acknowledgedAt, waitingSince fields to StateTracker. Added Acknowledge(), ResetAcknowledged(), IsAcknowledged(), WaitingSince() methods. Updated Update() to use acknowledge mechanism for waiting vs idle distinction."}
{"id":"hive-o60","title":"Update help display for unified command model","description":"Update help rendering to work with the new unified command model.\n\n## Changes Required\n\n### HelpEntries() and KeyBindings() methods\n1. For each keybinding, look up the referenced UserCommand\n2. Use keybinding.Help if set, otherwise use command.Help\n3. Handle missing command references gracefully (show 'unknown')\n\n### Command palette integration\nSystem commands (Recycle, Delete) should now appear in the command palette alongside user commands. This happens automatically since they're all UserCommands now.\n\n## Code Location\ninternal/tui/keybindings.go lines 151-199","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T10:44:50.719406-06:00","created_by":"Hayden","updated_at":"2026-02-02T10:56:16.515013-06:00","closed_at":"2026-02-02T10:56:16.515013-06:00","close_reason":"Help display already updated as part of keybindings.go refactor - HelpEntries() and KeyBindings() now look up commands","dependencies":[{"issue_id":"hive-o60","depends_on_id":"hive-d43","type":"blocks","created_at":"2026-02-02T10:45:11.999847-06:00","created_by":"Hayden"}]}
{"id":"hive-omz","title":"Vim-style command palette arguments","description":"# Vim-Style Command Arguments Implementation Plan\n\n## Overview\n\nAdd support for inline arguments in command palette: `:command arg1 arg2`\n\n**Design Choice**: Hybrid approach with text input + live-filtered suggestions\n- Preserves command discoverability (users see suggestions as they type)\n- Supports vim-style direct entry (`:review file.go`)\n- Backward compatible (`:review` without args still works)\n\n## Architecture Changes\n\n### 1. Command Palette UI Refactor\n**File**: `internal/tui/command_palette.go`\n\n**Current**: Uses `list.Model` for browsing/filtering commands\n**New**: Custom text input with manual suggestion rendering\n\n```go\ntype CommandPalette struct {\n    commands      []CommandEntry\n    input         textinput.Model  // NEW: \":cmd args\" input\n    filteredList  []CommandEntry   // NEW: live-filtered suggestions\n    selectedIdx   int              // NEW: selected suggestion\n    // ... rest unchanged\n}\n```\n\n**User Flow**:\n1. Press `:` → text input shown with all commands as suggestions\n2. Type `rev` → filters to commands starting with \"rev\"\n3. Up/Down arrows → navigate suggestions\n4. Type more: `review file.go` → args captured\n5. Enter → execute selected command with args\n\n### 2. Input Parsing\n**New File**: `internal/tui/command_parser.go`\n\n```go\ntype ParsedCommand struct {\n    Name string   // \"review\"\n    Args []string // [\"file.go\", \"main.go\"]\n    Raw  string   // \":review file.go main.go\"\n}\n\nfunc ParseCommandInput(input string) ParsedCommand\n```\n\nSimple whitespace splitting (no quoted string support initially).\n\n### 3. Template Data Extension\n**File**: `internal/tui/keybindings.go` (lines 201-232)\n\nAdd `Args []string` field to template data struct:\n\n```go\ndata := struct {\n    Path   string\n    Remote string\n    ID     string\n    Name   string\n    Args   []string  // NEW\n}{\n    Path:   sess.Path,\n    Remote: sess.Remote,\n    ID:     sess.ID,\n    Name:   sess.Name,\n    Args:   args,\n}\n```\n\n**Template Usage**:\n```yaml\nusercommands:\n  review:\n    sh: \"send-claude {{ .Name }} /review {{ index .Args 0 }}\"\n  echo:\n    sh: \"echo {{ range .Args }}{{ . }} {{ end }}\"\n```\n\n### 4. Integration Points\n\n**File**: `internal/tui/model.go` (line 643)\n\nUpdate `handleCommandPaletteKey` to extract args:\n```go\nif entry, args, ok := m.commandPalette.SelectedCommand(); ok {\n    action := m.handler.ResolveUserCommand(entry.Name, entry.Command, *selected, args)\n    // ... rest unchanged\n}\n```\n\n**File**: `internal/tui/command_palette.go` (line 184)\n\nUpdate `SelectedCommand` signature:\n```go\nfunc (p *CommandPalette) SelectedCommand() (*CommandEntry, []string, bool)\n```\n\n## Implementation Steps\n\n1. **Create parser** (`command_parser.go`)\n   - `ParseCommandInput` function\n   - Unit tests for edge cases\n\n2. **Refactor command palette UI**\n   - Replace `list.Model` with `textinput.Model`\n   - Implement manual suggestion rendering\n   - Add keyboard navigation (up/down for suggestions)\n   - Update filtering logic\n\n3. **Extend template data**\n   - Add `Args` field to data struct in `keybindings.go`\n   - Update `ResolveUserCommand` signature\n\n4. **Update integration**\n   - Modify `handleCommandPaletteKey` in `model.go`\n   - Update `SelectedCommand` return type\n\n5. **Testing**\n   - Parser unit tests\n   - Palette interaction tests\n   - Template rendering tests with args\n   - Manual integration testing\n\n## Backward Compatibility\n\n✅ **Fully backward compatible**:\n- Commands without args work: `:review` → empty Args array\n- Existing templates unchanged: `{{ .Path }}` still works\n- Config format unchanged\n- Keybindings unaffected (separate code path)\n\n## Files to Modify\n\n**Core changes**:\n- `internal/tui/command_palette.go` - UI refactor (~150 lines)\n- `internal/tui/keybindings.go` - Template data (lines 201-232)\n- `internal/tui/model.go` - Integration (line 643)\n\n**New files**:\n- `internal/tui/command_parser.go` - Input parsing\n- `internal/tui/command_parser_test.go` - Tests\n\n**Documentation**:\n- README.md - Template variable docs, usage examples\n\n## Testing Strategy\n\n**Unit Tests**:\n- Parser: empty input, command only, command with args, whitespace handling\n- Template: accessing Args, empty Args, range over Args\n\n**Integration Tests**:\n- Type command name → see filtered suggestions\n- Type command with args → execute with args\n- Navigate suggestions with arrows → select\n- Command not found → \"No matches\"\n\n## Known Limitations\n\n1. **No quoted strings**: Arguments cannot contain spaces (`:cmd \"arg with spaces\"` not supported)\n   - Future enhancement if needed\n2. **Template arg access**: Must check bounds: `{{ if gt (len .Args) 0 }}{{ index .Args 0 }}{{ end }}`\n   - Could add helper function later: `{{ arg .Args 0 \"default\" }}`\n\n## Verification\n\nAfter implementation:\n1. Run all tests: `task test`\n2. Run linter: `task lint`\n3. Manual test flow:\n   - Press `:` → see command list\n   - Type partial name → see filtered suggestions\n   - Type full command + args → execute\n   - Arrow keys → navigate suggestions\n   - Esc → cancel\n4. Test template rendering with multiple arg patterns\n5. Verify backward compatibility (commands without args)","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T12:20:26.020203-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:47:37.195666-06:00","closed_at":"2026-02-01T12:47:37.195666-06:00","close_reason":"Closed"}
{"id":"hive-omz.1","title":"Create command parser for input parsing","description":"Create internal/tui/command_parser.go with ParseCommandInput function. Parse ':command arg1 arg2' into name and args array. Simple whitespace splitting. Add unit tests.","status":"closed","priority":2,"issue_type":"task","assignee":"Hayden","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T12:20:31.142237-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:35:02.208812-06:00","closed_at":"2026-02-01T12:35:02.208812-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-omz.1","depends_on_id":"hive-omz","type":"parent-child","created_at":"2026-02-01T12:20:31.142974-06:00","created_by":"Hayden"}]}
{"id":"hive-omz.2","title":"Refactor command palette UI for text input","description":"Replace list.Model with textinput.Model in command_palette.go. Add filteredList and selectedIdx fields. Implement manual suggestion rendering. Add up/down navigation for suggestions.","status":"closed","priority":2,"issue_type":"task","assignee":"Hayden","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T12:20:32.476261-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:46:21.86265-06:00","closed_at":"2026-02-01T12:46:21.86265-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-omz.2","depends_on_id":"hive-omz","type":"parent-child","created_at":"2026-02-01T12:20:32.476987-06:00","created_by":"Hayden"},{"issue_id":"hive-omz.2","depends_on_id":"hive-omz.1","type":"blocks","created_at":"2026-02-01T12:20:51.58293-06:00","created_by":"Hayden"}]}
{"id":"hive-omz.3","title":"Extend template data with Args field","description":"Add Args []string field to template data struct in keybindings.go (lines 201-232). Update ResolveUserCommand signature to accept args parameter.","status":"closed","priority":2,"issue_type":"task","assignee":"Hayden","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T12:20:33.463819-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:42:40.971694-06:00","closed_at":"2026-02-01T12:42:40.971694-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-omz.3","depends_on_id":"hive-omz","type":"parent-child","created_at":"2026-02-01T12:20:33.464551-06:00","created_by":"Hayden"}]}
{"id":"hive-omz.4","title":"Update model integration for args","description":"Modify handleCommandPaletteKey in model.go to extract args from SelectedCommand. Update SelectedCommand signature to return args. Pass args to ResolveUserCommand.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T12:20:34.832692-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:46:21.92867-06:00","closed_at":"2026-02-01T12:46:21.92867-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-omz.4","depends_on_id":"hive-omz","type":"parent-child","created_at":"2026-02-01T12:20:34.833413-06:00","created_by":"Hayden"},{"issue_id":"hive-omz.4","depends_on_id":"hive-omz.2","type":"blocks","created_at":"2026-02-01T12:20:52.265476-06:00","created_by":"Hayden"},{"issue_id":"hive-omz.4","depends_on_id":"hive-omz.3","type":"blocks","created_at":"2026-02-01T12:20:52.333674-06:00","created_by":"Hayden"}]}
{"id":"hive-omz.5","title":"Add comprehensive tests for args feature","description":"Parser unit tests (empty, command only, with args, whitespace). Palette interaction tests. Template rendering tests with Args access. Integration tests for full flow.","status":"closed","priority":2,"issue_type":"task","assignee":"Hayden","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T12:20:36.203655-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:47:31.745668-06:00","closed_at":"2026-02-01T12:47:31.745668-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-omz.5","depends_on_id":"hive-omz","type":"parent-child","created_at":"2026-02-01T12:20:36.204411-06:00","created_by":"Hayden"},{"issue_id":"hive-omz.5","depends_on_id":"hive-omz.4","type":"blocks","created_at":"2026-02-01T12:20:52.782226-06:00","created_by":"Hayden"}]}
{"id":"hive-q39","title":"TUI Session Creation - Exit, Execute, Re-enter","description":"When creating a session from TUI via 'n' key:\n1. Show form to select repo and enter session name\n2. On submit → **exit TUI cleanly**\n3. Run full `CreateSession()` with visible output (hooks, spawn commands)\n4. **Re-enter TUI** with updated session list\n\n## Current State\n\n- TUI stays active during session creation\n- Uses `SkipSpawn: true` to avoid spawning terminals\n- Hooks output goes to stdout, corrupting TUI display\n\n## Implementation\n\n### 1. Add `PendingCreate` field to Model (`internal/tui/model.go`)\n\n```go\n// PendingCreate holds data for a session to create after TUI exits\ntype PendingCreate struct {\n    Remote string\n    Name   string\n}\n\ntype Model struct {\n    // ... existing fields\n    pendingCreate *PendingCreate\n}\n\n// Getter for cmd_tui.go to access\nfunc (m Model) PendingCreate() *PendingCreate {\n    return m.pendingCreate\n}\n```\n\n### 2. Modify form submission to set pending and quit (`internal/tui/model.go`)\n\nIn `updateNewSessionForm()`, instead of calling `createSession()`:\n\n```go\nif f.State == huh.StateCompleted {\n    result := m.newSessionForm.Result()\n    m.state = stateNormal\n    m.newSessionForm = nil\n    // Set pending create and exit TUI\n    m.pendingCreate = \u0026PendingCreate{\n        Remote: result.Repo.Remote,\n        Name:   result.SessionName,\n    }\n    return m, tea.Quit\n}\n```\n\n### 3. Loop in cmd_tui.go to handle pending actions (`internal/commands/cmd_tui.go`)\n\n```go\nfunc (cmd *TuiCmd) run(ctx context.Context, _ *cli.Command) error {\n    localRemote, _ := cmd.flags.Service.DetectRemote(ctx, \".\")\n    topicsDir := filepath.Join(cmd.flags.DataDir, \"messages\", \"topics\")\n    msgStore := jsonfile.NewMsgStore(topicsDir)\n\n    for {\n        opts := tui.Options{\n            LocalRemote: localRemote,\n            MsgStore:    msgStore,\n        }\n\n        m := tui.New(cmd.flags.Service, cmd.flags.Config, opts)\n        p := tea.NewProgram(m, tea.WithAltScreen())\n\n        finalModel, err := p.Run()\n        if err != nil {\n            return fmt.Errorf(\"run tui: %w\", err)\n        }\n\n        model := finalModel.(tui.Model)\n\n        // Handle pending session creation\n        if pending := model.PendingCreate(); pending != nil {\n            source, _ := os.Getwd()\n            _, err := cmd.flags.Service.CreateSession(ctx, hive.CreateOptions{\n                Name:   pending.Name,\n                Remote: pending.Remote,\n                Source: source,\n            })\n            if err != nil {\n                fmt.Printf(\"Error creating session: %v\\n\", err)\n                fmt.Println(\"Press Enter to continue...\")\n                fmt.Scanln()\n            }\n            continue // Restart TUI\n        }\n\n        break // Normal exit\n    }\n    return nil\n}\n```\n\n### 4. Remove SkipSpawn option (`internal/hive/service.go`)\n\nRevert the `SkipSpawn` field from `CreateOptions` since we no longer need it.\n\n### 5. Clean up unused code\n\n- Remove `createSession()` command method from model.go\n- Remove `sessionCreatedMsg` message type\n\n## Verification\n\n1. Run `hive` (TUI mode)\n2. Press 'n' to open new session form\n3. Select a repo and enter session name\n4. Press Enter to submit\n5. Verify: TUI exits, hooks run with visible output, spawn commands execute\n6. Verify: TUI re-enters with new session in list\n7. Test cancelling form with Esc - should stay in TUI\n8. Test ctrl+c during form - should exit completely","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-30T21:19:50.906429-06:00","created_by":"Hayden","updated_at":"2026-01-30T21:32:14.180241-06:00","closed_at":"2026-01-30T21:32:14.180241-06:00","close_reason":"All subtasks completed: Added PendingCreate type, modified form submission to exit TUI, added loop in cmd_tui.go for pending actions, cleaned up SkipSpawn"}
{"id":"hive-qg5","title":"Adjust preview layout: reduce tree view info density, enlarge preview","description":"## Current State\n\nWhen preview is enabled, layout is 35% tree view / 65% preview. Tree view shows all session info inline.\n\n## Desired State\n\n- Reduce tree view to minimal info (just session names)\n- Increase preview to larger portion (e.g., 25% / 75%)\n- Move detailed info above preview pane output:\n\n```\n\u003csession name\u003e\n--------------------------------------------------------\nid:  \u003csession-id\u003e\ngit: \u003cbranch\u003e \u003cchanges\u003e * \u003cuncommitted\u003e\n\nOutput\n--------------------------------------------------------\n\u003cpane content here\u003e\n```\n\n## Implementation Notes\n\n- Modify renderDualColumnLayout to use 25/75 split instead of 35/65\n- Create new preview header section with session metadata\n- Simplify tree delegate rendering when preview is active\n- Use horizontal dividers (dashes) to separate sections\n\n## Files\n- internal/tui/model.go (renderDualColumnLayout)\n- internal/tui/delegate.go (conditional rendering based on preview state)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T16:12:12.160165-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:16:21.947213-06:00","closed_at":"2026-02-01T16:16:21.947214-06:00","labels":["enhancement","tui"]}
{"id":"hive-r58","title":"Copy PromptDetector with tool-specific patterns","description":"Copy PromptDetector from agent-deck/internal/tmux/detector.go to internal/integration/terminal/detector.go\n\nKey functions:\n- HasPrompt() - main entry point\n- hasClaudePrompt() - Claude-specific detection\n- hasGeminiPrompt() - Gemini-specific detection  \n- hasShellPrompt() - generic shell detection\n- StripANSI() - O(n) ANSI removal\n\nPatterns to copy:\n- Permission prompts (Yes allow once, No and tell Claude...)\n- Empty input prompts (\u003e, ❯)\n- Busy exclusions (ctrl+c to interrupt, spinners)\n- Box-drawing UI detection","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:46.31169-06:00","created_by":"Hayden","updated_at":"2026-01-31T18:55:33.118374-06:00","closed_at":"2026-01-31T18:55:33.118374-06:00","close_reason":"Already implemented - detector.go has IsBusy(), IsWaiting(), stripANSI(), and all required patterns for Claude, Gemini, and shell detection."}
{"id":"hive-rr5","title":"Simplify max_recycled: remove global, use catch-all","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T10:21:42.507774-06:00","created_by":"Hayden","updated_at":"2026-01-31T10:24:39.845358-06:00","closed_at":"2026-01-31T10:24:39.845358-06:00","close_reason":"Closed"}
{"id":"hive-rum","title":"Add copy-to-clipboard shortcut for message preview","description":"Add ability to copy message payload from the message preview modal using a keyboard shortcut.\n\n## Requirements\n- Add a keybinding (e.g., 'c' or 'y') in the message preview modal to copy payload\n- Copy command should be configurable in config (e.g., `pbcopy` on macOS, `xclip` on Linux)\n- Show brief feedback when copy succeeds\n\n## Files to modify\n- `internal/tui/message_preview.go` - handle copy key\n- `internal/core/config/config.go` - add copy command config option\n- Possibly add a clipboard utility package","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:38:38.235427-06:00","created_by":"Hayden","updated_at":"2026-01-30T16:13:21.048895-06:00","closed_at":"2026-01-30T16:13:21.048895-06:00","close_reason":"Added copy-to-clipboard with 'c' or 'y' key in message preview modal. Copy command is configurable via commands.copy_command config option with OS-specific defaults (pbcopy on macOS, xclip on Linux, clip on Windows)."}
{"id":"hive-rx8","title":"Use distinct color for session IDs","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:22.03027-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:32.018019-06:00","closed_at":"2026-01-30T17:10:32.018019-06:00","close_reason":"Changed session ID color from gray to purple (#bb9af7) for better distinction."}
{"id":"hive-se4","title":"Integration: Better Claude Code agent experience","description":"Improve integration with Claude Code and similar coding agents.\n\n**Features to explore:**\n- Pull in and display context percentage\n- Enable/explain available features\n- Surface agent status and capabilities\n- Consider generalization to other coding agents","status":"open","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T23:26:31.353032-06:00","created_by":"Hayden","updated_at":"2026-01-31T23:26:31.353032-06:00"}
{"id":"hive-sy7","title":"Update filter to match repo and session names","description":"Extend filter to match against both repository names and session names. Show matching sessions and their repo headers.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:38:11.22383-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:05:55.709011-06:00","closed_at":"2026-01-30T17:05:55.709011-06:00","close_reason":"Already implemented. FilterValue returns 'repoName sessionName' for sessions, enabling filter to match either. Headers return empty but display when child sessions match.","dependencies":[{"issue_id":"hive-sy7","depends_on_id":"hive-60w","type":"blocks","created_at":"2026-01-30T16:38:24.996916-06:00","created_by":"Hayden"}]}
{"id":"hive-uhe","title":"Remove KV store implementation","description":"Remove the KV store code entirely:\n\n- Delete internal/core/context/kv.go\n- Delete internal/store/jsonfile/kvstore.go  \n- Remove 'hive ctx kv' subcommand from cmd_ctx.go\n- Remove any KV-related tests\n- Clean up any imports/references\n\nState storage will be handled by beads instead.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.613123-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:45:05.437764-06:00","closed_at":"2026-01-29T20:45:05.437764-06:00","close_reason":"Removed KV store: deleted internal/core/context/kv.go, internal/store/jsonfile/kvstore.go and test, removed hive ctx kv subcommand from cmd_ctx.go","dependencies":[{"issue_id":"hive-uhe","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.550509-06:00","created_by":"Hayden"}]}
{"id":"hive-uio","title":"Add batch_spawn command config","description":"Add a separate spawn command config for batch sessions that supports prompts.\n\nCurrent state:\n- commands.spawn is used for all session spawning\n- Prompt was removed from hive new (good - keeps it simple)\n- But batch needs prompts for automation\n\nSolution:\n- Add commands.batch_spawn config option\n- batch_spawn supports {{.Prompt}} template variable\n- hive batch uses batch_spawn if configured, falls back to spawn\n- hive new continues using spawn (no prompt)\n\nConfig example:\n```yaml\ncommands:\n  spawn:        # Used by hive new\n    - \"wezterm cli spawn --cwd {{.Path}}\"\n  batch_spawn:  # Used by hive batch (optional)\n    - \"wezterm cli spawn --cwd {{.Path}} -- claude --prompt '{{.Prompt}}'\"\n```","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:25.981268-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:24:03.646186-06:00","closed_at":"2026-01-30T13:24:03.646186-06:00","close_reason":"Feature complete: batch_spawn config added with full Prompt support for batch sessions","dependencies":[{"issue_id":"hive-uio","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:43.442982-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-13m","type":"blocks","created_at":"2026-01-30T13:19:43.501181-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-4fk","type":"blocks","created_at":"2026-01-30T13:19:43.563115-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-an2","type":"blocks","created_at":"2026-01-30T13:19:43.624774-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-143","type":"blocks","created_at":"2026-01-30T13:19:43.685034-06:00","created_by":"Hayden"}]}
{"id":"hive-uja","title":"Update KeybindingHandler for command-only model","description":"Refactor KeybindingHandler to work with the new unified command model where all keybindings reference UserCommands.\n\n## Changes Required\n\n### Constructor changes\n```go\nfunc NewKeybindingHandler(keybindings map[string]Keybinding, commands map[string]UserCommand, service *hive.Service) *KeybindingHandler\n```\n\n### Simplified Resolve method\n1. Look up keybinding by key\n2. Look up referenced UserCommand by name\n3. Build Action based on command type:\n   - If command.Action is set → ActionTypeRecycle or ActionTypeDelete\n   - If command.Sh is set → ActionTypeShell (render template)\n4. Apply keybinding overrides (help, confirm) if set\n\n### Remove old logic\n- Remove direct action/sh handling from keybindings\n- All resolution goes through UserCommand lookup\n\n### Error handling\n- Return error action if command reference is invalid\n- Log warning for missing command references\n\n## Code Location\ninternal/tui/keybindings.go","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-02T10:44:36.935445-06:00","created_by":"Hayden","updated_at":"2026-02-02T10:56:08.154432-06:00","closed_at":"2026-02-02T10:56:08.154432-06:00","close_reason":"Unified command model implemented - UserCommands now have action field, keybindings reference commands via cmd field","dependencies":[{"issue_id":"hive-uja","depends_on_id":"hive-d43","type":"blocks","created_at":"2026-02-02T10:45:11.917337-06:00","created_by":"Hayden"}]}
{"id":"hive-ujz","title":"Add theming support for TUI and CLI","status":"open","priority":4,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:35:59.346331-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:35:59.346331-06:00"}
{"id":"hive-um2","title":"Add error wrapping to session store","description":"**Files**: `internal/store/jsonfile/store.go`\n**Risk**: Very Low\n\n## Problem\n\nSession Store returns unwrapped errors while MsgStore wraps all errors with context:\n\n**store.go (lines 131-136):**\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, err  // No wrapping!\n    }\n    // ...\n}\n```\n\n## Solution\n\nAdd consistent error wrapping to store.go:\n\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, fmt.Errorf(\"read sessions file: %w\", err)\n    }\n\n    if len(data) == 0 {\n        return SessionFile{}, nil\n    }\n\n    var file SessionFile\n    if err := json.Unmarshal(data, \u0026file); err != nil {\n        return SessionFile{}, fmt.Errorf(\"parse sessions file: %w\", err)\n    }\n\n    return file, nil\n}\n\nfunc (s *Store) save(file SessionFile) error {\n    if err := os.MkdirAll(filepath.Dir(s.path), 0o755); err != nil {\n        return fmt.Errorf(\"create sessions directory: %w\", err)\n    }\n\n    data, err := json.MarshalIndent(file, \"\", \"  \")\n    if err != nil {\n        return fmt.Errorf(\"marshal sessions: %w\", err)\n    }\n\n    tmp := s.path + \".tmp\"\n    if err := os.WriteFile(tmp, data, 0o644); err != nil {\n        return fmt.Errorf(\"write temp file: %w\", err)\n    }\n\n    if err := os.Rename(tmp, s.path); err != nil {\n        return fmt.Errorf(\"rename temp file: %w\", err)\n    }\n    return nil\n}\n```\n\n## Impact\n- Better error messages when debugging storage issues\n- Consistent pattern across all stores","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:23.201647-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:07:40.440236-06:00","closed_at":"2026-01-30T19:07:40.440236-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-um2","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.029504-06:00","created_by":"Hayden"}]}
{"id":"hive-v1u","title":"Auto-fill input when navigating command palette with arrow keys","description":"## Problem\n\nWhen navigating through filtered commands with arrow keys (up/down/ctrl+j/ctrl+k), the text input should auto-fill with the selected command name to provide better visual feedback and allow users to see the full command before executing.\n\n## Current Behavior\n\n- Arrow keys move selection highlight through suggestions\n- Input text remains unchanged\n- User must remember which command is selected\n\n## Desired Behavior\n\n- Arrow key navigation updates the input field with the selected command name\n- Preserves any arguments already typed\n- Example flow:\n  1. User types \":echo\" → filters to EchoCommand\n  2. User presses down arrow → input updates to \":EchoSomethingElse\"\n  3. User presses enter → executes the selected command\n\n## Implementation Considerations\n\n- Should we preserve user's original input to restore on ESC?\n- How to handle arguments that were already typed?\n  - Option A: Replace entire input with command name only\n  - Option B: Keep args, just update command name portion\n- Consider adding visual indicator that input was auto-filled\n\n## Related Issues\n\n- hive-v4d (tab completion) - similar behavior\n- These features should work together cohesively\n\n## Files\n\n- internal/tui/command_palette.go (Update method, navigation handling)\n- internal/tui/command_parser.go (may need to parse/reconstruct input)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T13:27:50.439299-06:00","created_by":"Hayden","updated_at":"2026-02-01T13:38:08.285166-06:00","closed_at":"2026-02-01T13:38:08.285166-06:00","close_reason":"Closed"}
{"id":"hive-v4d","title":"Add tab-completion to command palette","description":"## Problem\n\nThe command palette autocomplete experience needs improvement. Users should be able to tab-complete through filtered items like neovim's command mode.\n\n## Current Behavior\n\n- Type to filter commands\n- Use arrow keys/ctrl+j/ctrl+k to navigate\n- No tab completion\n\n## Desired Behavior\n\n- Tab key cycles through filtered suggestions\n- Shift+Tab cycles backwards\n- Typing continues to filter the list\n- Tab completion should feel natural like neovim :command mode\n\n## Implementation Notes\n\n- Update command_palette.go to handle tab/shift+tab keys\n- Tab should cycle selectedIdx through filteredList\n- Consider whether tab should also auto-fill the input with the selected command name\n\n## Files\n\n- internal/tui/command_palette.go\n- internal/tui/command_palette_test.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T13:26:42.569212-06:00","created_by":"Hayden","updated_at":"2026-02-01T13:38:08.362751-06:00","closed_at":"2026-02-01T13:38:08.362751-06:00","close_reason":"Closed"}
{"id":"hive-vcv","title":"TUI: Add tmux pane context sidebar (Issue #55)","description":"Implementation plan for adding a sidebar to hive TUI that displays tmux pane context.\n\n## Approach: Minimal MVP\n- Dual-column layout when width \u003e= 80 (35% list, 65% preview)\n- Single-column layout when width \u003c 80\n- Toggle preview with v keybinding\n- Configuration option to enable/disable by default\n- Extend existing terminal status polling to include pane content\n\n## Implementation Steps\n1. Add PreviewEnabled config to TUIConfig\n2. Extend terminal status structs to include pane content\n3. Add preview state to TUI model\n4. Implement v key toggle handler\n5. Implement dual-column layout rendering\n6. Update window resize handler\n\n## Files to Modify\n- internal/core/config/config.go\n- internal/tui/terminalstatus.go\n- internal/integration/terminal/terminal.go\n- internal/integration/terminal/tmux/tmux.go\n- internal/tui/model.go","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T15:44:31.476257-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.341863-06:00","closed_at":"2026-02-01T16:06:13.341863-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["enhancement","tui"]}
{"id":"hive-vcv.1","title":"Add PreviewEnabled config option to TUIConfig","description":"Extend TUIConfig struct in internal/core/config/config.go to include PreviewEnabled field (default: true for discoverability). Update DefaultConfig() function.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":30,"created_at":"2026-02-01T15:44:37.815735-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.335977-06:00","closed_at":"2026-02-01T16:06:13.335977-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["config","tui"],"dependencies":[{"issue_id":"hive-vcv.1","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:37.816735-06:00","created_by":"Hayden"}]}
{"id":"hive-vcv.2","title":"Extend terminal status structs to include pane content","description":"Add Content field to TerminalStatus (internal/tui/terminalstatus.go), SessionInfo (internal/integration/terminal/terminal.go), and update tmux integration GetStatus() to capture and store content.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":45,"created_at":"2026-02-01T15:44:39.729048-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.337459-06:00","closed_at":"2026-02-01T16:06:13.337459-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["terminal-integration","tui"],"dependencies":[{"issue_id":"hive-vcv.2","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:39.73051-06:00","created_by":"Hayden"}]}
{"id":"hive-vcv.3","title":"Add preview state to TUI model","description":"Add previewEnabled field to Model struct in internal/tui/model.go and initialize from config in New() function.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":15,"created_at":"2026-02-01T15:44:40.894474-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.338386-06:00","closed_at":"2026-02-01T16:06:13.338386-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["tui"],"dependencies":[{"issue_id":"hive-vcv.3","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:40.895496-06:00","created_by":"Hayden"},{"issue_id":"hive-vcv.3","depends_on_id":"hive-vcv.1","type":"blocks","created_at":"2026-02-01T15:45:14.11749-06:00","created_by":"Hayden"}]}
{"id":"hive-vcv.4","title":"Implement v key toggle handler and help text","description":"Add v key handler in handleNormalKey() to toggle preview. Update AdditionalShortHelpKeys to show v keybinding when appropriate (Sessions view, width \u003e= 80).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":30,"created_at":"2026-02-01T15:44:43.289906-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.339155-06:00","closed_at":"2026-02-01T16:06:13.339155-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["keybinding","tui"],"dependencies":[{"issue_id":"hive-vcv.4","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:43.290899-06:00","created_by":"Hayden"},{"issue_id":"hive-vcv.4","depends_on_id":"hive-vcv.3","type":"blocks","created_at":"2026-02-01T15:45:14.206816-06:00","created_by":"Hayden"}]}
{"id":"hive-vcv.5","title":"Implement dual-column layout rendering","description":"Modify renderTabView() to support dual-column mode. Implement renderDualColumnLayout() helper (35% list, 65% preview with separator). Implement renderPreviewPane() to display session info + tmux output.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":90,"created_at":"2026-02-01T15:44:45.15273-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.339888-06:00","closed_at":"2026-02-01T16:06:13.339888-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["layout","tui"],"dependencies":[{"issue_id":"hive-vcv.5","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:45.153649-06:00","created_by":"Hayden"},{"issue_id":"hive-vcv.5","depends_on_id":"hive-vcv.2","type":"blocks","created_at":"2026-02-01T15:45:14.305386-06:00","created_by":"Hayden"},{"issue_id":"hive-vcv.5","depends_on_id":"hive-vcv.3","type":"blocks","created_at":"2026-02-01T15:45:14.390624-06:00","created_by":"Hayden"}]}
{"id":"hive-vcv.6","title":"Update window resize handler for preview mode","description":"Modify WindowSizeMsg handler in Update() to adjust list width based on preview state (35% when preview enabled and width \u003e= 80, full width otherwise).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":20,"created_at":"2026-02-01T15:44:47.15018-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.340572-06:00","closed_at":"2026-02-01T16:06:13.340572-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["tui"],"dependencies":[{"issue_id":"hive-vcv.6","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:47.151094-06:00","created_by":"Hayden"},{"issue_id":"hive-vcv.6","depends_on_id":"hive-vcv.5","type":"blocks","created_at":"2026-02-01T15:45:14.479492-06:00","created_by":"Hayden"}]}
{"id":"hive-vcv.7","title":"Test preview functionality","description":"Manual testing: layout modes (\u003c 80 cols, \u003e= 80 cols, resize), toggle with v key, content display (with/without tmux), configuration options, edge cases (long output, wide lines, empty pane). Verify no performance regression or integration issues.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","estimated_minutes":60,"created_at":"2026-02-01T15:44:49.910991-06:00","created_by":"Hayden","updated_at":"2026-02-01T16:06:13.341218-06:00","closed_at":"2026-02-01T16:06:13.341218-06:00","close_reason":"Completed tmux preview sidebar implementation with proper truncation and tail display","labels":["testing","tui"],"dependencies":[{"issue_id":"hive-vcv.7","depends_on_id":"hive-vcv","type":"parent-child","created_at":"2026-02-01T15:44:49.911878-06:00","created_by":"Hayden"},{"issue_id":"hive-vcv.7","depends_on_id":"hive-vcv.6","type":"blocks","created_at":"2026-02-01T15:45:14.562085-06:00","created_by":"Hayden"}]}
{"id":"hive-vzg","title":"Match tree view selector style with messages view","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T16:53:24.004265-06:00","created_by":"Hayden","updated_at":"2026-01-30T17:10:59.942146-06:00","closed_at":"2026-01-30T17:10:59.942146-06:00","close_reason":"Changed tree view selection indicator from ▸ to ┃ to match messages view style."}
{"id":"hive-wf6","title":"Copy Agent Deck detection algorithm to hive terminal integration","description":"## Vision\n\nAgent Deck's terminal state detection is MIT licensed and battle-tested. Rather than reinventing the wheel, copy their algorithm as closely as possible to get reliable detection.\n\n## Source Files (MIT Licensed)\n\nCopy from `agent-deck/internal/tmux/`:\n- `tmux.go` - StateTracker struct, GetStatus logic, hasBusyIndicator, hasPromptIndicator\n- `detector.go` - PromptDetector with tool-specific patterns, StripANSI\n- `patterns.go` - Configurable pattern system with regex support\n\n## Target Location\n\n`internal/integration/terminal/`\n\n## Key Components to Copy\n\n### 1. StateTracker (from tmux.go:329-347)\n```go\ntype StateTracker struct {\n    lastHash              string\n    lastChangeTime        time.Time\n    acknowledged          bool      // KEY: tracks if user saw session\n    acknowledgedAt        time.Time // grace period for state transitions\n    lastActivityTimestamp int64\n    waitingSince          time.Time // when session became waiting\n    activityCheckStart    time.Time\n    activityChangeCount   int\n}\n```\n\n### 2. GetStatus Logic (from tmux.go:1440-1696)\n- Check session exists\n- Get activity timestamp\n- Check busy indicator (spinner, ctrl+c to interrupt)\n- Check prompt indicator (permission dialogs, empty prompt)\n- Spike detection (2+ changes in 1 second)\n- Grace period before leaving active state\n- Return idle vs waiting based on acknowledged flag\n\n### 3. PromptDetector (from detector.go)\n- Tool-specific detection (claude, gemini, opencode, codex, shell)\n- Permission prompt patterns\n- Empty input prompt patterns\n- Busy indicator exclusions\n\n### 4. Acknowledge Mechanism\n- `Acknowledge()` - mark session as seen\n- `ResetAcknowledged()` - clear on new activity\n- Integration interface needs Acknowledge method\n\n## Success Criteria\n\n- Permission dialogs detected as \"waiting\" (high priority)\n- Empty `\u003e` prompt detected as \"waiting\" (needs acknowledge to become idle)\n- Spinner/busy indicators detected as \"active\"\n- User acknowledge transitions waiting → idle\n- No false positives from cursor blinks or status bar updates","status":"closed","priority":1,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-31T18:46:34.698795-06:00","created_by":"Hayden","updated_at":"2026-01-31T19:02:34.67755-06:00","closed_at":"2026-01-31T19:02:34.67755-06:00","close_reason":"All subtasks completed: StateTracker with acknowledge fields, Integration.Acknowledge interface method, PromptDetector patterns, GetStatus state machine, content normalization, TUI acknowledge integration. Detection now distinguishes: active (spinner), waiting (prompt/needs attention), idle (acknowledged).","dependencies":[{"issue_id":"hive-wf6","depends_on_id":"hive-nrs","type":"blocks","created_at":"2026-01-31T18:50:30.100842-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-r58","type":"blocks","created_at":"2026-01-31T18:50:30.186693-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-clm","type":"blocks","created_at":"2026-01-31T18:50:30.274766-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-fhz","type":"blocks","created_at":"2026-01-31T18:50:30.360028-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-n53","type":"blocks","created_at":"2026-01-31T18:50:30.447671-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-gvj","type":"blocks","created_at":"2026-01-31T18:50:30.55299-06:00","created_by":"Hayden"},{"issue_id":"hive-wf6","depends_on_id":"hive-6ze","type":"blocks","created_at":"2026-01-31T18:50:30.644025-06:00","created_by":"Hayden"}]}
{"id":"hive-wvy","title":"Update msg command: list by default, JSON output","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:48:11.945114-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:49:53.159676-06:00","closed_at":"2026-01-29T20:49:53.159676-06:00","close_reason":"Updated msg sub to list messages by default (JSON), added --listen flag for polling mode, made msg list output JSON"}
{"id":"hive-x04","title":"Code Quality Improvements","description":"Address code duplication and inconsistent patterns found during codebase analysis.\n\n## Overview\n\nThis epic addresses code duplication and inconsistent patterns found during codebase analysis. The improvements are ordered by impact and risk.\n\n---\n\n## 1. Extract Duplicate Directory Reading in MsgStore\n\n**Priority**: High\n**Files**: `internal/store/jsonfile/msgstore.go`\n\n### Problem\n\n`List()` (lines 174-202) and `listTopicsUnsafe()` (lines 283-306) contain nearly identical logic for reading topic files from disk.\n\n**List():**\n```go\nentries, err := os.ReadDir(s.topicsDir)\nif err != nil {\n    if os.IsNotExist(err) {\n        return nil, nil\n    }\n    return nil, fmt.Errorf(\"read topics directory: %w\", err)\n}\n\nvar topics []string\nfor _, entry := range entries {\n    if entry.IsDir() {\n        continue\n    }\n    name := entry.Name()\n    if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n        topic := strings.TrimSuffix(name, \".json\")\n        topic = strings.ReplaceAll(topic, \"_\", \"/\")\n        topics = append(topics, topic)\n    }\n}\nsort.Strings(topics)\nreturn topics, nil\n```\n\n**listTopicsUnsafe():**\n```go\n// Identical except no sort.Strings() call\n```\n\n### Solution\n\nExtract shared logic into a private `readTopicsFromDisk()` helper:\n\n```go\n// readTopicsFromDisk reads topic names from the topics directory.\n// Returns nil, nil if directory doesn't exist.\n// Caller is responsible for locking.\nfunc (s *MsgStore) readTopicsFromDisk() ([]string, error) {\n    entries, err := os.ReadDir(s.topicsDir)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil, nil\n        }\n        return nil, fmt.Errorf(\"read topics directory: %w\", err)\n    }\n\n    var topics []string\n    for _, entry := range entries {\n        if entry.IsDir() {\n            continue\n        }\n        name := entry.Name()\n        if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n            topic := strings.TrimSuffix(name, \".json\")\n            topic = strings.ReplaceAll(topic, \"_\", \"/\")\n            topics = append(topics, topic)\n        }\n    }\n    return topics, nil\n}\n```\n\nThen simplify both callers:\n\n```go\n// List returns all topic names (sorted).\nfunc (s *MsgStore) List(ctx context.Context) ([]string, error) {\n    s.mu.RLock()\n    defer s.mu.RUnlock()\n\n    topics, err := s.readTopicsFromDisk()\n    if err != nil {\n        return nil, err\n    }\n    sort.Strings(topics)\n    return topics, nil\n}\n\n// listTopicsUnsafe returns all topic names without locking.\n// Caller must hold s.mu.\nfunc (s *MsgStore) listTopicsUnsafe() ([]string, error) {\n    return s.readTopicsFromDisk()\n}\n```\n\n### Impact\n- Eliminates 20+ lines of duplicate code\n- Single source of truth for topic parsing logic\n- Easier to maintain filename conventions\n\n---\n\n## 2. Unify Template Rendering Between Spawner and Recycler\n\n**Priority**: Medium\n**Files**: `internal/hive/spawner.go`, `internal/hive/recycler.go`, `pkg/tmpl/tmpl.go`\n\n### Problem\n\nSpawner uses `tmpl.Render()` from `pkg/tmpl` while Recycler implements its own `renderCommand()` method. Both do the same thing but with slightly different error handling.\n\n**Spawner (line 48):**\n```go\nrendered, err := tmpl.Render(cmdTmpl, data)\n```\n\n**Recycler (lines 61-72):**\n```go\nfunc (r *Recycler) renderCommand(cmd string, data RecycleData) (string, error) {\n    tmpl, err := template.New(\"cmd\").Parse(cmd)\n    if err != nil {\n        return \"\", err\n    }\n\n    var buf bytes.Buffer\n    if err := tmpl.Execute(\u0026buf, data); err != nil {\n        return \"\", err\n    }\n\n    return buf.String(), nil\n}\n```\n\n### Solution\n\nUpdate Recycler to use `tmpl.Render()`:\n\n1. Remove `renderCommand()` method from Recycler\n2. Remove `bytes`, `text/template` imports from recycler.go\n3. Add `github.com/hay-kot/hive/pkg/tmpl` import\n4. Use `tmpl.Render()` in the Recycle method\n\n```go\nfunc (r *Recycler) Recycle(ctx context.Context, path string, commands []string, data RecycleData, w io.Writer) error {\n    // ...\n    for _, cmd := range commands {\n        rendered, err := tmpl.Render(cmd, data)\n        if err != nil {\n            return fmt.Errorf(\"render recycle command %q: %w\", cmd, err)\n        }\n        // ...\n    }\n}\n```\n\n### Impact\n- Single template rendering implementation\n- Recycler gets access to `shq` shell-quoting function\n- Consistent error wrapping (`parse template:` vs raw error)\n\n---\n\n## 3. Standardize Git Executor Error Messages\n\n**Priority**: Medium\n**Files**: `internal/core/git/executor.go`\n\n### Problem\n\nError messages have inconsistent formats:\n\n| Method | Current Error | Issue |\n|--------|--------------|-------|\n| Clone | `clone %s to %s: %w` | Has args, no prefix |\n| Checkout | `checkout %s: %w` | Has arg, no prefix |\n| Pull | `pull: %w` | No context |\n| ResetHard | `reset --hard: %w` | Command literal |\n| RemoteURL | `get remote url: %w` | Description |\n| IsClean | `git status: %w` | Has git prefix |\n| Branch | `git branch: %w` | Has git prefix |\n| DiffStats | `git diff: %w` | Has git prefix |\n\n### Solution\n\nStandardize to format: `git \u003ccommand\u003e[ \u003ccontext\u003e]: \u003cerror\u003e`\n\n```go\nfunc (e *Executor) Clone(ctx context.Context, url, dest string) error {\n    if _, err := e.exec.Run(ctx, e.gitPath, \"clone\", url, dest); err != nil {\n        return fmt.Errorf(\"git clone: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Checkout(ctx context.Context, dir, branch string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"checkout\", branch); err != nil {\n        return fmt.Errorf(\"git checkout %s: %w\", branch, err)\n    }\n    return nil\n}\n\nfunc (e *Executor) Pull(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"pull\"); err != nil {\n        return fmt.Errorf(\"git pull: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) ResetHard(ctx context.Context, dir string) error {\n    if _, err := e.exec.RunDir(ctx, dir, e.gitPath, \"reset\", \"--hard\"); err != nil {\n        return fmt.Errorf(\"git reset --hard: %w\", err)\n    }\n    return nil\n}\n\nfunc (e *Executor) RemoteURL(ctx context.Context, dir string) (string, error) {\n    out, err := e.exec.RunDir(ctx, dir, e.gitPath, \"remote\", \"get-url\", \"origin\")\n    if err != nil {\n        return \"\", fmt.Errorf(\"git remote get-url: %w\", err)\n    }\n    return strings.TrimSpace(string(out)), nil\n}\n```\n\n### Impact\n- Consistent error messages aid debugging\n- Users can easily identify which git command failed\n\n---\n\n## 4. Add Error Wrapping to Session Store\n\n**Priority**: Low\n**Files**: `internal/store/jsonfile/store.go`\n\n### Problem\n\nSession Store returns unwrapped errors while MsgStore wraps all errors with context:\n\n**store.go (lines 131-136):**\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, err  // No wrapping!\n    }\n    // ...\n}\n```\n\n**msgstore.go (lines 312-320):**\n```go\nfunc (s *MsgStore) loadTopic(name string) (messaging.Topic, error) {\n    // ...\n    if err != nil {\n        if os.IsNotExist(err) {\n            return messaging.Topic{...}, nil\n        }\n        return messaging.Topic{}, fmt.Errorf(\"read topic file: %w\", err)  // Wrapped\n    }\n}\n```\n\n### Solution\n\nAdd consistent error wrapping to store.go:\n\n```go\nfunc (s *Store) load() (SessionFile, error) {\n    data, err := os.ReadFile(s.path)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return SessionFile{}, nil\n        }\n        return SessionFile{}, fmt.Errorf(\"read sessions file: %w\", err)\n    }\n\n    if len(data) == 0 {\n        return SessionFile{}, nil\n    }\n\n    var file SessionFile\n    if err := json.Unmarshal(data, \u0026file); err != nil {\n        return SessionFile{}, fmt.Errorf(\"parse sessions file: %w\", err)\n    }\n\n    return file, nil\n}\n\nfunc (s *Store) save(file SessionFile) error {\n    if err := os.MkdirAll(filepath.Dir(s.path), 0o755); err != nil {\n        return fmt.Errorf(\"create sessions directory: %w\", err)\n    }\n\n    data, err := json.MarshalIndent(file, \"\", \"  \")\n    if err != nil {\n        return fmt.Errorf(\"marshal sessions: %w\", err)\n    }\n\n    tmp := s.path + \".tmp\"\n    if err := os.WriteFile(tmp, data, 0o644); err != nil {\n        return fmt.Errorf(\"write temp file: %w\", err)\n    }\n\n    if err := os.Rename(tmp, s.path); err != nil {\n        return fmt.Errorf(\"rename temp file: %w\", err)\n    }\n    return nil\n}\n```\n\n### Impact\n- Better error messages when debugging storage issues\n- Consistent pattern across all stores\n\n---\n\n## Summary\n\n| Task | Priority | Lines Changed | Risk |\n|------|----------|---------------|------|\n| Extract MsgStore directory reading | High | ~30 | Low |\n| Unify template rendering | Medium | ~20 | Low |\n| Standardize git error messages | Medium | ~15 | Very Low |\n| Add Store error wrapping | Low | ~15 | Very Low |\n\n**Total estimated changes**: ~80 lines\n**Risk assessment**: All changes are internal refactors with no API changes\n\n---\n\n## Implementation Order\n\n1. Start with git executor error messages (lowest risk, quick win)\n2. Add Store error wrapping (isolated change)\n3. Extract MsgStore helper (clear duplication)\n4. Unify template rendering (requires import changes)\n\nEach change should be tested independently before moving to the next.","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:10.232864-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:44.979035-06:00","closed_at":"2026-01-30T19:08:44.979035-06:00","close_reason":"Closed"}
{"id":"hive-yym","title":"Remove brackets from tab indicators","description":"Remove the [] brackets around the active tab indicator - they throw off alignment.\n\n## Current\n`[Sessions] | Messages`\n\n## Desired\n`Sessions | Messages` (with styling to indicate active tab)\n\n## Files to modify\n- `internal/tui/model.go` - `renderTabView` function","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T15:38:43.47297-06:00","created_by":"Hayden","updated_at":"2026-01-30T15:41:54.732103-06:00","closed_at":"2026-01-30T15:41:54.732103-06:00","close_reason":"Removed brackets from tab indicators - active tabs now use styling (blue + bold) only"}
{"id":"hive-zlk","title":"User Commands with Command Palette","description":"Add user-defined commands accessible via a vim-style `:` command palette.\n\n## Configuration Schema\n\nAdd to `internal/core/config/config.go`:\n\n```yaml\n# Simple format (string expands to {sh: \"...\"})\nusercommands:\n  claude-review: \"send-claude {{ .Name }} /do-pr-review\"\n\n# Extended format (object with options)\nusercommands:\n  claude-review:\n    sh: \"send-claude {{ .Name }} /do-pr-review\"\n    help: \"Send PR to Claude for review\"\n    confirm: \"Send this session to Claude for review?\"\n    silent: false\n    exit: false\n```\n\n```go\n// UserCommand defines a named command accessible via command palette.\ntype UserCommand struct {\n    Sh      string `yaml:\"sh\"`      // shell command template (required)\n    Help    string `yaml:\"help\"`    // description shown in palette\n    Confirm string `yaml:\"confirm\"` // confirmation prompt (empty = no confirm)\n    Silent  bool   `yaml:\"silent\"`  // skip loading popup\n    Exit    string `yaml:\"exit\"`    // exit after command (bool or $ENV_VAR)\n}\n\n// UnmarshalYAML supports string shorthand: \"cmd\" → {sh: \"cmd\"}\n```\n\n## Files to Modify\n\n### 1. `internal/core/config/config.go`\n- Add `UserCommand` struct (similar to `Keybinding` but without `Action` field)\n- Add `UserCommands map[string]UserCommand` to `Config` struct (line ~72)\n- Implement `UnmarshalYAML` for string shorthand support\n- Add `ShouldExit() bool` method\n\n### 2. `internal/core/config/validate.go`\n- Add `validateUserCommandsBasic()` validation (sh required)\n- Add template validation in `ValidateDeep()` for usercommand templates\n\n### 3. `internal/tui/model.go`\n- Add `stateCommandPalette` to `UIState` enum (line 32)\n- Add `commandPalette *CommandPalette` field to `Model` struct\n- Handle `:` key in `handleNormalKey()` (line ~690)\n- Add `handleCommandPaletteKey()` method\n- Update `handleKey()` to route to palette handler\n- Add palette overlay rendering in `View()`\n- Add `:` to help bindings when usercommands configured\n\n### 4. `internal/tui/command_palette.go` (new file)\nCreate command palette component with:\n- CommandPalette struct with list.Model\n- CommandEntry struct for command items\n- NewCommandPalette, Update, View, Overlay methods\n- SelectedCommand() returns chosen command\n- IsFiltering() for key routing\n- Use SelectField pattern from select_field.go\n\n### 5. `internal/tui/keybindings.go`\nAdd method to resolve UserCommand to Action:\n- ResolveUserCommand(name, cmd, sess) Action\n\n## Execution Flow\n\n1. User presses `:` → `stateCommandPalette` activated\n2. Command palette overlay shown with searchable list\n3. User navigates/filters commands, presses Enter\n4. Selected command resolved to `Action` via `ResolveUserCommand()`\n5. If `confirm` set → `stateConfirming` with pending action\n6. Otherwise execute via existing `executeAction()` pipeline\n7. On completion: reload sessions, check `exit` flag\n\n## Template Variables\n\nSame as keybindings:\n- `{{ .Path }}` - session directory path\n- `{{ .Remote }}` - git remote URL\n- `{{ .ID }}` - session ID\n- `{{ .Name }}` - session name\n\n## Testing\n\n1. Config parsing tests (string shorthand, full object, validation)\n2. Command palette tests (filtering, selection, cancel)\n3. Manual testing with sample config","status":"closed","priority":2,"issue_type":"epic","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:02.560306-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:11:29.816174-06:00","closed_at":"2026-02-01T12:11:29.816174-06:00","close_reason":"Core feature complete in 4d9d393. Command palette fully functional with tests passing. Optional enhancement task hive-zlk.6 remains for additional test coverage."}
{"id":"hive-zlk.1","title":"Add UserCommand struct and config field","description":"Add UserCommand configuration to internal/core/config/config.go:\n\n1. Add UserCommand struct:\n```go\ntype UserCommand struct {\n    Sh      string `yaml:\"sh\"`\n    Help    string `yaml:\"help\"`\n    Confirm string `yaml:\"confirm\"`\n    Silent  bool   `yaml:\"silent\"`\n    Exit    string `yaml:\"exit\"`\n}\n```\n\n2. Add to Config struct:\n```go\nUserCommands map[string]UserCommand `yaml:\"usercommands\"`\n```\n\n3. Implement UnmarshalYAML for string shorthand support:\n- \"cmd\" expands to {sh: \"cmd\"}\n\n4. Add ShouldExit() bool method (same pattern as Keybinding)","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:15.66222-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:11:20.117733-06:00","closed_at":"2026-02-01T12:11:20.117733-06:00","close_reason":"Completed in 4d9d393: full user command palette implementation","dependencies":[{"issue_id":"hive-zlk.1","depends_on_id":"hive-zlk","type":"parent-child","created_at":"2026-02-01T10:54:15.663316-06:00","created_by":"Hayden"}]}
{"id":"hive-zlk.2","title":"Add UserCommand validation","description":"Add validation for usercommands in internal/core/config/validate.go:\n\n1. Add validateUserCommandsBasic() method:\n   - Validate sh field is required (non-empty)\n   - Add to Validate() chain\n\n2. Add template validation in ValidateDeep():\n   - Validate usercommand sh templates compile correctly\n   - Use same pattern as keybinding template validation","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:20.874814-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:11:20.119699-06:00","closed_at":"2026-02-01T12:11:20.119699-06:00","close_reason":"Completed in 4d9d393: full user command palette implementation","dependencies":[{"issue_id":"hive-zlk.2","depends_on_id":"hive-zlk","type":"parent-child","created_at":"2026-02-01T10:54:20.877002-06:00","created_by":"Hayden"},{"issue_id":"hive-zlk.2","depends_on_id":"hive-zlk.1","type":"blocks","created_at":"2026-02-01T10:54:52.481762-06:00","created_by":"Hayden"}]}
{"id":"hive-zlk.3","title":"Create command palette TUI component","description":"Create new file internal/tui/command_palette.go:\n\n1. CommandEntry struct:\n```go\ntype CommandEntry struct {\n    Name    string\n    Command config.UserCommand\n}\n```\n\n2. CommandPalette struct:\n```go\ntype CommandPalette struct {\n    commands  []CommandEntry\n    list      list.Model\n    width     int\n    height    int\n    session   *session.Session\n    selected  bool\n    cancelled bool\n}\n```\n\n3. Implement methods:\n   - NewCommandPalette(cmds map[string]UserCommand, sess *session.Session, w, h int) *CommandPalette\n   - Update(msg tea.Msg) (*CommandPalette, tea.Cmd)\n   - View() string\n   - Overlay(background string, w, h int) string\n   - SelectedCommand() (*CommandEntry, bool)\n   - Cancelled() bool\n   - IsFiltering() bool\n\n4. Use SelectField pattern from select_field.go:\n   - list.Model with filtering enabled\n   - Navigation with j/k, up/down\n   - Enter to select, Esc to cancel\n   - / to start filter","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:26.09052-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:11:20.12138-06:00","closed_at":"2026-02-01T12:11:20.12138-06:00","close_reason":"Completed in 4d9d393: full user command palette implementation","dependencies":[{"issue_id":"hive-zlk.3","depends_on_id":"hive-zlk","type":"parent-child","created_at":"2026-02-01T10:54:26.091652-06:00","created_by":"Hayden"},{"issue_id":"hive-zlk.3","depends_on_id":"hive-zlk.1","type":"blocks","created_at":"2026-02-01T10:54:57.650676-06:00","created_by":"Hayden"}]}
{"id":"hive-zlk.4","title":"Integrate command palette into TUI model","description":"Integrate command palette into internal/tui/model.go:\n\n1. Add stateCommandPalette to UIState enum\n\n2. Add field to Model struct:\n   - commandPalette *CommandPalette\n\n3. Handle ':' key in handleNormalKey():\n```go\ncase \":\":\n    if len(m.cfg.UserCommands) \u003e 0 \u0026\u0026 m.selectedSession() != nil {\n        m.commandPalette = NewCommandPalette(m.cfg.UserCommands, m.selectedSession(), m.width, m.height)\n        m.state = stateCommandPalette\n        return m, nil\n    }\n```\n\n4. Add handleCommandPaletteKey() method:\n   - Handle enter (select command)\n   - Handle esc (cancel)\n   - Pass other keys to palette for filtering/navigation\n\n5. Update handleKey() to route to palette handler when state is stateCommandPalette\n\n6. Add palette overlay rendering in View():\n   - Render palette.Overlay() when state is stateCommandPalette\n\n7. Add ':' to help bindings when usercommands are configured","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:31.30135-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:11:20.123015-06:00","closed_at":"2026-02-01T12:11:20.123015-06:00","close_reason":"Completed in 4d9d393: full user command palette implementation","dependencies":[{"issue_id":"hive-zlk.4","depends_on_id":"hive-zlk","type":"parent-child","created_at":"2026-02-01T10:54:31.302614-06:00","created_by":"Hayden"},{"issue_id":"hive-zlk.4","depends_on_id":"hive-zlk.3","type":"blocks","created_at":"2026-02-01T10:55:02.823081-06:00","created_by":"Hayden"}]}
{"id":"hive-zlk.5","title":"Add ResolveUserCommand to keybinding handler","description":"Add user command resolution to internal/tui/keybindings.go:\n\n1. Add ResolveUserCommand method to KeybindingHandler:\n```go\nfunc (h *KeybindingHandler) ResolveUserCommand(name string, cmd config.UserCommand, sess session.Session) Action {\n    // Build template data (same as Resolve)\n    data := struct {\n        Path   string\n        Remote string\n        ID     string\n        Name   string\n    }{\n        Path:   sess.Path,\n        Remote: sess.Remote,\n        ID:     sess.ID,\n        Name:   sess.Name,\n    }\n    \n    // Render template\n    rendered, err := tmpl.Render(cmd.Sh, data)\n    if err != nil {\n        rendered = fmt.Sprintf(\"echo 'template error: %s'\", err.Error())\n    }\n    \n    return Action{\n        Type:        ActionTypeShell,\n        Key:         \":\" + name,\n        Help:        cmd.Help,\n        Confirm:     cmd.Confirm,\n        ShellCmd:    rendered,\n        SessionID:   sess.ID,\n        SessionPath: sess.Path,\n        Silent:      cmd.Silent,\n        Exit:        cmd.ShouldExit(),\n    }\n}\n```","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:36.521292-06:00","created_by":"Hayden","updated_at":"2026-02-01T12:11:20.124482-06:00","closed_at":"2026-02-01T12:11:20.124482-06:00","close_reason":"Completed in 4d9d393: full user command palette implementation","dependencies":[{"issue_id":"hive-zlk.5","depends_on_id":"hive-zlk","type":"parent-child","created_at":"2026-02-01T10:54:36.523153-06:00","created_by":"Hayden"},{"issue_id":"hive-zlk.5","depends_on_id":"hive-zlk.1","type":"blocks","created_at":"2026-02-01T10:55:08.00287-06:00","created_by":"Hayden"}]}
{"id":"hive-zlk.6","title":"Add tests for user commands feature","description":"Add tests for the user commands feature:\n\n1. Config parsing tests (internal/core/config/config_test.go):\n   - Test string shorthand parsing\n   - Test full object parsing\n   - Test mixed format parsing\n   - Test validation errors (missing sh)\n\n2. Command palette tests (internal/tui/command_palette_test.go):\n   - Test command filtering\n   - Test selection\n   - Test cancel\n\n3. Integration tests:\n   - Test ResolveUserCommand template rendering\n   - Test execution flow","status":"open","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T10:54:41.737644-06:00","created_by":"Hayden","updated_at":"2026-02-01T10:54:41.737644-06:00","dependencies":[{"issue_id":"hive-zlk.6","depends_on_id":"hive-zlk","type":"parent-child","created_at":"2026-02-01T10:54:41.738785-06:00","created_by":"Hayden"},{"issue_id":"hive-zlk.6","depends_on_id":"hive-zlk.4","type":"blocks","created_at":"2026-02-01T10:55:13.197802-06:00","created_by":"Hayden"}]}
{"id":"hive-zsd","title":"Investigate replacing huh with custom form inputs","description":"Investigate the effort required to replace the huh form library with custom inputs built on bubbles v2.\n\nBackground:\n- huh provides styled form components (text input, select, confirm dialogs)\n- Currently used for: NewSessionForm (repo selector + session name input)\n- huh uses bubbletea v1, incompatible with our v2 migration\n\nInvestigation scope:\n1. What huh features do we actually use?\n   - Select/dropdown for repo selection\n   - Text input for session name\n   - Validation (duplicate name check)\n   - Theming via FormTheme()\n\n2. What bubbles v2 components are available?\n   - textinput.Model - text input with validation\n   - list.Model - could work as a selector\n   - Need: styled wrapper, validation feedback, multi-field forms\n\n3. Effort estimate:\n   - Build custom Select component on list.Model\n   - Build FormGroup to manage multiple fields\n   - Wire up validation and styling\n\n4. Alternatives:\n   - Wait for huh v2\n   - Fork huh and update to v2 (community effort?)\n   - Use bubbles directly without form abstraction","notes":"Replaced by epic hive-n9u with detailed implementation plan","status":"closed","priority":3,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-02-01T00:11:27.835108-06:00","created_by":"Hayden","updated_at":"2026-02-01T00:40:01.604722-06:00","closed_at":"2026-02-01T00:40:01.604722-06:00","close_reason":"Resolved by implementing hive-n9u","dependencies":[{"issue_id":"hive-zsd","depends_on_id":"hive-ayy","type":"blocks","created_at":"2026-02-01T00:11:37.441377-06:00","created_by":"Hayden"}]}
{"id":"hive-zxv","title":"Extract duplicate directory reading in MsgStore","description":"**Files**: `internal/store/jsonfile/msgstore.go`\n**Risk**: Low\n\n## Problem\n\n`List()` (lines 174-202) and `listTopicsUnsafe()` (lines 283-306) contain nearly identical logic for reading topic files from disk.\n\n**List():**\n```go\nentries, err := os.ReadDir(s.topicsDir)\nif err != nil {\n    if os.IsNotExist(err) {\n        return nil, nil\n    }\n    return nil, fmt.Errorf(\"read topics directory: %w\", err)\n}\n\nvar topics []string\nfor _, entry := range entries {\n    if entry.IsDir() {\n        continue\n    }\n    name := entry.Name()\n    if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n        topic := strings.TrimSuffix(name, \".json\")\n        topic = strings.ReplaceAll(topic, \"_\", \"/\")\n        topics = append(topics, topic)\n    }\n}\nsort.Strings(topics)\nreturn topics, nil\n```\n\n**listTopicsUnsafe():**\n```go\n// Identical except no sort.Strings() call\n```\n\n## Solution\n\nExtract shared logic into a private `readTopicsFromDisk()` helper:\n\n```go\n// readTopicsFromDisk reads topic names from the topics directory.\n// Returns nil, nil if directory doesn't exist.\n// Caller is responsible for locking.\nfunc (s *MsgStore) readTopicsFromDisk() ([]string, error) {\n    entries, err := os.ReadDir(s.topicsDir)\n    if err != nil {\n        if os.IsNotExist(err) {\n            return nil, nil\n        }\n        return nil, fmt.Errorf(\"read topics directory: %w\", err)\n    }\n\n    var topics []string\n    for _, entry := range entries {\n        if entry.IsDir() {\n            continue\n        }\n        name := entry.Name()\n        if strings.HasSuffix(name, \".json\") \u0026\u0026 !strings.HasSuffix(name, \".lock\") {\n            topic := strings.TrimSuffix(name, \".json\")\n            topic = strings.ReplaceAll(topic, \"_\", \"/\")\n            topics = append(topics, topic)\n        }\n    }\n    return topics, nil\n}\n```\n\nThen simplify both callers:\n\n```go\n// List returns all topic names (sorted).\nfunc (s *MsgStore) List(ctx context.Context) ([]string, error) {\n    s.mu.RLock()\n    defer s.mu.RUnlock()\n\n    topics, err := s.readTopicsFromDisk()\n    if err != nil {\n        return nil, err\n    }\n    sort.Strings(topics)\n    return topics, nil\n}\n\n// listTopicsUnsafe returns all topic names without locking.\n// Caller must hold s.mu.\nfunc (s *MsgStore) listTopicsUnsafe() ([]string, error) {\n    return s.readTopicsFromDisk()\n}\n```\n\n## Impact\n- Eliminates 20+ lines of duplicate code\n- Single source of truth for topic parsing logic\n- Easier to maintain filename conventions","status":"closed","priority":1,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T19:04:31.919637-06:00","created_by":"Hayden","updated_at":"2026-01-30T19:08:08.785689-06:00","closed_at":"2026-01-30T19:08:08.785689-06:00","close_reason":"Closed","dependencies":[{"issue_id":"hive-zxv","depends_on_id":"hive-x04","type":"parent-child","created_at":"2026-01-30T19:04:49.088545-06:00","created_by":"Hayden"}]}
