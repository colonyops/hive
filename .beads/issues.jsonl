{"id":"hive-13m","title":"Add BatchSpawnTemplateData for validation","description":"Create BatchSpawnTemplateData struct in internal/core/config/validate.go that includes Prompt field.\n\nSpawnTemplateData (for hive new): Path, Name, Slug, ContextDir, Owner, Repo\nBatchSpawnTemplateData (for batch): Path, Name, Slug, ContextDir, Owner, Repo, Prompt\n\nUpdate Validate() to validate batch_spawn templates against BatchSpawnTemplateData.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:33.047882-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:47.529232-06:00","closed_at":"2026-01-30T13:22:47.529232-06:00","close_reason":"Added BatchSpawnTemplateData struct and validation for batch_spawn commands","dependencies":[{"issue_id":"hive-13m","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:48.13222-06:00","created_by":"Hayden"}]}
{"id":"hive-143","title":"Update batch command documentation","description":"Update cmd_batch.go usage text and description to:\n1. Document that prompt field is supported in JSON input\n2. Explain that batch_spawn config is used for batch sessions\n3. Show example with prompt in JSON schema","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:39.209707-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:37.546775-06:00","closed_at":"2026-01-30T13:23:37.546775-06:00","close_reason":"Updated batch command documentation with prompt field, batch_spawn usage, and config example"}
{"id":"hive-4fk","title":"Restore Prompt to BatchSession and CreateOptions","description":"Re-add Prompt field to:\n- BatchSession struct in cmd_batch.go (for JSON input)\n- CreateOptions struct in service.go (to pass through)\n- SpawnData struct in spawner.go (for template rendering)\n\nDo NOT add Prompt back to Session struct (it's transient, not persisted).","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:34.995695-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:22:14.822067-06:00","closed_at":"2026-01-30T13:22:14.822067-06:00","close_reason":"Added Prompt field to BatchSession, CreateOptions, and SpawnData"}
{"id":"hive-66m","title":"Register msg command and add tests","description":"Final integration:\n\n- Register MsgCmd in main.go following existing pattern\n- Add unit tests for message store (publish, subscribe, retention, wildcards)\n- Add integration tests for CLI commands\n- Update any documentation if present","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.812033-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:37:39.287581-06:00","closed_at":"2026-01-29T20:37:39.287581-06:00","close_reason":"Registered MsgCmd in main.go. Unit tests already exist in msgstore_test.go (12 tests) and sender_test.go (3 tests) covering publish, subscribe, retention, wildcards, and session detection","dependencies":[{"issue_id":"hive-66m","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.608036-06:00","created_by":"Hayden"}]}
{"id":"hive-an2","title":"Update Service.CreateSession to use BatchSpawn for batch","description":"Modify CreateSession to accept a flag or use a different method for batch spawning.\n\nOptions:\n1. Add UseBatchSpawn bool to CreateOptions\n2. Create separate CreateBatchSession method\n3. Pass spawn commands directly\n\nThe batch code path should use config.Commands.BatchSpawn if set, otherwise fall back to config.Commands.Spawn.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:37.659862-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:23:18.073117-06:00","closed_at":"2026-01-30T13:23:18.073117-06:00","close_reason":"Added UseBatchSpawn to CreateOptions and updated CreateSession to use batch_spawn commands","dependencies":[{"issue_id":"hive-an2","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:48.014768-06:00","created_by":"Hayden"},{"issue_id":"hive-an2","depends_on_id":"hive-4fk","type":"blocks","created_at":"2026-01-30T13:19:48.071771-06:00","created_by":"Hayden"}]}
{"id":"hive-cdw","title":"Define core messaging types and store interface","description":"Create the foundational types for the messaging system:\n\n- Message struct with ID, Topic, Payload, Sender, CreatedAt fields\n- Topic struct with Name, Messages slice, UpdatedAt\n- Store interface with Publish, Subscribe, List, Prune methods\n\nLocation: internal/core/messaging/\n\nThis establishes the contract before implementing storage or CLI.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:05:42.503772-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:19:10.639495-06:00","closed_at":"2026-01-29T20:19:10.639495-06:00","close_reason":"Created Message, Topic structs and Store interface in internal/core/messaging/"}
{"id":"hive-d98","title":"Implement global JSON file message store","description":"Implement the messaging Store interface using per-topic JSON files:\n\n- Storage location: $XDG_DATA_HOME/hive/messages/topics/{topic}.json\n- Reuse file locking pattern from kvstore.go (in-process mutex + flock)\n- Atomic writes via temp file + rename\n- Count-based retention: enforce max messages per topic on write (default 100)\n- Support topic wildcards for Subscribe (e.g., agent.* matches agent.build, agent.test)\n- Support subscribing to all topics when no pattern specified\n\nLocation: internal/store/jsonfile/msgstore.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.073644-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:23:45.952299-06:00","closed_at":"2026-01-29T20:23:45.952299-06:00","close_reason":"Implemented MsgStore with per-topic JSON files, file locking, atomic writes, count-based retention (default 100), and wildcard topic patterns","dependencies":[{"issue_id":"hive-d98","depends_on_id":"hive-cdw","type":"blocks","created_at":"2026-01-29T20:08:24.370052-06:00","created_by":"Hayden"}]}
{"id":"hive-hdg","title":"Implement hive msg CLI command","description":"Create the msg command with pub/sub/list subcommands:\n\nhive msg pub --topic \u003ctopic\u003e [message | -f file | stdin]\n  - Publish message to topic\n  - Auto-detect sender from session ID\n  \nhive msg sub [--topic \u003cpattern\u003e] [--timeout duration] [--last N]\n  - No topic: subscribe to all topics\n  - With topic: filter by pattern (supports wildcards like agent.*)\n  - --last N returns last N messages immediately\n  - Without --last, polls for new messages until timeout\n  \nhive msg list [--json]\n  - List all topics with message counts\n\nFollow pattern from cmd_ctx.go for structure.\nLocation: internal/commands/cmd_msg.go","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.434803-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:36:54.020004-06:00","closed_at":"2026-01-29T20:36:54.020004-06:00","close_reason":"Implemented hive msg CLI with pub/sub/list subcommands, auto sender detection, wildcard topic patterns, and polling for new messages","dependencies":[{"issue_id":"hive-hdg","depends_on_id":"hive-d98","type":"blocks","created_at":"2026-01-29T20:08:24.435226-06:00","created_by":"Hayden"},{"issue_id":"hive-hdg","depends_on_id":"hive-kto","type":"blocks","created_at":"2026-01-29T20:08:24.492719-06:00","created_by":"Hayden"}]}
{"id":"hive-kto","title":"Add session ID detection from CWD","description":"Create utility to detect current hive session from working directory:\n\n- Read sessions.json from $XDG_DATA_HOME/hive/sessions.json\n- Find session where path matches or is prefix of CWD\n- Return session ID for use as sender identifier in messages\n- Return empty string if not in a hive session (allow anonymous publishing)\n\nThis enables automatic sender identification without manual configuration.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.255375-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:25:21.976907-06:00","closed_at":"2026-01-29T20:25:21.976907-06:00","close_reason":"Added SessionDetector to find current hive session from working directory with path prefix matching"}
{"id":"hive-l87","title":"Add BatchSpawn field to config.Commands struct","description":"Add BatchSpawn []string field to Commands struct in internal/core/config/config.go\n\nThis will hold the spawn commands used specifically for batch session creation.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:30.620372-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:21:54.430594-06:00","closed_at":"2026-01-30T13:21:54.430594-06:00","close_reason":"Added BatchSpawn []string field to Commands struct"}
{"id":"hive-uhe","title":"Remove KV store implementation","description":"Remove the KV store code entirely:\n\n- Delete internal/core/context/kv.go\n- Delete internal/store/jsonfile/kvstore.go  \n- Remove 'hive ctx kv' subcommand from cmd_ctx.go\n- Remove any KV-related tests\n- Clean up any imports/references\n\nState storage will be handled by beads instead.","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:08:16.613123-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:45:05.437764-06:00","closed_at":"2026-01-29T20:45:05.437764-06:00","close_reason":"Removed KV store: deleted internal/core/context/kv.go, internal/store/jsonfile/kvstore.go and test, removed hive ctx kv subcommand from cmd_ctx.go","dependencies":[{"issue_id":"hive-uhe","depends_on_id":"hive-hdg","type":"blocks","created_at":"2026-01-29T20:08:24.550509-06:00","created_by":"Hayden"}]}
{"id":"hive-uio","title":"Add batch_spawn command config","description":"Add a separate spawn command config for batch sessions that supports prompts.\n\nCurrent state:\n- commands.spawn is used for all session spawning\n- Prompt was removed from hive new (good - keeps it simple)\n- But batch needs prompts for automation\n\nSolution:\n- Add commands.batch_spawn config option\n- batch_spawn supports {{.Prompt}} template variable\n- hive batch uses batch_spawn if configured, falls back to spawn\n- hive new continues using spawn (no prompt)\n\nConfig example:\n```yaml\ncommands:\n  spawn:        # Used by hive new\n    - \"wezterm cli spawn --cwd {{.Path}}\"\n  batch_spawn:  # Used by hive batch (optional)\n    - \"wezterm cli spawn --cwd {{.Path}} -- claude --prompt '{{.Prompt}}'\"\n```","status":"closed","priority":2,"issue_type":"feature","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-30T13:19:25.981268-06:00","created_by":"Hayden","updated_at":"2026-01-30T13:24:03.646186-06:00","closed_at":"2026-01-30T13:24:03.646186-06:00","close_reason":"Feature complete: batch_spawn config added with full Prompt support for batch sessions","dependencies":[{"issue_id":"hive-uio","depends_on_id":"hive-l87","type":"blocks","created_at":"2026-01-30T13:19:43.442982-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-13m","type":"blocks","created_at":"2026-01-30T13:19:43.501181-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-4fk","type":"blocks","created_at":"2026-01-30T13:19:43.563115-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-an2","type":"blocks","created_at":"2026-01-30T13:19:43.624774-06:00","created_by":"Hayden"},{"issue_id":"hive-uio","depends_on_id":"hive-143","type":"blocks","created_at":"2026-01-30T13:19:43.685034-06:00","created_by":"Hayden"}]}
{"id":"hive-wvy","title":"Update msg command: list by default, JSON output","status":"closed","priority":2,"issue_type":"task","owner":"64056131+hay-kot@users.noreply.github.com","created_at":"2026-01-29T20:48:11.945114-06:00","created_by":"Hayden","updated_at":"2026-01-29T20:49:53.159676-06:00","closed_at":"2026-01-29T20:49:53.159676-06:00","close_reason":"Updated msg sub to list messages by default (JSON), added --listen flag for polling mode, made msg list output JSON"}
